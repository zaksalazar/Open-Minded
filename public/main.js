/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},e(t,n)};function n(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r=function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},r.apply(this,arguments)};function i(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((r=r.apply(t,e||[])).next())}))}function o(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function s(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function c(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=c(t[n],e[n]));return t}var h=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function l(){try{return"[object process]"===Object.prototype.toString.call(t.g.process)}catch(t){return!1}}var p=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,d.prototype.create),o}return n(e,t),e}(Error),d=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?v(o,r):"Error",u=this.serviceName+": "+s+" ("+i+").",a=new p(i,u,r);return a},t}();function v(t,e){return t.replace(y,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var y=/\{\$([^}]+)}/g;function g(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function m(t,e){var n=new b(t,e);return n.subscribe.bind(n)}!function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,u=this.chain_[0],a=this.chain_[1],c=this.chain_[2],h=this.chain_[3],f=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=h^a&(c^h),s=1518500249):(o=a^c^h,s=1859775393):r<60?(o=a&c|h&(a|c),s=2400959708):(o=a^c^h,s=3395469782),i=(u<<5|u>>>27)+o+f+s+n[r]&4294967295,f=h,h=c,c=4294967295&(a<<30|a>>>2),a=u,u=i;this.chain_[0]=this.chain_[0]+u&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+f&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t}}();var b=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=w),void 0===r.error&&(r.error=w),void 0===r.complete&&(r.complete=w);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function w(){}var _,E=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),I="[DEFAULT]",T=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=I);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new h;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=r({identifier:I,optional:!1},t),n=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(n);try{var s=this.getOrInitializeService(o);if(!s){if(i)return null;throw Error("Service "+this.name+" is not available")}return s}catch(t){if(i)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService(I)}catch(t){}try{for(var r=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=s(i.value,2),u=o[0],a=o[1],c=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService(c);a.resolve(h)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=I),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return i(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(u(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})),t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()}))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=I),this.instances.has(t)},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===I?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:I:t},t}(),N=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new T(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();function A(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}var S,D=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(S||(S={}));var x,O={debug:S.DEBUG,verbose:S.VERBOSE,info:S.INFO,warn:S.WARN,error:S.ERROR,silent:S.SILENT},k=S.INFO,P=((_={})[S.DEBUG]="log",_[S.VERBOSE]="log",_[S.INFO]="info",_[S.WARN]="warn",_[S.ERROR]="error",_),C=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=P[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,A(["["+i+"]  "+t.name+":"],n))}},L=function(){function t(t){this.name=t,this._logLevel=k,this._logHandler=C,this._userLogHandler=null,D.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in S))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?O[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,S.DEBUG],t)),this._logHandler.apply(this,A([this,S.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,S.VERBOSE],t)),this._logHandler.apply(this,A([this,S.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,S.INFO],t)),this._logHandler.apply(this,A([this,S.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,S.WARN],t)),this._logHandler.apply(this,A([this,S.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,S.ERROR],t)),this._logHandler.apply(this,A([this,S.ERROR],t))},t}();function R(t){D.forEach((function(e){e.setLogLevel(t)}))}var V,M=((x={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",x["bad-app-name"]="Illegal App name: '{$appName}",x["duplicate-app"]="Firebase App named '{$appName}' already exists",x["app-deleted"]="Firebase App named '{$appName}' already deleted",x["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",x["invalid-log-argument"]="First argument to `onLog` must be null or a function.",x),j=new d("app","Firebase",M),U="@firebase/app",F="[DEFAULT]",q=((V={})[U]="fire-core",V["@firebase/analytics"]="fire-analytics",V["@firebase/auth"]="fire-auth",V["@firebase/database"]="fire-rtdb",V["@firebase/functions"]="fire-fn",V["@firebase/installations"]="fire-iid",V["@firebase/messaging"]="fire-fcm",V["@firebase/performance"]="fire-perf",V["@firebase/remote-config"]="fire-rc",V["@firebase/storage"]="fire-gcs",V["@firebase/firestore"]="fire-fst",V["fire-js"]="fire-js",V["firebase-wrapper"]="fire-js-all",V),z=new L("@firebase/app"),B=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=c(void 0,t),this.container=new N(e.name),this._addComponent(new E("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=F),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=F),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){z.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw j.create("app-deleted",{appName:this.name_})},t}();B.prototype.name&&B.prototype.options||B.prototype.delete||console.log("dc");var G=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=F);var s=o.name;if("string"!=typeof s||!s)throw j.create("bad-app-name",{appName:String(s)});if(g(e,s))throw j.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=q[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),u=e.match(/\s|\//);if(s||u){var a=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&a.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&u&&a.push("and"),u&&a.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void z.warn(a.join(" "))}o(new E(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:R,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw j.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=O[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:S[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=D;r<i.length;r++)n(i[r])}(t,e)},apps:null,SDK_VERSION:"8.2.9",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(!g(e,t=t||F))throw j.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return z.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var u=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw j.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&c(u,o.serviceProps),r[s]=u,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,s).apply(this,o.multipleInstances?t:[])}}for(var a=0,h=Object.keys(e);a<h.length;a++){var f=h[a];e[f]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(B);return e.INTERNAL=r(r({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){c(e,t)},createSubscribe:m,ErrorFactory:d,deepExtend:c}),e}(),H=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if("object"==typeof self&&self.self===self&&void 0!==self.firebase){z.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Q=self.firebase.SDK_VERSION;Q&&Q.indexOf("LITE")>=0&&z.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Y=G.initializeApp;G.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return l()&&z.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Y.apply(void 0,t)};var K=G;!function(t,e){t.INTERNAL.registerComponent(new E("platform-logger",(function(t){return new H(t)}),"PRIVATE")),t.registerVersion(U,"0.6.15",void 0),t.registerVersion("fire-js","")}(K);const X=K;X.registerVersion("firebase","8.2.10","app");var W=function(t,e){return W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},W(t,e)};function J(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Z,$="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t.g?t.g:"undefined"!=typeof self?self:{},tt=tt||{},et=$||self;function nt(){}function rt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function it(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ot="closure_uid_"+(1e9*Math.random()>>>0),st=0;function ut(t,e,n){return t.call.apply(t.bind,arguments)}function at(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function ct(t,e,n){return(ct=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ut:at).apply(null,arguments)}function ht(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function ft(){return Date.now()}function lt(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function pt(){this.j=this.j,this.i=this.i}pt.prototype.j=!1,pt.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,ot)&&t[ot]||(t[ot]=++st)}(this)},pt.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var dt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},vt=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function yt(t){return Array.prototype.concat.apply([],arguments)}function gt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function mt(t){return/^[\s\xa0]*$/.test(t)}var bt,wt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function _t(t,e){return-1!=t.indexOf(e)}function Et(t,e){return t<e?-1:t>e?1:0}t:{var It=et.navigator;if(It){var Tt=It.userAgent;if(Tt){bt=Tt;break t}}bt=""}function Nt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function At(t){var e={};for(var n in t)e[n]=t[n];return e}var St="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Dt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<St.length;o++)n=St[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function xt(t){return xt[" "](t),t}xt[" "]=nt;var Ot,kt,Pt=_t(bt,"Opera"),Ct=_t(bt,"Trident")||_t(bt,"MSIE"),Lt=_t(bt,"Edge"),Rt=Lt||Ct,Vt=_t(bt,"Gecko")&&!(_t(bt.toLowerCase(),"webkit")&&!_t(bt,"Edge"))&&!(_t(bt,"Trident")||_t(bt,"MSIE"))&&!_t(bt,"Edge"),Mt=_t(bt.toLowerCase(),"webkit")&&!_t(bt,"Edge");function jt(){var t=et.document;return t?t.documentMode:void 0}t:{var Ut="",Ft=(kt=bt,Vt?/rv:([^\);]+)(\)|;)/.exec(kt):Lt?/Edge\/([\d\.]+)/.exec(kt):Ct?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(kt):Mt?/WebKit\/(\S+)/.exec(kt):Pt?/(?:Version)[ \/]?(\S+)/.exec(kt):void 0);if(Ft&&(Ut=Ft?Ft[1]:""),Ct){var qt=jt();if(null!=qt&&qt>parseFloat(Ut)){Ot=String(qt);break t}}Ot=Ut}var zt,Bt={};function Gt(t){return function(t,e){var n=Bt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=wt(String(Ot)).split("."),r=wt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=Et(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||Et(0==s[2].length,0==u[2].length)||Et(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e}))}et.document&&Ct?zt=jt()||parseInt(Ot,10)||void 0:zt=void 0;var Ht=zt,Qt=!Ct||9<=Number(Ht),Yt=Ct&&!Gt("9"),Kt=function(){if(!et.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{et.addEventListener("test",nt,e),et.removeEventListener("test",nt,e)}catch(t){}return t}();function Xt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Wt(t,e){if(Xt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Vt){t:{try{xt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Jt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Xt.prototype.b=function(){this.defaultPrevented=!0},lt(Wt,Xt);var Jt={2:"touch",3:"pen",4:"mouse"};Wt.prototype.b=function(){Wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Yt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var Zt="closure_listenable_"+(1e6*Math.random()|0),$t=0;function te(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++$t,this.Y=this.Z=!1}function ee(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function ne(t){this.src=t,this.a={},this.b=0}function re(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=dt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ee(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ie(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}ne.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=ie(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new te(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var oe="closure_lm_"+(1e6*Math.random()|0),se={};function ue(t,e,n,r,i){if(r&&r.once)return ce(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)ue(t,e[o],n,r,i);return null}return n=ge(n),t&&t[Zt]?t.va(e,n,it(r)?!!r.capture:!!r,i):ae(t,e,n,!1,r,i)}function ae(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=it(i)?!!i.capture:!!i;if(s&&!Qt)return null;var u=ve(t);if(u||(t[oe]=u=new ne(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=de,e=Qt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Kt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(le(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function ce(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)ce(t,e[o],n,r,i);return null}return n=ge(n),t&&t[Zt]?t.wa(e,n,it(r)?!!r.capture:!!r,i):ae(t,e,n,!0,r,i)}function he(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)he(t,e[o],n,r,i);else r=it(r)?!!r.capture:!!r,n=ge(n),t&&t[Zt]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=ie(o=t.a[e],n,r,i))&&(ee(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=ve(t))&&(e=t.a[e.toString()],t=-1,e&&(t=ie(e,n,r,i)),(n=-1<t?e[t]:null)&&fe(n))}function fe(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Zt])re(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(le(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ve(e))?(re(n,t),0==n.b&&(n.src=null,e[oe]=null)):ee(t)}}}function le(t){return t in se?se[t]:se[t]="on"+t}function pe(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&fe(t),n.call(r,e)}function de(t,e){if(t.Y)return!0;if(!Qt){if(!e)t:{e=["window","event"];for(var n=et,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return pe(t,e=new Wt(e,this))}return pe(t,new Wt(e,this))}function ve(t){return(t=t[oe])instanceof ne?t:null}var ye="__closure_events_fn_"+(1e9*Math.random()>>>0);function ge(t){return"function"==typeof t?t:(t[ye]||(t[ye]=function(e){return t.handleEvent(e)}),t[ye])}function me(){pt.call(this),this.c=new ne(this),this.J=this,this.C=null}function be(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Xt(e,t);else if(e instanceof Xt)e.target=e.target||t;else{var i=e;Dt(e=new Xt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=we(s,r,!0,e)&&i}if(i=we(s=e.a=t,r,!0,e)&&i,i=we(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=we(s=e.a=n[o],r,!1,e)&&i}function we(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&re(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}lt(me,pt),me.prototype[Zt]=!0,(Z=me.prototype).addEventListener=function(t,e,n,r){ue(this,t,e,n,r)},Z.removeEventListener=function(t,e,n,r){he(this,t,e,n,r)},Z.G=function(){if(me.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ee(n[r]);delete e.a[t],e.b--}}this.C=null},Z.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},Z.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var _e=et.JSON.stringify;function Ee(){this.b=this.a=null}var Ie,Te=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Ae}),(function(t){t.reset()}));function Ne(){var t=Oe,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ae(){this.next=this.b=this.a=null}function Se(t){et.setTimeout((function(){throw t}),0)}function De(t,e){Ie||function(){var t=et.Promise.resolve(void 0);Ie=function(){t.then(ke)}}(),xe||(Ie(),xe=!0),Oe.add(t,e)}Ee.prototype.add=function(t,e){var n=Te.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ae.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ae.prototype.reset=function(){this.next=this.b=this.a=null};var xe=!1,Oe=new Ee;function ke(){for(var t;t=Ne();){try{t.a.call(t.b)}catch(t){Se(t)}var e=Te;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}xe=!1}function Pe(t,e){me.call(this),this.b=t||1,this.a=e||et,this.f=ct(this.Za,this),this.g=ft()}function Ce(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Le(t,e,n){if("function"==typeof t)n&&(t=ct(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ct(t.handleEvent,t)}return 2147483647<Number(e)?-1:et.setTimeout(t,e||0)}function Re(t){t.a=Le((function(){t.a=null,t.c&&(t.c=!1,Re(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}lt(Pe,me),(Z=Pe.prototype).aa=!1,Z.M=null,Z.Za=function(){if(this.aa){var t=ft()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),be(this,"tick"),this.aa&&(Ce(this),this.start()))}},Z.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=ft())},Z.G=function(){Pe.X.G.call(this),Ce(this),delete this.a};var Ve=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}W(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Re(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(et.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(pt);function Me(t){pt.call(this),this.b=t,this.a={}}lt(Me,pt);var je=[];function Ue(t,e,n,r){Array.isArray(n)||(n&&(je[0]=n.toString()),n=je);for(var i=0;i<n.length;i++){var o=ue(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Fe(t){Nt(t.a,(function(t,e){this.a.hasOwnProperty(e)&&fe(t)}),t),t.a={}}function qe(){this.a=!0}function ze(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return _e(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Me.prototype.G=function(){Me.X.G.call(this),Fe(this)},Me.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},qe.prototype.info=function(){};var Be={},Ge=null;function He(){return Ge=Ge||new me}function Qe(t){Xt.call(this,Be.Fa,t)}function Ye(t){var e=He();be(e,new Qe(e,t))}function Ke(t,e){Xt.call(this,Be.STAT_EVENT,t),this.stat=e}function Xe(t){var e=He();be(e,new Ke(e,t))}function We(t){Xt.call(this,Be.Ga,t)}function Je(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return et.setTimeout((function(){t()}),e)}Be.Fa="serverreachability",lt(Qe,Xt),Be.STAT_EVENT="statevent",lt(Ke,Xt),Be.Ga="timingevent",lt(We,Xt);var Ze={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},$e={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function tn(){}function en(t){var e;return(e=t.a)||(e=t.a={}),e}function nn(){}tn.prototype.a=null;var rn,on={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function sn(){Xt.call(this,"d")}function un(){Xt.call(this,"c")}function an(){}function cn(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Me(this),this.P=hn,t=Rt?125:void 0,this.R=new Pe(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}lt(sn,Xt),lt(un,Xt),lt(an,tn),rn=new an;var hn=45e3,fn={},ln={};function pn(t,e,n){t.H=1,t.i=Rn(xn(e)),t.j=n,t.I=!0,dn(t,null)}function dn(t,e){t.u=ft(),gn(t),t.l=xn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Kn(n.b,"t",r),t.D=0,t.a=zr(t.g,t.g.C?e:null),0<t.O&&(t.F=new Ve(ct(t.Ca,t,t.a),t.O)),Ue(t.J,t.a,"readystatechange",t.Xa),e=t.B?At(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Ye(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function vn(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=yn(t,n);if(i==ln){4==e&&(t.h=4,Xe(14),r=!1),ze(t.c,t.f,null,"[Incomplete Response]");break}if(i==fn){t.h=4,Xe(15),ze(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}ze(t.c,t.f,i,null),En(t,i)}4==e&&0==n.length&&(t.h=1,Xe(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Lr(e),e.F=!0,Xe(11))):(ze(t.c,t.f,n,"[Invalid Chunked Response]"),_n(t),wn(t))}function yn(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?ln:(n=Number(e.substring(n,r)),isNaN(n)?fn:(r+=1)+n>e.length?ln:(e=e.substr(r,n),t.D=r+n,e))}function gn(t){t.T=ft()+t.P,mn(t,t.P)}function mn(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Je(ct(t.Va,t),e)}function bn(t){t.o&&(et.clearTimeout(t.o),t.o=null)}function wn(t){0==t.g.v||t.A||Mr(t.g,t)}function _n(t){bn(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Ce(t.R),Fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function En(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||er(n.b,t)))if(n.I=t.N,!t.C&&er(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Vr(n),Nr(n)}Cr(n),Xe(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=Je(ct(n.Sa,n),6e3));if(1>=tr(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else Ur(n,11)}else if((t.C||n.a==t)&&Vr(n),!mt(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(_t(h,"spdy")||_t(h,"quic")||_t(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(nr(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,Ln(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=ft()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=qr(a,a.C?a.ga:null,a.fa),p.C){rr(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(bn(d),gn(d)),a.a=p}else Pr(a);0<n.g.length&&Dr(n)}else"stop"!=i[0]&&"close"!=i[0]||Ur(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Ur(n,7):Tr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Ye(4)}catch(t){}}function In(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(rt(t)||"string"==typeof t)vt(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(rt(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(rt(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Tn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Tn)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Nn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];An(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)An(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function An(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Z=cn.prototype).setTimeout=function(t){this.P=t},Z.Xa=function(t){t=t.target;var e=this.F;e&&3==wr(t)?e.f():this.Ca(t)},Z.Ca=function(t){try{if(t==this.a)t:{var e=wr(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!Rt&&!this.a.$())){this.A||4!=e||7==n||Ye(8==n||0>=r?3:2),bn(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!mt(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Xe(12),_n(this),wn(this);break t}ze(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,En(this,a)}this.I?(vn(this,e,o),Rt&&this.b&&3==e&&(Ue(this.J,this.R,"tick",this.Wa),this.R.start())):(ze(this.c,this.f,o,null),En(this,o)),4==e&&_n(this),this.b&&!this.A&&(4==e?Mr(this.g,this):(this.b=!1,gn(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Xe(12)):(this.h=0,Xe(13)),_n(this),wn(this)}}}catch(t){}},Z.Wa=function(){if(this.a){var t=wr(this.a),e=this.a.$();this.D<e.length&&(bn(this),vn(this,t,e),this.b&&4!=t&&gn(this))}},Z.cancel=function(){this.A=!0,_n(this)},Z.Va=function(){this.o=null;var t=ft();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(Ye(3),Xe(17)),_n(this),this.h=2,wn(this)):mn(this,this.T-t)},(Z=Tn.prototype).K=function(){Nn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},Z.L=function(){return Nn(this),this.a.concat()},Z.get=function(t,e){return An(this.b,t)?this.b[t]:e},Z.set=function(t,e){An(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},Z.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Sn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Dn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Dn){this.a=void 0!==e?e:t.a,On(this,t.f),this.j=t.j,kn(this,t.c),Pn(this,t.h),this.g=t.g,e=t.b;var n=new Gn;n.c=e.c,e.a&&(n.a=new Tn(e.a),n.b=e.b),Cn(this,n),this.i=t.i}else t&&(n=String(t).match(Sn))?(this.a=!!e,On(this,n[1]||"",!0),this.j=Vn(n[2]||""),kn(this,n[3]||"",!0),Pn(this,n[4]),this.g=Vn(n[5]||"",!0),Cn(this,n[6]||"",!0),this.i=Vn(n[7]||"")):(this.a=!!e,this.b=new Gn(null,this.a))}function xn(t){return new Dn(t)}function On(t,e,n){t.f=n?Vn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function kn(t,e,n){t.c=n?Vn(e,!0):e}function Pn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Cn(t,e,n){e instanceof Gn?(t.b=e,function(t,e){e&&!t.f&&(Hn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Qn(this,e),Kn(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Mn(e,zn)),t.b=new Gn(e,t.a))}function Ln(t,e,n){t.b.set(e,n)}function Rn(t){return Ln(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^ft()).toString(36)),t}function Vn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Mn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,jn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function jn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Dn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Mn(e,Un,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Mn(e,Un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Mn(n,"/"==n.charAt(0)?qn:Fn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Mn(n,Bn)),t.join("")};var Un=/[#\/\?@]/g,Fn=/[#\?:]/g,qn=/[#\?]/g,zn=/[#\?@]/g,Bn=/#/g;function Gn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Hn(t){t.a||(t.a=new Tn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Qn(t,e){Hn(t),e=Xn(t,e),An(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,An((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Nn(t)))}function Yn(t,e){return Hn(t),e=Xn(t,e),An(t.a.b,e)}function Kn(t,e,n){Qn(t,e),0<n.length&&(t.c=null,t.a.set(Xn(t,e),gt(n)),t.b+=n.length)}function Xn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(Z=Gn.prototype).add=function(t,e){Hn(this),this.c=null,t=Xn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},Z.forEach=function(t,e){Hn(this),this.a.forEach((function(n,r){vt(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Z.L=function(){Hn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Z.K=function(t){Hn(this);var e=[];if("string"==typeof t)Yn(this,t)&&(e=yt(e,this.a.get(Xn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=yt(e,t[n])}return e},Z.set=function(t,e){return Hn(this),this.c=null,Yn(this,t=Xn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},Z.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},Z.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Wn=function(t,e){this.b=t,this.a=e};function Jn(t){this.g=t||Zn,t=et.PerformanceNavigationTiming?0<(t=et.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(et.ia&&et.ia.ya&&et.ia.ya()&&et.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var Zn=10;function $n(t){return!!t.b||!!t.a&&t.a.size>=t.f}function tr(t){return t.b?1:t.a?t.a.size:0}function er(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function nr(t,e){t.a?t.a.add(e):t.b=e}function rr(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function ir(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=J(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return gt(t.c)}function or(){}function sr(){this.a=new or}function ur(t,e,n){var r=n||"";try{In(t,(function(t,n){var i=t;it(t)&&(i=_e(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function ar(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Jn.prototype.cancel=function(){var t,e;if(this.c=ir(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=J(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},or.prototype.stringify=function(t){return et.JSON.stringify(t,void 0)},or.prototype.parse=function(t){return et.JSON.parse(t,void 0)};var cr=et.JSON.parse;function hr(t){me.call(this),this.headers=new Tn,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=fr,this.D=this.F=!1}lt(hr,me);var fr="",lr=/^https?$/i,pr=["POST","PUT"];function dr(t){return"content-type"==t.toLowerCase()}function vr(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,yr(t),mr(t)}function yr(t){t.u||(t.u=!0,be(t,"complete"),be(t,"error"))}function gr(t){if(t.b&&void 0!==tt&&(!t.s[1]||4!=wr(t)||2!=t.W()))if(t.l&&4==wr(t))Le(t.za,0,t);else if(be(t,"readystatechange"),4==wr(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Sn)[1]||null;if(!o&&et.self&&et.self.location){var s=et.self.location.protocol;o=s.substr(0,s.length-1)}i=!lr.test(o?o.toLowerCase():"")}e=i}if(e)be(t,"complete"),be(t,"success");else{t.h=6;try{var u=2<wr(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",yr(t)}}finally{mr(t)}}}function mr(t,e){if(t.a){br(t);var n=t.a,r=t.s[0]?nt:null;t.a=null,t.s=null,e||be(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function br(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(et.clearTimeout(t.m),t.m=null)}function wr(t){return t.a?t.a.readyState:0}function _r(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Nt(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ln(t,e,n))}function Er(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ir(t){this.pa=0,this.g=[],this.c=new qe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Er("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Er("baseRetryDelayMs",5e3,t),this.Ra=Er("retryDelaySeedMs",1e4,t),this.Ma=Er("forwardChannelMaxRetries",2,t),this.ma=Er("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Jn(t&&t.concurrentRequestLimit),this.ka=new sr,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Tr(t){if(Ar(t),3==t.v){var e=t.R++,n=xn(t.B);Ln(n,"SID",t.J),Ln(n,"RID",e),Ln(n,"TYPE","terminate"),Or(t,n),(e=new cn(t,t.c,e,void 0)).H=2,e.i=Rn(xn(n)),n=!1,et.navigator&&et.navigator.sendBeacon&&(n=et.navigator.sendBeacon(e.i.toString(),"")),!n&&et.Image&&((new Image).src=e.i,n=!0),n||(e.a=zr(e.g,null),e.a.ba(e.i)),e.u=ft(),gn(e)}Fr(t)}function Nr(t){t.a&&(Lr(t),t.a.cancel(),t.a=null)}function Ar(t){Nr(t),t.j&&(et.clearTimeout(t.j),t.j=null),Vr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&et.clearTimeout(t.h),t.h=null)}function Sr(t,e){t.g.push(new Wn(t.Oa++,e)),3==t.v&&Dr(t)}function Dr(t){$n(t.b)||t.h||(t.h=!0,De(t.Ba,t),t.u=0)}function xr(t,e){var n;n=e?e.f:t.R++;var r=xn(t.B);Ln(r,"SID",t.J),Ln(r,"RID",n),Ln(r,"AID",t.P),Or(t,r),t.i&&t.l&&_r(r,t.i,t.l),n=new cn(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=kr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),nr(t.b,n),pn(n,r,e)}function Or(t,e){t.f&&In({},(function(t,n){Ln(e,n,t)}))}function kr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?ct(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{ur(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Pr(t){t.a||t.j||(t.T=1,De(t.Aa,t),t.o=0)}function Cr(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=Je(ct(t.Aa,t),jr(t,t.o)),t.o++,0))}function Lr(t){null!=t.s&&(et.clearTimeout(t.s),t.s=null)}function Rr(t){t.a=new cn(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=xn(t.la);Ln(e,"RID","rpc"),Ln(e,"SID",t.J),Ln(e,"CI",t.H?"0":"1"),Ln(e,"AID",t.P),Or(t,e),Ln(e,"TYPE","xmlhttp"),t.i&&t.l&&_r(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Rn(xn(e)),n.j=null,n.I=!0,dn(n,t)}function Vr(t){null!=t.m&&(et.clearTimeout(t.m),t.m=null)}function Mr(t,e){var n=null;if(t.a==e){Vr(t),Lr(t),t.a=null;var r=2}else{if(!er(t.b,e))return;n=e.s,rr(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=ft()-e.u;var i=t.u;be(r=He(),new We(r,n,e,i)),Dr(t)}else Pr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(tr(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=Je(ct(t.Ba,t,e),jr(t,t.u)),t.u++,0)))}(t,e)||2==r&&Cr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Ur(t,5);break;case 4:Ur(t,10);break;case 3:Ur(t,6);break;default:Ur(t,2)}}function jr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Ur(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=ct(t.Ya,t);n||(n=new Dn("//www.google.com/images/cleardot.gif"),et.location&&"http"==et.location.protocol||On(n,"https"),Rn(n)),function(t,e){var n=new qe;if(et.Image){var r=new Image;r.onload=ht(ar,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ht(ar,n,r,"TestLoadImage: error",!1,e),r.onabort=ht(ar,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ht(ar,n,r,"TestLoadImage: timeout",!1,e),et.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Xe(2);t.v=0,t.f&&t.f.ra(e),Fr(t),Ar(t)}function Fr(t){t.v=0,t.I=-1,t.f&&(0==ir(t.b).length&&0==t.g.length||(t.b.c.length=0,gt(t.g),t.g.length=0),t.f.qa())}function qr(t,e,n){var r=function(t){return t instanceof Dn?xn(t):new Dn(t,void 0)}(n);if(""!=r.c)e&&kn(r,e+"."+r.c),Pn(r,r.h);else{var i=et.location;r=function(t,e,n,r){var i=new Dn(null,void 0);return t&&On(i,t),e&&kn(i,e),n&&Pn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&Nt(t.V,(function(t,e){Ln(r,e,t)})),e=t.A,n=t.na,e&&n&&Ln(r,e,n),Ln(r,"VER",t.ha),Or(t,r),r}function zr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new hr(t.Na)).F=t.C,e}function Br(){}function Gr(){if(Ct&&!(10<=Number(Ht)))throw Error("Environmental error: no available transport.")}function Hr(t,e){me.call(this),this.a=new Ir(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!mt(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!mt(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Kr(this)}function Qr(t){sn.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Yr(){un.call(this),this.status=1}function Kr(t){this.a=t}(Z=hr.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?en(this.H):en(rn),this.a.onreadystatechange=ct(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void vr(this,t)}t=n||"";var i=new Tn(this.headers);r&&In(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=dr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=et.FormData&&t instanceof et.FormData,!(0<=dt(pr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{br(this),0<this.o&&((this.D=function(t){return Ct&&Gt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=ct(this.xa,this)):this.m=Le(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){vr(this,t)}},Z.xa=function(){void 0!==tt&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,be(this,"timeout"),this.abort(8))},Z.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,be(this,"complete"),be(this,"abort"),mr(this))},Z.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),mr(this,!0)),hr.X.G.call(this)},Z.za=function(){this.j||(this.A||this.l||this.g?gr(this):this.Ua())},Z.Ua=function(){gr(this)},Z.W=function(){try{return 2<wr(this)?this.a.status:-1}catch(t){return-1}},Z.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},Z.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),cr(e)}},Z.ua=function(){return this.h},Z.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(Z=Ir.prototype).ha=8,Z.v=1,Z.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new cn(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Dt(r=At(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=kr(this,n,e),Ln(i=xn(this.B),"RID",t),Ln(i,"CVER",22),this.A&&Ln(i,"X-HTTP-Session-Id",this.A),Or(this,i),this.i&&r&&_r(i,this.i,r),nr(this.b,n),this.Ia&&Ln(i,"TYPE","init"),this.da?(Ln(i,"$req",e),Ln(i,"SID","null"),n.U=!0,pn(n,i,null)):pn(n,i,e),this.v=2}}else 3==this.v&&(t?xr(this,t):0==this.g.length||$n(this.b)||xr(this))},Z.Aa=function(){if(this.j=null,Rr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Je(ct(this.Ta,this),t)}},Z.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xe(10),Nr(this),Rr(this))},Z.Sa=function(){null!=this.m&&(this.m=null,Nr(this),Cr(this),Xe(19))},Z.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Xe(2)):(this.c.info("Failed to ping google.com"),Xe(1))},(Z=Br.prototype).ta=function(){},Z.sa=function(){},Z.ra=function(){},Z.qa=function(){},Z.Ja=function(){},Gr.prototype.a=function(t,e){return new Hr(t,e)},lt(Hr,me),Hr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Xe(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=qr(t,null,t.fa),Dr(t)},Hr.prototype.close=function(){Tr(this.a)},Hr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Sr(this.a,e)}else this.l?((e={}).__data__=_e(t),Sr(this.a,e)):Sr(this.a,t)},Hr.prototype.G=function(){this.a.f=null,delete this.f,Tr(this.a),delete this.a,Hr.X.G.call(this)},lt(Qr,sn),lt(Yr,un),lt(Kr,Br),Kr.prototype.ta=function(){be(this.a,"a")},Kr.prototype.sa=function(t){be(this.a,new Qr(t))},Kr.prototype.ra=function(t){be(this.a,new Yr(t))},Kr.prototype.qa=function(){be(this.a,"b")},Gr.prototype.createWebChannel=Gr.prototype.a,Hr.prototype.send=Hr.prototype.h,Hr.prototype.open=Hr.prototype.g,Hr.prototype.close=Hr.prototype.close,Ze.NO_ERROR=0,Ze.TIMEOUT=8,Ze.HTTP_ERROR=6,$e.COMPLETE="complete",nn.EventType=on,on.OPEN="a",on.CLOSE="b",on.ERROR="c",on.MESSAGE="d",me.prototype.listen=me.prototype.va,hr.prototype.listenOnce=hr.prototype.wa,hr.prototype.getLastError=hr.prototype.Qa,hr.prototype.getLastErrorCode=hr.prototype.ua,hr.prototype.getStatus=hr.prototype.W,hr.prototype.getResponseJson=hr.prototype.Pa,hr.prototype.getResponseText=hr.prototype.$,hr.prototype.send=hr.prototype.ba;var Xr=Ze,Wr=$e,Jr=Be,Zr=10,$r=11,ti=nn,ei=hr,ni=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},ri=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),ii=new L("@firebase/firestore");function oi(){return ii.logLevel}function si(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ii.logLevel<=S.DEBUG){var r=e.map(ci);ii.debug.apply(ii,a(["Firestore (8.2.9): "+t],r))}}function ui(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ii.logLevel<=S.ERROR){var r=e.map(ci);ii.error.apply(ii,a(["Firestore (8.2.9): "+t],r))}}function ai(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ii.logLevel<=S.WARN){var r=e.map(ci);ii.warn.apply(ii,a(["Firestore (8.2.9): "+t],r))}}function ci(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function hi(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.9) INTERNAL ASSERTION FAILED: "+t;throw ui(e),new Error(e)}function fi(t,e){t||hi()}function li(t,e){return t}function pi(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var di=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=pi(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function vi(t,e){return t<e?-1:t>e?1:0}function yi(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function gi(t){return t+"\0"}var mi=function(){function t(t){this.h=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.h,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.h)},t.prototype.l=function(){return 2*this.h.length},t.prototype._=function(t){return vi(this.h,t.h)},t.prototype.isEqual=function(t){return this.h===t.h},t}();mi.T=new mi("");var bi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},wi=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return n(e,t),e}(Error),_i=function(){function t(t){this.I=t}return t.fromBase64String=function(e){try{return new t(mi.fromBase64String(e))}catch(e){throw new wi(bi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(mi.fromUint8Array(e))},t.prototype.toBase64=function(){return this.I.toBase64()},t.prototype.toUint8Array=function(){return this.I.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.I.isEqual(t.I)},t}(),Ei=function(){function t(t){this.uid=t}return t.prototype.m=function(){return null!=this.uid},t.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Ei.UNAUTHENTICATED=new Ei(null),Ei.R=new Ei("google-credentials-uid"),Ei.P=new Ei("first-party-uid");var Ii=function(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t},Ti=function(){function t(){this.V=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.p=function(){},t.prototype.v=function(t){this.V=t,t(Ei.UNAUTHENTICATED)},t.prototype.S=function(){this.V=null},t}(),Ni=function(){function t(t){var e=this;this.D=null,this.currentUser=Ei.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){e.N++,e.currentUser=e.$(),e.C=!0,e.V&&e.V(e.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then((function(t){e.auth=t,e.D&&e.auth.addAuthTokenListener(e.D)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.N,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.N!==e?(si("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(fi("string"==typeof n.accessToken),new Ii(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.p=function(){this.forceRefresh=!0},t.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},t.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},t.prototype.$=function(){var t=this.auth&&this.auth.getUid();return fi(null===t||"string"==typeof t),new Ei(t)},t}(),Ai=function(){function t(t,e){this.F=t,this.O=e,this.type="FirstParty",this.user=Ei.P}return Object.defineProperty(t.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.O},e=this.F.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Si=function(){function t(t,e){this.F=t,this.O=e}return t.prototype.getToken=function(){return Promise.resolve(new Ai(this.F,this.O))},t.prototype.v=function(t){t(Ei.P)},t.prototype.S=function(){},t.prototype.p=function(){},t}(),Di=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.k=function(t){return n.M(t)},this.L=function(t){return e.B(t)})}return t.prototype.M=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.L&&this.L(t),t},t}();Di.q=-1;var xi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new wi(bi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new wi(bi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new wi(bi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new wi(bi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.U=function(t){return this.seconds===t.seconds?vi(this.nanoseconds,t.nanoseconds):vi(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Oi=function(){function t(t){this.timestamp=t}return t.K=function(e){return new t(e)},t.min=function(){return new t(new xi(0,0))},t.prototype._=function(t){return this.timestamp.U(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.j=function(){return this.timestamp},t}(),ki=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&hi(),void 0===n?n=t.length-e:n>t.length-e&&hi(),this.segments=t,this.offset=e,this.G=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.H(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.J(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.Y=function(t){return t=void 0===t?1:t,this.J(this.segments,this.offset+t,this.length-t)},t.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},t.prototype.Z=function(){return this.segments[this.offset]},t.prototype.tt=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.et=function(){return 0===this.length},t.prototype.nt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},t.H=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Pi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.J=function(t,n,r){return new e(t,n,r)},e.prototype.rt=function(){return this.it().join("/")},e.prototype.toString=function(){return this.rt()},e.ot=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new wi(bi.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.ct=function(){return new e([])},e}(ki),Ci=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Li=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.J=function(t,n,r){return new e(t,n,r)},e.at=function(t){return Ci.test(t)},e.prototype.rt=function(){return this.it().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.at(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.rt()},e.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},e.ht=function(){return new e(["__name__"])},e.lt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new wi(bi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new wi(bi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new wi(bi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new wi(bi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.ct=function(){return new e([])},e}(ki),Ri=function(){function t(t){this.path=t}return t._t=function(e){return new t(Pi.ot(e))},t.ft=function(e){return new t(Pi.ot(e).Y(5))},t.prototype.dt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Pi.H(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.H=function(t,e){return Pi.H(t.path,e.path)},t.wt=function(t){return t.length%2==0},t.Et=function(e){return new t(new Pi(e.slice()))},t}();function Vi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Mi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ji(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ui=function(){function t(t){this.fields=t,t.sort(Li.H)}return t.prototype.Tt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].nt(t))return!0;return!1},t.prototype.isEqual=function(t){return yi(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Fi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qi(t){if(fi(!!t),"string"==typeof t){var e=0,n=Fi.exec(t);if(fi(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:zi(t.seconds),nanos:zi(t.nanos)}}function zi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Bi(t){return"string"==typeof t?mi.fromBase64String(t):mi.fromUint8Array(t)}function Gi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Hi(t){var e=t.mapValue.fields.__previous_value__;return Gi(e)?Hi(e):e}function Qi(t){var e=qi(t.mapValue.fields.__local_write_time__.timestampValue);return new xi(e.seconds,e.nanos)}function Yi(t){return null==t}function Ki(t){return 0===t&&1/t==-1/0}function Xi(t){return"number"==typeof t&&Number.isInteger(t)&&!Ki(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Wi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Gi(t)?4:10:hi()}function Ji(t,e){var n=Wi(t);if(n!==Wi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qi(t).isEqual(Qi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=qi(t.timestampValue),r=qi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Bi(t.bytesValue).isEqual(Bi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return zi(t.geoPointValue.latitude)===zi(e.geoPointValue.latitude)&&zi(t.geoPointValue.longitude)===zi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return zi(t.integerValue)===zi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=zi(t.doubleValue),r=zi(e.doubleValue);return n===r?Ki(n)===Ki(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return yi(t.arrayValue.values||[],e.arrayValue.values||[],Ji);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Vi(n)!==Vi(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ji(n[i],r[i])))return!1;return!0}(t,e);default:return hi()}}function Zi(t,e){return void 0!==(t.values||[]).find((function(t){return Ji(t,e)}))}function $i(t,e){var n=Wi(t),r=Wi(e);if(n!==r)return vi(n,r);switch(n){case 0:return 0;case 1:return vi(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=zi(t.integerValue||t.doubleValue),r=zi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return to(t.timestampValue,e.timestampValue);case 4:return to(Qi(t),Qi(e));case 5:return vi(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Bi(t),r=Bi(e);return n._(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=vi(n[i],r[i]);if(0!==o)return o}return vi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=vi(zi(t.latitude),zi(e.latitude));return 0!==n?n:vi(zi(t.longitude),zi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=$i(n[i],r[i]);if(o)return o}return vi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=vi(r[s],o[s]);if(0!==u)return u;var a=$i(n[r[s]],i[o[s]]);if(0!==a)return a}return vi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw hi()}}function to(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return vi(t,e);var n=qi(t),r=qi(e),i=vi(n.seconds,r.seconds);return 0!==i?i:vi(n.nanos,r.nanos)}function eo(t){return no(t)}function no(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=qi(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Bi(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Ri.ft(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=no(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+no(t.fields[o])}return e+"}"}(t.mapValue):hi();var e,n}function ro(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.rt()}}function io(t){return!!t&&"integerValue"in t}function oo(t){return!!t&&"arrayValue"in t}function so(t){return!!t&&"nullValue"in t}function uo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ao(t){return!!t&&"mapValue"in t}var co=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.et())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ao(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.tt()])||null},t.prototype.isEqual=function(t){return Ji(this.proto,t.proto)},t}(),ho=function(){function t(t){void 0===t&&(t=co.empty()),this.It=t,this.At=new Map}return t.prototype.set=function(t,e){return this.Rt(t,e),this},t.prototype.delete=function(t){return this.Rt(t,null),this},t.prototype.Rt=function(t,e){for(var n=this.At,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Wi(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.tt(),e)},t.prototype.Pt=function(){var t=this.yt(Li.ct(),this.At);return null!=t?new co(t):this.It},t.prototype.yt=function(t,e){var n=this,r=!1,i=this.It.field(t),o=ao(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.yt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function fo(t){var e=[];return Mi(t.fields||{},(function(t,n){var r=new Li([t]);if(ao(n)){var i=fo(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)})),new Ui(e)}var lo=function(t,e){this.key=t,this.version=e},po=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).gt=r,o.Vt=!!i.Vt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return n(e,t),e.prototype.field=function(t){return this.gt.field(t)},e.prototype.data=function(){return this.gt},e.prototype.bt=function(){return this.gt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Vt===t.Vt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gt.isEqual(t.gt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(lo),vo=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return n(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(lo),yo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(lo),go=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.vt=null};function mo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new go(t,e,n,r,i,o,s)}function bo(t){var e=li(t);if(null===e.vt){var n=e.path.rt();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.rt()+t.op.toString()+eo(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.rt()+t.dir}(t)})).join(","),Yi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Po(e.startAt)),e.endAt&&(n+="|ub:",n+=Po(e.endAt)),e.vt=n}return e.vt}function wo(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Lo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Ji(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Vo(t.startAt,e.startAt)&&Vo(t.endAt,e.endAt)}function _o(t){return Ri.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Eo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return n(e,t),e.create=function(t,n,r){return t.ut()?"in"===n||"not-in"===n?this.St(t,n,r):new Io(t,n,r):"array-contains"===n?new So(t,r):"in"===n?new Do(t,r):"not-in"===n?new xo(t,r):"array-contains-any"===n?new Oo(t,r):new e(t,n,r)},e.St=function(t,e,n){return"in"===e?new To(t,n):new No(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Dt($i(e,this.value)):null!==e&&Wi(this.value)===Wi(e)&&this.Dt($i(e,this.value))},e.prototype.Dt=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return hi()}},e.prototype.Ct=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Io=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Ri.ft(r.referenceValue),i}return n(e,t),e.prototype.matches=function(t){var e=Ri.H(t.key,this.key);return this.Dt(e)},e}(Eo),To=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Ao(0,n),r}return n(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Eo),No=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Ao(0,n),r}return n(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Eo);function Ao(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Ri.ft(t.referenceValue)}))}var So=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return n(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return oo(e)&&Zi(e.arrayValue,this.value)},e}(Eo),Do=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return n(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Zi(this.value.arrayValue,e)},e}(Eo),xo=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return n(e,t),e.prototype.matches=function(t){if(Zi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Zi(this.value.arrayValue,e)},e}(Eo),Oo=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return n(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!oo(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Zi(e.value.arrayValue,t)}))},e}(Eo),ko=function(t,e){this.position=t,this.before=e};function Po(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return eo(t)})).join(",")}var Co=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Lo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Ro(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ut()?Ri.H(Ri.ft(s.referenceValue),n.key):$i(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Vo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ji(t.position[n],e.position[n]))return!1;return!0}var Mo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Nt=null,this.$t=null,this.startAt,this.endAt};function jo(t,e,n,r,i,o,s,u){return new Mo(t,e,n,r,i,o,s,u)}function Uo(t){return new Mo(t)}function Fo(t){return!Yi(t.limit)&&"F"===t.limitType}function qo(t){return!Yi(t.limit)&&"L"===t.limitType}function zo(t){return t.xt.length>0?t.xt[0].field:null}function Bo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ct())return r.field}return null}function Go(t){return null!==t.collectionGroup}function Ho(t){var e=li(t);if(null===e.Nt){e.Nt=[];var n=Bo(e),r=zo(e);if(null!==n&&null===r)n.ut()||e.Nt.push(new Co(n)),e.Nt.push(new Co(Li.ht(),"asc"));else{for(var i=!1,o=0,s=e.xt;o<s.length;o++){var u=s[o];e.Nt.push(u),u.field.ut()&&(i=!0)}if(!i){var a=e.xt.length>0?e.xt[e.xt.length-1].dir:"asc";e.Nt.push(new Co(Li.ht(),a))}}}return e.Nt}function Qo(t){var e=li(t);if(!e.$t)if("F"===e.limitType)e.$t=mo(e.path,e.collectionGroup,Ho(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ho(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Co(o.field,s))}var u=e.endAt?new ko(e.endAt.position,!e.endAt.before):null,a=e.startAt?new ko(e.startAt.position,!e.startAt.before):null;e.$t=mo(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.$t}function Yo(t,e,n){return new Mo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ko(t,e){return wo(Qo(t),Qo(e))&&t.limitType===e.limitType}function Xo(t){return bo(Qo(t))+"|lt:"+t.limitType}function Wo(t){return"Query(target="+function(t){var e=t.path.rt();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.rt()+" "+e.op+" "+eo(e.value);var e})).join(", ")+"]"),Yi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.rt()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Po(t.startAt)),t.endAt&&(e+=", endAt: "+Po(t.endAt)),"Target("+e+")"}(Qo(t))+"; limitType="+t.limitType+")"}function Jo(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.dt(t.collectionGroup)&&t.path.nt(n):Ri.wt(t.path)?t.path.isEqual(n):t.path.st(n)}(t,e)&&function(t,e){for(var n=0,r=t.xt;n<r.length;n++){var i=r[n];if(!i.field.ut()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Ro(t.startAt,Ho(t),e)||t.endAt&&Ro(t.endAt,Ho(t),e))}(t,e)}function Zo(t){return function(e,n){for(var r=!1,i=0,o=Ho(t);i<o.length;i++){var s=o[i],u=$o(s,e,n);if(0!==u)return u;r=r||s.field.ut()}return 0}}function $o(t,e,n){var r=t.field.ut()?Ri.H(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?$i(r,i):hi()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return hi()}}var ts=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Oi.min()),void 0===o&&(o=Oi.min()),void 0===s&&(s=mi.T),this.target=t,this.targetId=e,this.Ft=n,this.sequenceNumber=r,this.Ot=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.kt=function(e){return new t(this.target,this.targetId,this.Ft,e,this.Ot,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.Mt=function(e,n){return new t(this.target,this.targetId,this.Ft,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.Ft,this.sequenceNumber,this.Ot,e,this.resumeToken)},t}();function es(t,e){if(t.Bt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ki(e)?"-0":e}}function ns(t){return{integerValue:""+t}}function rs(t,e){return Xi(e)?ns(e):es(t,e)}var is=function(){this.qt=void 0};function os(t,e,n){return t instanceof as?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof cs?hs(t,e):t instanceof fs?ls(t,e):function(t,e){var n=us(t,e),r=ds(n)+ds(t.Ut);return io(n)&&io(t.Ut)?ns(r):es(t.Qt,r)}(t,e)}function ss(t,e,n){return t instanceof cs?hs(t,e):t instanceof fs?ls(t,e):n}function us(t,e){return t instanceof ps?io(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var as=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(is),cs=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return n(e,t),e}(is);function hs(t,e){for(var n=vs(e),r=function(t){n.some((function(e){return Ji(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var fs=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return n(e,t),e}(is);function ls(t,e){for(var n=vs(e),r=function(t){n=n.filter((function(e){return!Ji(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ps=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qt=e,r.Ut=n,r}return n(e,t),e}(is);function ds(t){return zi(t.integerValue||t.doubleValue)}function vs(t){return oo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var ys=function(t,e){this.field=t,this.transform=e},gs=function(t,e){this.version=t,this.transformResults=e},ms=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Kt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function bs(t,e){return void 0!==t.updateTime?e instanceof po&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof po}var ws=function(){};function _s(t,e,n){return t instanceof As?function(t,e,n){var r=t.value;if(n.transformResults){var i=xs(t.fieldTransforms,e,n.transformResults);r=ks(t.fieldTransforms,r,i)}return new po(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ss?function(t,e,n){if(!bs(t.jt,e))return new yo(t.key,n.version);var r=Ds(t,e,n.transformResults?xs(t.fieldTransforms,e,n.transformResults):[]);return new po(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new vo(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Es(t,e,n){return t instanceof As?function(t,e,n){if(!bs(t.jt,e))return e;var r=t.value,i=Os(t.fieldTransforms,n,e);r=ks(t.fieldTransforms,r,i);var o=Ns(e);return new po(t.key,o,r,{Vt:!0})}(t,e,n):t instanceof Ss?function(t,e,n){if(!bs(t.jt,e))return e;var r=Ns(e),i=Ds(t,e,Os(t.fieldTransforms,n,e));return new po(t.key,r,i,{Vt:!0})}(t,e,n):function(t,e){return bs(t.jt,e)?new vo(t.key,Oi.min()):e}(t,e)}function Is(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof po?e.field(o.field):void 0,u=us(o.transform,s||null);null!=u&&(n=null==n?(new ho).set(o.field,u):n.set(o.field,u))}return n?n.Pt():null}(t.fieldTransforms,e)}function Ts(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.jt.isEqual(e.jt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&yi(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof cs&&e instanceof cs||t instanceof fs&&e instanceof fs?yi(t.elements,e.elements,Ji):t instanceof ps&&e instanceof ps?Ji(t.Ut,e.Ut):t instanceof as&&e instanceof as}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Gt.isEqual(e.Gt))}function Ns(t){return t instanceof po?t.version:Oi.min()}var As=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.jt=r,o.fieldTransforms=i,o.type=0,o}return n(e,t),e}(ws),Ss=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.Gt=r,s.jt=i,s.fieldTransforms=o,s.type=1,s}return n(e,t),e}(ws);function Ds(t,e,n){var r;return r=function(t,e){var n=new ho(e);return t.Gt.fields.forEach((function(e){if(!e.et()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Pt()}(t,r=e instanceof po?e.data():co.empty()),ks(t.fieldTransforms,r,n)}function xs(t,e,n){var r=[];fi(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof po&&(u=e.field(o.field)),r.push(ss(s,u,n[i]))}return r}function Os(t,e,n){for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i],u=s.transform,a=null;n instanceof po&&(a=n.field(s.field)),r.push(os(u,a,e))}return r}function ks(t,e,n){for(var r=new ho(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Pt()}var Ps,Cs,Ls=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=2,r.fieldTransforms=[],r}return n(e,t),e}(ws),Rs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=3,r.fieldTransforms=[],r}return n(e,t),e}(ws),Vs=function(t){this.count=t};function Ms(t){switch(t){case bi.OK:return hi();case bi.CANCELLED:case bi.UNKNOWN:case bi.DEADLINE_EXCEEDED:case bi.RESOURCE_EXHAUSTED:case bi.INTERNAL:case bi.UNAVAILABLE:case bi.UNAUTHENTICATED:return!1;case bi.INVALID_ARGUMENT:case bi.NOT_FOUND:case bi.ALREADY_EXISTS:case bi.PERMISSION_DENIED:case bi.FAILED_PRECONDITION:case bi.ABORTED:case bi.OUT_OF_RANGE:case bi.UNIMPLEMENTED:case bi.DATA_LOSS:return!0;default:return hi()}}function js(t){if(void 0===t)return ui("GRPC error has no .code"),bi.UNKNOWN;switch(t){case Ps.OK:return bi.OK;case Ps.CANCELLED:return bi.CANCELLED;case Ps.UNKNOWN:return bi.UNKNOWN;case Ps.DEADLINE_EXCEEDED:return bi.DEADLINE_EXCEEDED;case Ps.RESOURCE_EXHAUSTED:return bi.RESOURCE_EXHAUSTED;case Ps.INTERNAL:return bi.INTERNAL;case Ps.UNAVAILABLE:return bi.UNAVAILABLE;case Ps.UNAUTHENTICATED:return bi.UNAUTHENTICATED;case Ps.INVALID_ARGUMENT:return bi.INVALID_ARGUMENT;case Ps.NOT_FOUND:return bi.NOT_FOUND;case Ps.ALREADY_EXISTS:return bi.ALREADY_EXISTS;case Ps.PERMISSION_DENIED:return bi.PERMISSION_DENIED;case Ps.FAILED_PRECONDITION:return bi.FAILED_PRECONDITION;case Ps.ABORTED:return bi.ABORTED;case Ps.OUT_OF_RANGE:return bi.OUT_OF_RANGE;case Ps.UNIMPLEMENTED:return bi.UNIMPLEMENTED;case Ps.DATA_LOSS:return bi.DATA_LOSS;default:return hi()}}(Cs=Ps||(Ps={}))[Cs.OK=0]="OK",Cs[Cs.CANCELLED=1]="CANCELLED",Cs[Cs.UNKNOWN=2]="UNKNOWN",Cs[Cs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Cs[Cs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Cs[Cs.NOT_FOUND=5]="NOT_FOUND",Cs[Cs.ALREADY_EXISTS=6]="ALREADY_EXISTS",Cs[Cs.PERMISSION_DENIED=7]="PERMISSION_DENIED",Cs[Cs.UNAUTHENTICATED=16]="UNAUTHENTICATED",Cs[Cs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Cs[Cs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Cs[Cs.ABORTED=10]="ABORTED",Cs[Cs.OUT_OF_RANGE=11]="OUT_OF_RANGE",Cs[Cs.UNIMPLEMENTED=12]="UNIMPLEMENTED",Cs[Cs.INTERNAL=13]="INTERNAL",Cs[Cs.UNAVAILABLE=14]="UNAVAILABLE",Cs[Cs.DATA_LOSS=15]="DATA_LOSS";var Us=function(){function t(t,e){this.H=t,this.root=e||qs.EMPTY}return t.prototype.zt=function(e,n){return new t(this.H,this.root.zt(e,n,this.H).copy(null,null,qs.Ht,null,null))},t.prototype.remove=function(e){return new t(this.H,this.root.remove(e,this.H).copy(null,null,qs.Ht,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.et();){var n=this.H(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.et();){var r=this.H(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.et=function(){return this.root.et()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Jt=function(){return this.root.Jt()},t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(t){return this.root.Xt(t)},t.prototype.forEach=function(t){this.Xt((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.Xt((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.te=function(){return new Fs(this.root,null,this.H,!1)},t.prototype.ee=function(t){return new Fs(this.root,t,this.H,!1)},t.prototype.ne=function(){return new Fs(this.root,null,this.H,!0)},t.prototype.se=function(t){return new Fs(this.root,t,this.H,!0)},t}(),Fs=function(){function t(t,e,n,r){this.ie=r,this.re=[];for(var i=1;!t.et();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ie?t.left:t.right;else{if(0===i){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}return t.prototype.oe=function(){var t=this.re.pop(),e={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return e},t.prototype.ce=function(){return this.re.length>0},t.prototype.ae=function(){if(0===this.re.length)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},t}(),qs=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.et=function(){return!1},t.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},t.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},t.prototype.min=function(){return this.left.et()?this:this.left.min()},t.prototype.Jt=function(){return this.min().key},t.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},t.prototype.zt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.zt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.zt(t,e,n))).ue()},t.prototype.he=function(){if(this.left.et())return t.EMPTY;var e=this;return e.left.le()||e.left.left.le()||(e=e._e()),(e=e.copy(null,null,null,e.left.he(),null)).ue()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.et()||i.left.le()||i.left.left.le()||(i=i._e()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.le()&&(i=i.fe()),i.right.et()||i.right.le()||i.right.left.le()||(i=i.de()),0===n(e,i.key)){if(i.right.et())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.he())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.ue()},t.prototype.le=function(){return this.color},t.prototype.ue=function(){var t=this;return t.right.le()&&!t.left.le()&&(t=t.we()),t.left.le()&&t.left.left.le()&&(t=t.fe()),t.left.le()&&t.right.le()&&(t=t.Ee()),t},t.prototype._e=function(){var t=this.Ee();return t.right.left.le()&&(t=(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee()),t},t.prototype.de=function(){var t=this.Ee();return t.left.left.le()&&(t=(t=t.fe()).Ee()),t},t.prototype.we=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.fe=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},t.prototype.Ie=function(){if(this.le()&&this.left.le())throw hi();if(this.right.le())throw hi();var t=this.left.Ie();if(t!==this.right.Ie())throw hi();return t+(this.le()?0:1)},t}();qs.EMPTY=null,qs.RED=!0,qs.Ht=!1,qs.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw hi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw hi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw hi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw hi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw hi()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.zt=function(t,e,n){return new qs(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.et=function(){return!0},t.prototype.Xt=function(t){return!1},t.prototype.Zt=function(t){return!1},t.prototype.Jt=function(){return null},t.prototype.Yt=function(){return null},t.prototype.le=function(){return!1},t.prototype.Te=function(){return!0},t.prototype.Ie=function(){return 0},t}());var zs=function(){function t(t){this.H=t,this.data=new Us(this.H)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Jt()},t.prototype.last=function(){return this.data.Yt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Xt((function(e,n){return t(e),!1}))},t.prototype.me=function(t,e){for(var n=this.data.ee(t[0]);n.ce();){var r=n.oe();if(this.H(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ae=function(t,e){var n;for(n=void 0!==e?this.data.ee(e):this.data.te();n.ce();)if(!t(n.oe().key))return},t.prototype.Re=function(t){var e=this.data.ee(t);return e.ce()?e.oe().key:null},t.prototype.te=function(){return new Bs(this.data.te())},t.prototype.ee=function(t){return new Bs(this.data.ee(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.et=function(){return this.data.et()},t.prototype.Pe=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.te(),r=e.data.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(0!==this.H(i,o))return!1}return!0},t.prototype.it=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.H);return n.data=e,n},t}(),Bs=function(){function t(t){this.ye=t}return t.prototype.oe=function(){return this.ye.oe().key},t.prototype.ce=function(){return this.ye.ce()},t}(),Gs=new Us(Ri.H);function Hs(){return Gs}function Qs(){return Hs()}var Ys=new Us(Ri.H);function Ks(){return Ys}var Xs=new Us(Ri.H);function Ws(){return Xs}var Js=new zs(Ri.H);function Zs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Js,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var $s=new zs(vi);function tu(){return $s}var eu=function(){function t(t){this.H=t?function(e,n){return t(e,n)||Ri.H(e.key,n.key)}:function(t,e){return Ri.H(t.key,e.key)},this.ge=Ks(),this.Ve=new Us(this.H)}return t.pe=function(e){return new t(e.H)},t.prototype.has=function(t){return null!=this.ge.get(t)},t.prototype.get=function(t){return this.ge.get(t)},t.prototype.first=function(){return this.Ve.Jt()},t.prototype.last=function(){return this.Ve.Yt()},t.prototype.et=function(){return this.Ve.et()},t.prototype.indexOf=function(t){var e=this.ge.get(t);return e?this.Ve.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Ve.Xt((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ge.zt(t.key,t),e.Ve.zt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ge.remove(t),this.Ve.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Ve.te(),r=e.Ve.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.H=this.H,r.ge=e,r.Ve=n,r},t}(),nu=function(){function t(){this.be=new Us(Ri.H)}return t.prototype.track=function(t){var e=t.doc.key,n=this.be.get(e);n?0!==t.type&&3===n.type?this.be=this.be.zt(e,t):3===t.type&&1!==n.type?this.be=this.be.zt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.be=this.be.zt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.be=this.be.remove(e):1===t.type&&2===n.type?this.be=this.be.zt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):hi():this.be=this.be.zt(e,t)},t.prototype.ve=function(){var t=[];return this.be.Xt((function(e,n){t.push(n)})),t},t}(),ru=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Se=n,this.docChanges=r,this.De=i,this.fromCache=o,this.Ce=s,this.xe=u}return t.Ne=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,eu.pe(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&Ko(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),iu=function(){function t(t,e,n,r,i){this.Ot=t,this.$e=e,this.Fe=n,this.Oe=r,this.ke=i}return t.Me=function(e,n){var r=new Map;return r.set(e,ou.Le(e,n)),new t(Oi.min(),r,tu(),Hs(),Zs())},t}(),ou=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Be=e,this.qe=n,this.Ue=r,this.Qe=i}return t.Le=function(e,n){return new t(mi.T,n,Zs(),Zs(),Zs())},t}(),su=function(t,e,n,r){this.Ke=t,this.removedTargetIds=e,this.key=n,this.We=r},uu=function(t,e){this.targetId=t,this.je=e},au=function(t,e,n,r){void 0===n&&(n=mi.T),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},cu=function(){function t(){this.Ge=0,this.ze=lu(),this.He=mi.T,this.Je=!1,this.Ye=!0}return Object.defineProperty(t.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Xe",{get:function(){return 0!==this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),t.prototype.tn=function(t){t.l()>0&&(this.Ye=!0,this.He=t)},t.prototype.en=function(){var t=Zs(),e=Zs(),n=Zs();return this.ze.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:hi()}})),new ou(this.He,this.Je,t,e,n)},t.prototype.nn=function(){this.Ye=!1,this.ze=lu()},t.prototype.sn=function(t,e){this.Ye=!0,this.ze=this.ze.zt(t,e)},t.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},t.prototype.on=function(){this.Ge+=1},t.prototype.cn=function(){this.Ge-=1},t.prototype.an=function(){this.Ye=!0,this.Je=!0},t}(),hu=function(){function t(t){this.un=t,this.hn=new Map,this.ln=Hs(),this._n=fu(),this.fn=new zs(vi)}return t.prototype.dn=function(t){for(var e=0,n=t.Ke;e<n.length;e++){var r=n[e];t.We instanceof po?this.wn(r,t.We):t.We instanceof vo&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},t.prototype.Tn=function(t){var e=this;this.In(t,(function(n){var r=e.mn(n);switch(t.state){case 0:e.An(n)&&r.tn(t.resumeToken);break;case 1:r.cn(),r.Xe||r.nn(),r.tn(t.resumeToken);break;case 2:r.cn(),r.Xe||e.removeTarget(n);break;case 3:e.An(n)&&(r.an(),r.tn(t.resumeToken));break;case 4:e.An(n)&&(e.Rn(n),r.tn(t.resumeToken));break;default:hi()}}))},t.prototype.In=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.hn.forEach((function(t,r){n.An(r)&&e(r)}))},t.prototype.Pn=function(t){var e=t.targetId,n=t.je.count,r=this.yn(e);if(r){var i=r.target;if(_o(i))if(0===n){var o=new Ri(i.path);this.En(e,o,new vo(o,Oi.min()))}else fi(1===n);else this.gn(e)!==n&&(this.Rn(e),this.fn=this.fn.add(e))}},t.prototype.Vn=function(t){var e=this,n=new Map;this.hn.forEach((function(r,i){var o=e.yn(i);if(o){if(r.Be&&_o(o.target)){var s=new Ri(o.target.path);null!==e.ln.get(s)||e.pn(i,s)||e.En(i,s,new vo(s,t))}r.Ze&&(n.set(i,r.en()),r.nn())}}));var r=Zs();this._n.forEach((function(t,n){var i=!0;n.Ae((function(t){var n=e.yn(t);return!n||2===n.Ft||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new iu(t,n,this.fn,this.ln,r);return this.ln=Hs(),this._n=fu(),this.fn=new zs(vi),i},t.prototype.wn=function(t,e){if(this.An(t)){var n=this.pn(t,e.key)?2:0;this.mn(t).sn(e.key,n),this.ln=this.ln.zt(e.key,e),this._n=this._n.zt(e.key,this.bn(e.key).add(t))}},t.prototype.En=function(t,e,n){if(this.An(t)){var r=this.mn(t);this.pn(t,e)?r.sn(e,1):r.rn(e),this._n=this._n.zt(e,this.bn(e).delete(t)),n&&(this.ln=this.ln.zt(e,n))}},t.prototype.removeTarget=function(t){this.hn.delete(t)},t.prototype.gn=function(t){var e=this.mn(t).en();return this.un.vn(t).size+e.qe.size-e.Qe.size},t.prototype.on=function(t){this.mn(t).on()},t.prototype.mn=function(t){var e=this.hn.get(t);return e||(e=new cu,this.hn.set(t,e)),e},t.prototype.bn=function(t){var e=this._n.get(t);return e||(e=new zs(vi),this._n=this._n.zt(t,e)),e},t.prototype.An=function(t){var e=null!==this.yn(t);return e||si("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.yn=function(t){var e=this.hn.get(t);return e&&e.Xe?null:this.un.Sn(t)},t.prototype.Rn=function(t){var e=this;this.hn.set(t,new cu),this.un.vn(t).forEach((function(n){e.En(t,n,null)}))},t.prototype.pn=function(t,e){return this.un.vn(t).has(e)},t}();function fu(){return new Us(Ri.H)}function lu(){return new Us(Ri.H)}var pu={asc:"ASCENDING",desc:"DESCENDING"},du={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vu=function(t,e){this.t=t,this.Bt=e};function yu(t,e){return t.Bt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function gu(t,e){return t.Bt?e.toBase64():e.toUint8Array()}function mu(t,e){return yu(t,e.j())}function bu(t){return fi(!!t),Oi.K(function(t){var e=qi(t);return new xi(e.seconds,e.nanos)}(t))}function wu(t,e){return function(t){return new Pi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).rt()}function _u(t){var e=Pi.ot(t);return fi(Hu(e)),e}function Eu(t,e){return wu(t.t,e.path)}function Iu(t,e){var n=_u(e);if(n.get(1)!==t.t.projectId)throw new wi(bi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new wi(bi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new Ri(Su(n))}function Tu(t,e){return wu(t.t,e)}function Nu(t){var e=_u(t);return 4===e.length?Pi.ct():Su(e)}function Au(t){return new Pi(["projects",t.t.projectId,"databases",t.t.database]).rt()}function Su(t){return fi(t.length>4&&"documents"===t.get(4)),t.Y(5)}function Du(t,e,n){return{name:Eu(t,e),fields:n.proto.mapValue.fields}}function xu(t,e,n){var r=Iu(t,e.name),i=bu(e.updateTime),o=new co({mapValue:{fields:e.fields}});return new po(r,i,o,{hasCommittedMutations:!!n})}function Ou(t,e){var n;if(e instanceof As)n={update:Du(t,e.key,e.value)};else if(e instanceof Ls)n={delete:Eu(t,e.key)};else if(e instanceof Ss)n={update:Du(t,e.key,e.data),updateMask:Gu(e.Gt)};else{if(!(e instanceof Rs))return hi();n={verify:Eu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof as)return{fieldPath:e.field.rt(),setToServerValue:"REQUEST_TIME"};if(n instanceof cs)return{fieldPath:e.field.rt(),appendMissingElements:{values:n.elements}};if(n instanceof fs)return{fieldPath:e.field.rt(),removeAllFromArray:{values:n.elements}};if(n instanceof ps)return{fieldPath:e.field.rt(),increment:n.Ut};throw hi()}(0,t)}))),e.jt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:mu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:hi()}(t,e.jt)),n}function ku(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?ms.updateTime(bu(t.updateTime)):void 0!==t.exists?ms.exists(t.exists):ms.Kt()}(e.currentDocument):ms.Kt(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)fi("REQUEST_TIME"===e.setToServerValue),n=new as;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new cs(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new fs(i)}else"increment"in e?n=new ps(t,e.increment):hi();var o=Li.lt(e.fieldPath);return new ys(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Iu(t,e.update.name),o=new co({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new Ui(e.map((function(t){return Li.lt(t)})))}(e.updateMask);return new Ss(i,o,s,n,r)}return new As(i,o,n,r)}if(e.delete){var u=Iu(t,e.delete);return new Ls(u,n)}if(e.verify){var a=Iu(t,e.verify);return new Rs(a,n)}return hi()}function Pu(t,e){return{documents:[Tu(t,e.path)]}}function Cu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Tu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Tu(t,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(uo(t.value))return{unaryFilter:{field:Fu(t.field),op:"IS_NAN"}};if(so(t.value))return{unaryFilter:{field:Fu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(uo(t.value))return{unaryFilter:{field:Fu(t.field),op:"IS_NOT_NAN"}};if(so(t.value))return{unaryFilter:{field:Fu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fu(t.field),op:Uu(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Fu(t.field),direction:ju(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Bt||Yi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Vu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Vu(e.endAt)),n}function Lu(t){var e=Nu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){fi(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Ru(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return function(t){return new Co(qu(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return Yi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Mu(n.startAt));var h=null;return n.endAt&&(h=Mu(n.endAt)),jo(e,i,u,s,a,"F",c,h)}function Ru(t){return t?void 0!==t.unaryFilter?[Bu(t)]:void 0!==t.fieldFilter?[zu(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Ru(t)})).reduce((function(t,e){return t.concat(e)})):hi():[]}function Vu(t){return{before:t.before,values:t.position}}function Mu(t){var e=!!t.before,n=t.values||[];return new ko(n,e)}function ju(t){return pu[t]}function Uu(t){return du[t]}function Fu(t){return{fieldPath:t.rt()}}function qu(t){return Li.lt(t.fieldPath)}function zu(t){return Eo.create(qu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return hi()}}(t.fieldFilter.op),t.fieldFilter.value)}function Bu(t){switch(t.unaryFilter.op){case"IS_NAN":var e=qu(t.unaryFilter.field);return Eo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=qu(t.unaryFilter.field);return Eo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=qu(t.unaryFilter.field);return Eo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=qu(t.unaryFilter.field);return Eo.create(i,"!=",{nullValue:"NULL_VALUE"});default:return hi()}}function Gu(t){var e=[];return t.fields.forEach((function(t){return e.push(t.rt())})),{fieldPaths:e}}function Hu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Qu=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Yu=function(){function t(t){var e=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t((function(t){e.xn=!0,e.result=t,e.Dn&&e.Dn(t)}),(function(t){e.xn=!0,e.error=t,e.Cn&&e.Cn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Nn&&hi(),this.Nn=!0,this.xn?this.error?this.$n(n,this.error):this.Fn(e,this.result):new t((function(t,i){r.Dn=function(n){r.Fn(e,n).next(t,i)},r.Cn=function(e){r.$n(n,e).next(t,i)}}))},t.prototype.On=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.kn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Fn=function(e,n){return e?this.kn((function(){return e(n)})):t.resolve(n)},t.prototype.$n=function(e,n){return e?this.kn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.Mn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Ln=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.Mn(r)},t}(),Ku=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Bn=new Qu,this.transaction.oncomplete=function(){n.Bn.resolve()},this.transaction.onabort=function(){e.error?n.Bn.reject(new Ju(t,e.error)):n.Bn.resolve()},this.transaction.onerror=function(e){var r=na(e.target.error);n.Bn.reject(new Ju(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Ju(n,e)}},Object.defineProperty(t.prototype,"qn",{get:function(){return this.Bn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Bn.reject(t),this.aborted||(si("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new $u(e)},t}(),Xu=function(){function t(e,n,r){this.name=e,this.version=n,this.Un=r,12.2===t.Qn(f())&&ui("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return si("SimpleDb","Removing database:",t),ta(window.indexedDB.deleteDatabase(t)).On()},t.Kn=function(){if("undefined"==typeof indexedDB)return!1;if(t.Wn())return!0;var e=f(),n=t.Qn(e),r=0<n&&n<10,i=t.jn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Gn)},t.zn=function(t,e){return t.store(e)},t.Qn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.jn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Hn=function(t){return i(this,void 0,void 0,(function(){var e,n=this;return o(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(si("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Ju(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new wi(bi.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Ju(t,n))},i.onupgradeneeded=function(t){si("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Un.Jn(e,i.transaction,t.oldVersion,n.version).next((function(){si("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Yn&&(this.db.onversionchange=function(t){return n.Yn(t)}),this.db)]}}))}))},t.prototype.Xn=function(t){this.Yn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return i(this,void 0,void 0,(function(){var i,s,u,a,c;return o(this,(function(h){switch(h.label){case 0:i="readonly"===e,s=0,u=function(){var e,u,c,h,f;return o(this,(function(o){switch(o.label){case 0:++s,o.label=1;case 1:return o.trys.push([1,4,,5]),[4,a.Hn(t)];case 2:return a.db=o.sent(),e=Ku.open(a.db,t,i?"readonly":"readwrite",n),u=r(e).catch((function(t){return e.abort(t),Yu.reject(t)})).On(),c={},u.catch((function(){})),[4,e.qn];case 3:return[2,(c.value=(o.sent(),u),c)];case 4:return h=o.sent(),f="FirebaseError"!==h.name&&s<3,si("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),a.close(),f?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}}))},a=this,h.label=1;case 1:return[5,u()];case 2:if("object"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Wu=function(){function t(t){this.Zn=t,this.ts=!1,this.es=null}return Object.defineProperty(t.prototype,"xn",{get:function(){return this.ts},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ns",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.ts=!0},t.prototype.ss=function(t){this.es=t},t.prototype.delete=function(){return ta(this.Zn.delete())},t}(),Ju=function(t){function e(e,n){var r=this;return(r=t.call(this,bi.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return n(e,t),e}(wi);function Zu(t){return"IndexedDbTransactionError"===t.name}var $u=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(si("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(si("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ta(n)},t.prototype.add=function(t){return si("SimpleDb","ADD",this.store.name,t,t),ta(this.store.add(t))},t.prototype.get=function(t){var e=this;return ta(this.store.get(t)).next((function(n){return void 0===n&&(n=null),si("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return si("SimpleDb","DELETE",this.store.name,t),ta(this.store.delete(t))},t.prototype.count=function(){return si("SimpleDb","COUNT",this.store.name),ta(this.store.count())},t.prototype.rs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.os(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.cs=function(t,e){si("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.us=!1;var r=this.cursor(n);return this.os(r,(function(t,e,n){return n.delete()}))},t.prototype.hs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.os(r,e)},t.prototype.ls=function(t){var e=this.cursor({});return new Yu((function(n,r){e.onerror=function(t){var e=na(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.os=function(t,e){var n=[];return new Yu((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Wu(i),s=e(i.primaryKey,i.value,o);if(s instanceof Yu){var u=s.catch((function(t){return o.done(),Yu.reject(t)}));n.push(u)}o.xn?r():null===o.ns?i.continue():i.continue(o.ns)}else r()}})).next((function(){return Yu.Mn(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.us?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ta(t){return new Yu((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=na(t.target.error);n(e)}}))}var ea=!1;function na(t){var e=Xu.Qn(f());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new wi("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ea||(ea=!0,setTimeout((function(){throw r}),0)),r}}return t}var ra=function(){function t(t,e,n,r,i){this._s=t,this.fs=e,this.ds=n,this.op=r,this.ws=i,this.Es=new Qu,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch((function(t){}))}return t.Ts=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.Is=setTimeout((function(){return e.As()}),t)},t.prototype.Rs=function(){return this.As()},t.prototype.cancel=function(t){null!==this.Is&&(this.clearTimeout(),this.Es.reject(new wi(bi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.As=function(){var t=this;this._s.Ps((function(){return null!==t.Is?(t.clearTimeout(),t.op().then((function(e){return t.Es.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.Is&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},t}();function ia(t,e){if(ui("AsyncQueue",e+": "+t),Zu(t))return new wi(bi.UNAVAILABLE,e+": "+t);throw t}var oa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",sa=function(){function t(){this.ys=[]}return t.prototype.gs=function(t){this.ys.push(t)},t.prototype.Vs=function(){this.ys.forEach((function(t){return t()}))},t}();function ua(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=ca(e)),e=aa(t.get(n),e);return ca(e)}function aa(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function ca(t){return t+""}function ha(t){var e=t.length;if(fi(e>=2),2===e)return fi(""===t.charAt(0)&&""===t.charAt(1)),Pi.ct();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&hi(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:hi()}o=s+2}return new Pi(r)}var fa=function(t,e){this.seconds=t,this.nanoseconds=e},la=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};la.store="owner",la.key="owner";var pa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};pa.store="mutationQueues",pa.keyPath="userId";var da=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};da.store="mutations",da.keyPath="batchId",da.userMutationsIndex="userMutationsIndex",da.userMutationsKeyPath=["userId","batchId"];var va=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ua(e)]},t.key=function(t,e,n){return[t,ua(e),n]},t}();va.store="documentMutations",va.PLACEHOLDER=new va;var ya=function(t,e){this.path=t,this.readTime=e},ga=function(t,e){this.path=t,this.version=e},ma=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ma.store="remoteDocuments",ma.readTimeIndex="readTimeIndex",ma.readTimeIndexPath="readTime",ma.collectionReadTimeIndex="collectionReadTimeIndex",ma.collectionReadTimeIndexPath=["parentPath","readTime"];var ba=function(t){this.byteSize=t};ba.store="remoteDocumentGlobal",ba.key="remoteDocumentGlobalKey";var wa=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};wa.store="targets",wa.keyPath="targetId",wa.queryTargetsIndexName="queryTargetsIndex",wa.queryTargetsKeyPath=["canonicalId","targetId"];var _a=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};_a.store="targetDocuments",_a.keyPath=["targetId","path"],_a.documentTargetsIndex="documentTargetsIndex",_a.documentTargetsKeyPath=["path","targetId"];var Ea=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ea.key="targetGlobalKey",Ea.store="targetGlobal";var Ia=function(t,e){this.collectionId=t,this.parent=e};Ia.store="collectionParents",Ia.keyPath=["collectionId","parent"];var Ta=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ta.store="clientMetadata",Ta.keyPath="clientId";var Na=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Na.store="bundles",Na.keyPath="bundleId";var Aa=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Aa.store="namedQueries",Aa.keyPath="name";var Sa=a(a(a(a([pa.store,da.store,va.store,ma.store,wa.store,la.store,Ea.store,_a.store],[Ta.store]),[ba.store]),[Ia.store]),[Na.store,Aa.store]),Da=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ps=e,r.bs=n,r}return n(e,t),e}(sa);function xa(t,e){var n=li(t);return Xu.zn(n.ps,e)}var Oa=function(){function t(t,e,n,r){this.batchId=t,this.vs=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ss=function(t,e,n){for(var r=n.Ds,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=_s(o,e,r[i]))}return e},t.prototype.Cs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=Es(s,e,this.vs));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=Es(s,e,this.vs))}return e},t.prototype.xs=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.Cs(r.key,t.get(r.key));i&&(n=n.zt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Zs())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&yi(this.mutations,t.mutations,(function(t,e){return Ts(t,e)}))&&yi(this.baseMutations,t.baseMutations,(function(t,e){return Ts(t,e)}))},t}(),ka=function(){function t(t,e,n,r){this.batch=t,this.Ns=e,this.Ds=n,this.$s=r}return t.from=function(e,n,r){fi(e.mutations.length===r.length);for(var i=Ws(),o=e.mutations,s=0;s<o.length;s++)i=i.zt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Pa=function(t){this.Fs=t};function Ca(t,e){if(e.document)return xu(t.Fs,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ri.Et(e.noDocument.path),r=ja(e.noDocument.readTime);return new vo(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Ri.Et(e.unknownDocument.path);return r=ja(e.unknownDocument.version),new yo(i,r)}return hi()}function La(t,e,n){var r=Ra(n),i=e.key.path.X().it();if(e instanceof po){var o=function(t,e){return{name:Eu(t,e.key),fields:e.bt().mapValue.fields,updateTime:yu(t,e.version.j())}}(t.Fs,e),s=e.hasCommittedMutations;return new ma(null,null,o,s,r,i)}if(e instanceof vo){var u=e.key.path.it(),a=Ma(e.version);return s=e.hasCommittedMutations,new ma(null,new ya(u,a),null,s,r,i)}if(e instanceof yo){var c=e.key.path.it(),h=Ma(e.version);return new ma(new ga(c,h),null,null,!0,r,i)}return hi()}function Ra(t){var e=t.j();return[e.seconds,e.nanoseconds]}function Va(t){var e=new xi(t[0],t[1]);return Oi.K(e)}function Ma(t){var e=t.j();return new fa(e.seconds,e.nanoseconds)}function ja(t){var e=new xi(t.seconds,t.nanoseconds);return Oi.K(e)}function Ua(t,e){for(var n=(e.baseMutations||[]).map((function(e){return ku(t.Fs,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return ku(t.Fs,e)})),u=xi.fromMillis(e.localWriteTimeMs);return new Oa(e.batchId,u,n,s)}function Fa(t){var e,n,r=ja(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ja(t.lastLimboFreeSnapshotVersion):Oi.min();return void 0!==t.query.documents?(fi(1===(n=t.query).documents.length),e=Qo(Uo(Nu(n.documents[0])))):e=function(t){return Qo(Lu(t))}(t.query),new ts(e,t.targetId,0,t.lastListenSequenceNumber,r,i,mi.fromBase64String(t.resumeToken))}function qa(t,e){var n,r=Ma(e.Ot),i=Ma(e.lastLimboFreeSnapshotVersion);n=_o(e.target)?Pu(t.Fs,e.target):Cu(t.Fs,e.target);var o=e.resumeToken.toBase64();return new wa(e.targetId,bo(e.target),r,o,e.sequenceNumber,i,n)}function za(t){var e=Lu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Yo(e,e.limit,"L"):e}var Ba=function(){function t(){}return t.prototype.Os=function(t,e){return Ga(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:ja(e.createTime),version:e.version};var e}))},t.prototype.ks=function(t,e){return Ga(t).put({bundleId:(n=e).id,createTime:Ma(bu(n.createTime)),version:n.version});var n},t.prototype.Ms=function(t,e){return Ha(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:za(e.bundledQuery),readTime:ja(e.readTime)};var e}))},t.prototype.Ls=function(t,e){return Ha(t).put(function(t){return{name:t.name,readTime:Ma(bu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Ga(t){return xa(t,Na.store)}function Ha(t){return xa(t,Aa.store)}var Qa=function(){function t(){this.Bs=new Ya}return t.prototype.qs=function(t,e){return this.Bs.add(e),Yu.resolve()},t.prototype.Us=function(t,e){return Yu.resolve(this.Bs.getEntries(e))},t}(),Ya=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.tt(),n=t.X(),r=this.index[e]||new zs(Pi.H),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.tt(),n=t.X(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new zs(Pi.H)).it()},t}(),Ka=function(){function t(){this.Qs=new Ya}return t.prototype.qs=function(t,e){var n=this;if(!this.Qs.has(e)){var r=e.tt(),i=e.X();t.gs((function(){n.Qs.add(e)}));var o={collectionId:r,parent:ua(i)};return Xa(t).put(o)}return Yu.resolve()},t.prototype.Us=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[gi(e),""],!1,!0);return Xa(t).rs(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ha(o.parent))}return n}))},t}();function Xa(t){return xa(t,Ia.store)}var Wa={Ks:!1,Ws:0,js:0,Gs:0},Ja=function(){function t(t,e,n){this.zs=t,this.Hs=e,this.Js=n}return t.Ys=function(e){return new t(e,t.Xs,t.Zs)},t}();function Za(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){if(t.code!==bi.FAILED_PRECONDITION||t.message!==oa)throw t;return si("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}Ja.Xs=10,Ja.Zs=1e3,Ja.ti=new Ja(41943040,Ja.Xs,Ja.Zs),Ja.ei=new Ja(-1,0,0);var $a=function(){function t(t,e){this.ni=t,this.si=e,this.ii={}}return t.prototype.get=function(t){var e=this.ni(t),n=this.ii[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.si(s,t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.ni(t),r=this.ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ii[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.ni(t),n=this.ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.si(n[r][0],t))return 1===n.length?delete this.ii[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Mi(this.ii,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}}))},t.prototype.et=function(){return ji(this.ii)},t}(),tc=function(){function t(){this.ri=new $a((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.oi=!1}return t.prototype.ci=function(t){var e=this.ri.get(t);return e?e.readTime:Oi.min()},t.prototype.ai=function(t,e){this.ui(),this.ri.set(t.key,{hi:t,readTime:e})},t.prototype.li=function(t,e){void 0===e&&(e=null),this.ui(),this.ri.set(t,{hi:null,readTime:e})},t.prototype._i=function(t,e){this.ui();var n=this.ri.get(e);return void 0!==n?Yu.resolve(n.hi):this.fi(t,e)},t.prototype.getEntries=function(t,e){return this.di(t,e)},t.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},t.prototype.ui=function(){},t}();function ec(t,e,n){var r=t.store(da.store),i=t.store(va.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.hs({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){fi(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=va.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Yu.Mn(o).next((function(){return c}))}function nc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw hi();e=t.noDocument}return JSON.stringify(e).length}var rc=function(){function t(t,e,n,r){this.userId=t,this.Qt=e,this.Ei=n,this.Ti=r,this.Ii={}}return t.mi=function(e,n,r,i){return fi(""!==e.uid),new t(e.m()?e.uid:"",n,r,i)},t.prototype.Ai=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return oc(t).hs({index:da.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Ri=function(t,e,n,r){var i=this,o=sc(t),s=oc(t);return s.add({}).next((function(u){fi("number"==typeof u);for(var a=new Oa(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Ou(t.Fs,e)})),i=n.mutations.map((function(e){return Ou(t.Fs,e)}));return new da(e,n.batchId,n.vs.toMillis(),r,i)}(i.Qt,i.userId,a),h=[],f=new zs((function(t,e){return vi(t.rt(),e.rt())})),l=0,p=r;l<p.length;l++){var d=p[l],v=va.key(i.userId,d.key.path,u);f=f.add(d.key.path.X()),h.push(s.put(c)),h.push(o.put(v,va.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Ei.qs(t,e))})),t.gs((function(){i.Ii[u]=a.keys()})),Yu.Mn(h).next((function(){return a}))}))},t.prototype.Pi=function(t,e){var n=this;return oc(t).get(e).next((function(t){return t?(fi(t.userId===n.userId),Ua(n.Qt,t)):null}))},t.prototype.yi=function(t,e){var n=this;return this.Ii[e]?Yu.resolve(this.Ii[e]):this.Pi(t,e).next((function(t){if(t){var r=t.keys();return n.Ii[e]=r,r}return null}))},t.prototype.gi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return oc(t).hs({index:da.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(fi(e.batchId>=r),o=Ua(n.Qt,e)),i.done()})).next((function(){return o}))},t.prototype.Vi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return oc(t).hs({index:da.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.pi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return oc(t).rs(da.userMutationsIndex,n).next((function(t){return t.map((function(t){return Ua(e.Qt,t)}))}))},t.prototype.bi=function(t,e){var n=this,r=va.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return sc(t).hs({range:i},(function(r,i,s){var u=r[0],a=r[1],c=r[2],h=ha(a);if(u===n.userId&&e.path.isEqual(h))return oc(t).get(c).next((function(t){if(!t)throw hi();fi(t.userId===n.userId),o.push(Ua(n.Qt,t))}));s.done()})).next((function(){return o}))},t.prototype.vi=function(t,e){var n=this,r=new zs(vi),i=[];return e.forEach((function(e){var o=va.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=sc(t).hs({range:s},(function(t,i,o){var s=t[0],u=t[1],a=t[2],c=ha(u);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(u)})),Yu.Mn(i).next((function(){return n.Si(t,r)}))},t.prototype.Di=function(t,e){var n=this,r=e.path,i=r.length+1,o=va.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new zs(vi);return sc(t).hs({range:s},(function(t,e,o){var s=t[0],a=t[1],c=t[2],h=ha(a);s===n.userId&&r.nt(h)?h.length===i&&(u=u.add(c)):o.done()})).next((function(){return n.Si(t,u)}))},t.prototype.Si=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(oc(t).get(e).next((function(t){if(null===t)throw hi();fi(t.userId===n.userId),r.push(Ua(n.Qt,t))})))})),Yu.Mn(i).next((function(){return r}))},t.prototype.Ci=function(t,e){var n=this;return ec(t.ps,this.userId,e).next((function(r){return t.gs((function(){n.xi(e.batchId)})),Yu.forEach(r,(function(e){return n.Ti.Ni(t,e)}))}))},t.prototype.xi=function(t){delete this.Ii[t]},t.prototype.$i=function(t){var e=this;return this.Ai(t).next((function(n){if(!n)return Yu.resolve();var r=IDBKeyRange.lowerBound(va.prefixForUser(e.userId)),i=[];return sc(t).hs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=ha(t[1]);i.push(o)}else r.done()})).next((function(){fi(0===i.length)}))}))},t.prototype.Fi=function(t,e){return ic(t,this.userId,e)},t.prototype.Oi=function(t){var e=this;return uc(t).get(this.userId).next((function(t){return t||new pa(e.userId,-1,"")}))},t}();function ic(t,e,n){var r=va.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return sc(t).hs({range:o,us:!0},(function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()})).next((function(){return s}))}function oc(t){return xa(t,da.store)}function sc(t){return xa(t,va.store)}function uc(t){return xa(t,pa.store)}var ac=function(){function t(t){this.ki=t}return t.prototype.next=function(){return this.ki+=2,this.ki},t.Mi=function(){return new t(0)},t.Li=function(){return new t(-1)},t}(),cc=function(){function t(t,e){this.Ti=t,this.Qt=e}return t.prototype.Bi=function(t){var e=this;return this.qi(t).next((function(n){var r=new ac(n.highestTargetId);return n.highestTargetId=r.next(),e.Ui(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Qi=function(t){return this.qi(t).next((function(t){return Oi.K(new xi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Ki=function(t){return this.qi(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Wi=function(t,e,n){var r=this;return this.qi(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.j()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ui(t,i)}))},t.prototype.ji=function(t,e){var n=this;return this.Gi(t,e).next((function(){return n.qi(t).next((function(r){return r.targetCount+=1,n.zi(e,r),n.Ui(t,r)}))}))},t.prototype.Hi=function(t,e){return this.Gi(t,e)},t.prototype.Ji=function(t,e){var n=this;return this.Yi(t,e.targetId).next((function(){return hc(t).delete(e.targetId)})).next((function(){return n.qi(t)})).next((function(e){return fi(e.targetCount>0),e.targetCount-=1,n.Ui(t,e)}))},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return hc(t).hs((function(s,u){var a=Fa(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Ji(t,a)))})).next((function(){return Yu.Mn(o)})).next((function(){return i}))},t.prototype.In=function(t,e){return hc(t).hs((function(t,n){var r=Fa(n);e(r)}))},t.prototype.qi=function(t){return fc(t).get(Ea.key).next((function(t){return fi(null!==t),t}))},t.prototype.Ui=function(t,e){return fc(t).put(Ea.key,e)},t.prototype.Gi=function(t,e){return hc(t).put(qa(this.Qt,e))},t.prototype.zi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Zi=function(t){return this.qi(t).next((function(t){return t.targetCount}))},t.prototype.tr=function(t,e){var n=bo(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return hc(t).hs({range:r,index:wa.queryTargetsIndexName},(function(t,n,r){var o=Fa(n);wo(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.er=function(t,e,n){var r=this,i=[],o=lc(t);return e.forEach((function(e){var s=ua(e.path);i.push(o.put(new _a(n,s))),i.push(r.Ti.nr(t,n,e))})),Yu.Mn(i)},t.prototype.sr=function(t,e,n){var r=this,i=lc(t);return Yu.forEach(e,(function(e){var o=ua(e.path);return Yu.Mn([i.delete([n,o]),r.Ti.ir(t,n,e)])}))},t.prototype.Yi=function(t,e){var n=lc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.rr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=lc(t),i=Zs();return r.hs({range:n,us:!0},(function(t,e,n){var r=ha(t[1]),o=new Ri(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Fi=function(t,e){var n=ua(e.path),r=IDBKeyRange.bound([n],[gi(n)],!1,!0),i=0;return lc(t).hs({index:_a.documentTargetsIndex,us:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Sn=function(t,e){return hc(t).get(e).next((function(t){return t?Fa(t):null}))},t}();function hc(t){return xa(t,wa.store)}function fc(t){return xa(t,Ea.store)}function lc(t){return xa(t,_a.store)}function pc(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=vi(n,i);return 0===s?vi(r,o):s}var dc=function(){function t(t){this.cr=t,this.buffer=new zs(pc),this.ar=0}return t.prototype.ur=function(){return++this.ar},t.prototype.hr=function(t){var e=[t,this.ur()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();pc(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),vc=function(){function t(t,e){this.lr=t,this._s=e,this._r=!1,this.dr=null}return t.prototype.start=function(t){-1!==this.lr.params.zs&&this.wr(t)},t.prototype.stop=function(){this.dr&&(this.dr.cancel(),this.dr=null)},Object.defineProperty(t.prototype,"Er",{get:function(){return null!==this.dr},enumerable:!1,configurable:!0}),t.prototype.wr=function(t){var e=this,n=this._r?3e5:6e4;si("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.dr=this._s.Tr("lru_garbage_collection",n,(function(){return i(e,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:this.dr=null,this._r=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Ir(this.lr)];case 2:return n.sent(),[3,7];case 3:return Zu(e=n.sent())?(si("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Za(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.wr(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),yc=function(){function t(t,e){this.mr=t,this.params=e}return t.prototype.Ar=function(t,e){return this.mr.Rr(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Pr=function(t,e){var n=this;if(0===e)return Yu.resolve(Di.q);var r=new dc(e);return this.mr.In(t,(function(t){return r.hr(t.sequenceNumber)})).next((function(){return n.mr.yr(t,(function(t){return r.hr(t)}))})).next((function(){return r.maxValue}))},t.prototype.Xi=function(t,e,n){return this.mr.Xi(t,e,n)},t.prototype.gr=function(t,e){return this.mr.gr(t,e)},t.prototype.Vr=function(t,e){var n=this;return-1===this.params.zs?(si("LruGarbageCollector","Garbage collection skipped; disabled"),Yu.resolve(Wa)):this.pr(t).next((function(r){return r<n.params.zs?(si("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.zs),Wa):n.br(t,e)}))},t.prototype.pr=function(t){return this.mr.pr(t)},t.prototype.br=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.Ar(t,this.params.Hs).next((function(e){return e>c.params.Js?(si("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Js+" from "+e),r=c.params.Js):r=e,o=Date.now(),c.Pr(t,r)})).next((function(r){return n=r,s=Date.now(),c.Xi(t,n,e)})).next((function(e){return i=e,u=Date.now(),c.gr(t,n)})).next((function(t){return a=Date.now(),oi()<=S.DEBUG&&si("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),Yu.resolve({Ks:!0,Ws:r,js:i,Gs:t})}))},t}(),gc=function(){function t(t,e){this.db=t,this.lr=function(t,e){return new yc(t,e)}(this,e)}return t.prototype.Rr=function(t){var e=this.vr(t);return this.db.Sr().Zi(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.vr=function(t){var e=0;return this.yr(t,(function(t){e++})).next((function(){return e}))},t.prototype.In=function(t,e){return this.db.Sr().In(t,e)},t.prototype.yr=function(t,e){return this.Dr(t,(function(t,n){return e(n)}))},t.prototype.nr=function(t,e,n){return mc(t,n)},t.prototype.ir=function(t,e,n){return mc(t,n)},t.prototype.Xi=function(t,e,n){return this.db.Sr().Xi(t,e,n)},t.prototype.Ni=function(t,e){return mc(t,e)},t.prototype.Cr=function(t,e){return function(t,e){var n=!1;return uc(t).ls((function(r){return ic(t,r,e).next((function(t){return t&&(n=!0),Yu.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.gr=function(t,e){var n=this,r=this.db.$r().Nr(),i=[],o=0;return this.Dr(t,(function(s,u){if(u<=e){var a=n.Cr(t,s).next((function(e){if(!e)return o++,r._i(t,s).next((function(){return r.li(s),lc(t).delete([0,ua(s.path)])}))}));i.push(a)}})).next((function(){return Yu.Mn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.kt(t.bs);return this.db.Sr().Hi(t,n)},t.prototype.Fr=function(t,e){return mc(t,e)},t.prototype.Dr=function(t,e){var n,r=lc(t),i=Di.q;return r.hs({index:_a.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==Di.q&&e(new Ri(ha(n)),i),i=u,n=s):i=Di.q})).next((function(){i!==Di.q&&e(new Ri(ha(n)),i)}))},t.prototype.pr=function(t){return this.db.$r().Or(t)},t}();function mc(t,e){return lc(t).put(function(t,e){return new _a(0,ua(t.path),e)}(e,t.bs))}var bc=function(){function t(t,e){this.Qt=t,this.Ei=e}return t.prototype.ai=function(t,e,n){return Ec(t).put(Ic(e),n)},t.prototype.li=function(t,e){var n=Ec(t),r=Ic(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.kr(t,r)}))},t.prototype._i=function(t,e){var n=this;return Ec(t).get(Ic(e)).next((function(t){return n.Mr(t)}))},t.prototype.Lr=function(t,e){var n=this;return Ec(t).get(Ic(e)).next((function(t){var e=n.Mr(t);return e?{hi:e,size:nc(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Qs();return this.Br(t,e,(function(t,e){var i=n.Mr(e);r=r.zt(t,i)})).next((function(){return r}))},t.prototype.qr=function(t,e){var n=this,r=Qs(),i=new Us(Ri.H);return this.Br(t,e,(function(t,e){var o=n.Mr(e);o?(r=r.zt(t,o),i=i.zt(t,nc(e))):(r=r.zt(t,null),i=i.zt(t,0))})).next((function(){return{Ur:r,Qr:i}}))},t.prototype.Br=function(t,e,n){if(e.et())return Yu.resolve();var r=IDBKeyRange.bound(e.first().path.it(),e.last().path.it()),i=e.te(),o=i.oe();return Ec(t).hs({range:r},(function(t,e,r){for(var s=Ri.Et(t);o&&Ri.H(o,s)<0;)n(o,null),o=i.oe();o&&o.isEqual(s)&&(n(o,e),o=i.ce()?i.oe():null),o?r.ss(o.path.it()):r.done()})).next((function(){for(;o;)n(o,null),o=i.ce()?i.oe():null}))},t.prototype.Kr=function(t,e,n){var r=this,i=Ks(),o=e.path.length+1,s={};if(n.isEqual(Oi.min())){var u=e.path.it();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.it(),c=Ra(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=ma.collectionReadTimeIndex}return Ec(t).hs(s,(function(t,n,s){if(t.length===o){var u=Ca(r.Qt,n);e.path.nt(u.key.path)?u instanceof po&&Jo(e,u)&&(i=i.zt(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.Nr=function(t){return new wc(this,!!t&&t.Wr)},t.prototype.Or=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return _c(t).get(ba.key).next((function(t){return fi(!!t),t}))},t.prototype.kr=function(t,e){return _c(t).put(ba.key,e)},t.prototype.Mr=function(t){if(t){var e=Ca(this.Qt,t);return e instanceof vo&&e.version.isEqual(Oi.min())?null:e}return null},t}(),wc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jr=e,r.Wr=n,r.Gr=new $a((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return n(e,t),e.prototype.wi=function(t){var e=this,n=[],r=0,i=new zs((function(t,e){return vi(t.rt(),e.rt())}));return this.ri.forEach((function(o,s){var u=e.Gr.get(o);if(s.hi){var a=La(e.jr.Qt,s.hi,e.ci(o));i=i.add(o.path.X());var c=nc(a);r+=c-u,n.push(e.jr.ai(t,o,a))}else if(r-=u,e.Wr){var h=La(e.jr.Qt,new vo(o,Oi.min()),e.ci(o));n.push(e.jr.ai(t,o,h))}else n.push(e.jr.li(t,o))})),i.forEach((function(r){n.push(e.jr.Ei.qs(t,r))})),n.push(this.jr.updateMetadata(t,r)),Yu.Mn(n)},e.prototype.fi=function(t,e){var n=this;return this.jr.Lr(t,e).next((function(t){return null===t?(n.Gr.set(e,0),null):(n.Gr.set(e,t.size),t.hi)}))},e.prototype.di=function(t,e){var n=this;return this.jr.qr(t,e).next((function(t){var e=t.Ur;return t.Qr.forEach((function(t,e){n.Gr.set(t,e)})),e}))},e}(tc);function _c(t){return xa(t,ba.store)}function Ec(t){return xa(t,ma.store)}function Ic(t){return t.path.it()}var Tc=function(){function t(t){this.Qt=t}return t.prototype.Jn=function(t,e,n,r){var i=this;fi(n<r&&n>=0&&r<=11);var o=new Ku("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(la.store)}(t),function(t){t.createObjectStore(pa.store,{keyPath:pa.keyPath}),t.createObjectStore(da.store,{keyPath:da.keyPath,autoIncrement:!0}).createIndex(da.userMutationsIndex,da.userMutationsKeyPath,{unique:!0}),t.createObjectStore(va.store)}(t),Nc(t),function(t){t.createObjectStore(ma.store)}(t));var s=Yu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(_a.store),t.deleteObjectStore(wa.store),t.deleteObjectStore(Ea.store)}(t),Nc(t)),s=s.next((function(){return function(t){var e=t.store(Ea.store),n=new Ea(0,0,Oi.min().j(),0);return e.put(Ea.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(da.store).rs().next((function(n){t.deleteObjectStore(da.store),t.createObjectStore(da.store,{keyPath:da.keyPath,autoIncrement:!0}).createIndex(da.userMutationsIndex,da.userMutationsKeyPath,{unique:!0});var r=e.store(da.store),i=n.map((function(t){return r.put(t)}));return Yu.Mn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Ta.store,{keyPath:Ta.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.zr(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(ba.store)}(t),i.Hr(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.Jr(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Yr(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ma.store);e.createIndex(ma.readTimeIndex,ma.readTimeIndexPath,{unique:!1}),e.createIndex(ma.collectionReadTimeIndex,ma.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Xr(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Na.store,{keyPath:Na.keyPath})}(t),function(t){t.createObjectStore(Aa.store,{keyPath:Aa.keyPath})}(t)}))),s},t.prototype.Hr=function(t){var e=0;return t.store(ma.store).hs((function(t,n){e+=nc(n)})).next((function(){var n=new ba(e);return t.store(ba.store).put(ba.key,n)}))},t.prototype.zr=function(t){var e=this,n=t.store(pa.store),r=t.store(da.store);return n.rs().next((function(n){return Yu.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.rs(da.userMutationsIndex,i).next((function(r){return Yu.forEach(r,(function(r){fi(r.userId===n.userId);var i=Ua(e.Qt,r);return ec(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.Jr=function(t){var e=t.store(_a.store),n=t.store(ma.store);return t.store(Ea.store).get(Ea.key).next((function(t){var r=[];return n.hs((function(n,i){var o=new Pi(n),s=function(t){return[0,ua(t)]}(o);r.push(e.get(s).next((function(n){return n?Yu.resolve():function(n){return e.put(new _a(0,ua(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Yu.Mn(r)}))}))},t.prototype.Yr=function(t,e){t.createObjectStore(Ia.store,{keyPath:Ia.keyPath});var n=e.store(Ia.store),r=new Ya,i=function(t){if(r.add(t)){var e=t.tt(),i=t.X();return n.put({collectionId:e,parent:ua(i)})}};return e.store(ma.store).hs({us:!0},(function(t,e){var n=new Pi(t);return i(n.X())})).next((function(){return e.store(va.store).hs({us:!0},(function(t,e){t[0];var n=t[1],r=(t[2],ha(n));return i(r.X())}))}))},t.prototype.Xr=function(t){var e=this,n=t.store(wa.store);return n.hs((function(t,r){var i=Fa(r),o=qa(e.Qt,i);return n.put(o)}))},t}();function Nc(t){t.createObjectStore(_a.store,{keyPath:_a.keyPath}).createIndex(_a.documentTargetsIndex,_a.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(wa.store,{keyPath:wa.keyPath}).createIndex(wa.queryTargetsIndexName,wa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ea.store)}var Ac="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Sc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Zr=o,this.window=s,this.document=u,this.eo=c,this.no=h,this.so=null,this.io=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ro=null,this.inForeground=!1,this.oo=null,this.co=null,this.ao=Number.NEGATIVE_INFINITY,this.uo=function(t){return Promise.resolve()},!t.Kn())throw new wi(bi.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ti=new gc(this,i),this.ho=n+"main",this.Qt=new Pa(a),this.lo=new Xu(this.ho,11,new Tc(this.Qt)),this._o=new cc(this.Ti,this.Qt),this.Ei=new Ka,this.fo=function(t,e){return new bc(t,e)}(this.Qt,this.Ei),this.wo=new Ba,this.window&&this.window.localStorage?this.Eo=this.window.localStorage:(this.Eo=null,!1===h&&ui("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.To().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new wi(bi.FAILED_PRECONDITION,Ac);return t.Io(),t.mo(),t.Ao(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t._o.Ki(e)}))})).then((function(e){t.so=new Di(e,t.eo)})).then((function(){t.io=!0})).catch((function(e){return t.lo&&t.lo.close(),Promise.reject(e)}))},t.prototype.Ro=function(t){var e=this;return this.uo=function(n){return i(e,void 0,void 0,(function(){return o(this,(function(e){return this.Er?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Po=function(t){var e=this;this.lo.Xn((function(n){return i(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.yo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Zr.Ps((function(){return i(e,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this.Er?[4,this.To()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.To=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return xc(e).put(new Ta(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Vo(e).next((function(e){e||(t.isPrimary=!1,t.Zr.po((function(){return t.uo(!1)})))}))})).next((function(){return t.bo(e)})).next((function(n){return t.isPrimary&&!n?t.vo(e).next((function(){return!1})):!!n&&t.So(e).next((function(){return!0}))}))})).catch((function(e){if(Zu(e))return si("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return si("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Zr.po((function(){return t.uo(e)})),t.isPrimary=e}))},t.prototype.Vo=function(t){var e=this;return Dc(t).get(la.key).next((function(t){return Yu.resolve(e.Do(t))}))},t.prototype.Co=function(t){return xc(t).delete(this.clientId)},t.prototype.xo=function(){return i(this,void 0,void 0,(function(){var t,e,n,r,i=this;return o(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.No(this.ao,18e5)?[3,2]:(this.ao=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=xa(t,Ta.store);return e.rs().next((function(t){var n=i.$o(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Yu.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Eo)for(e=0,n=t;e<n.length;e++)r=n[e],this.Eo.removeItem(this.Fo(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.Ao=function(){var t=this;this.co=this.Zr.Tr("client_metadata_refresh",4e3,(function(){return t.To().then((function(){return t.xo()})).then((function(){return t.Ao()}))}))},t.prototype.Do=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.bo=function(t){var e=this;return this.no?Yu.resolve(!0):Dc(t).get(la.key).next((function(n){if(null!==n&&e.No(n.leaseTimestampMs,5e3)&&!e.Oo(n.ownerId)){if(e.Do(n)&&e.networkEnabled)return!0;if(!e.Do(n)){if(!n.allowTabSynchronization)throw new wi(bi.FAILED_PRECONDITION,Ac);return!1}}return!(!e.networkEnabled||!e.inForeground)||xc(t).rs().next((function(t){return void 0===e.$o(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&si("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.ko=function(){return i(this,void 0,void 0,(function(){var t=this;return o(this,(function(e){switch(e.label){case 0:return this.io=!1,this.Mo(),this.co&&(this.co.cancel(),this.co=null),this.Lo(),this.Bo(),[4,this.lo.runTransaction("shutdown","readwrite",[la.store,Ta.store],(function(e){var n=new Da(e,Di.q);return t.vo(n).next((function(){return t.Co(n)}))}))];case 1:return e.sent(),this.lo.close(),this.qo(),[2]}}))}))},t.prototype.$o=function(t,e){var n=this;return t.filter((function(t){return n.No(t.updateTimeMs,e)&&!n.Oo(t.clientId)}))},t.prototype.Uo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return xc(e).rs().next((function(e){return t.$o(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Qo=function(t){return rc.mi(t,this.Qt,this.Ei,this.Ti)},t.prototype.Sr=function(){return this._o},t.prototype.$r=function(){return this.fo},t.prototype.Ko=function(){return this.Ei},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r=this;si("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.lo.runTransaction(t,o,Sa,(function(o){return i=new Da(o,r.so?r.so.next():Di.q),"readwrite-primary"===e?r.Vo(i).next((function(t){return!!t||r.bo(i)})).next((function(e){if(!e)throw ui("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Zr.po((function(){return r.uo(!1)})),new wi(bi.FAILED_PRECONDITION,oa);return n(i)})).next((function(t){return r.So(i).next((function(){return t}))})):r.jo(i).next((function(){return n(i)}))})).then((function(t){return i.Vs(),t}))},t.prototype.jo=function(t){var e=this;return Dc(t).get(la.key).next((function(t){if(null!==t&&e.No(t.leaseTimestampMs,5e3)&&!e.Oo(t.ownerId)&&!e.Do(t)&&!(e.no||e.allowTabSynchronization&&t.allowTabSynchronization))throw new wi(bi.FAILED_PRECONDITION,Ac)}))},t.prototype.So=function(t){var e=new la(this.clientId,this.allowTabSynchronization,Date.now());return Dc(t).put(la.key,e)},t.Kn=function(){return Xu.Kn()},t.prototype.vo=function(t){var e=this,n=Dc(t);return n.get(la.key).next((function(t){return e.Do(t)?(si("IndexedDbPersistence","Releasing primary lease."),n.delete(la.key)):Yu.resolve()}))},t.prototype.No=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(ui("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Io=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.oo=function(){t.Zr.Ps((function(){return t.inForeground="visible"===t.document.visibilityState,t.To()}))},this.document.addEventListener("visibilitychange",this.oo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Lo=function(){this.oo&&(this.document.removeEventListener("visibilitychange",this.oo),this.oo=null)},t.prototype.mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ro=function(){e.Mo(),e.Zr.Ps((function(){return e.ko()}))},this.window.addEventListener("unload",this.ro))},t.prototype.Bo=function(){this.ro&&(this.window.removeEventListener("unload",this.ro),this.ro=null)},t.prototype.Oo=function(t){var e;try{var n=null!==(null===(e=this.Eo)||void 0===e?void 0:e.getItem(this.Fo(t)));return si("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return ui("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.Mo=function(){if(this.Eo)try{this.Eo.setItem(this.Fo(this.clientId),String(Date.now()))}catch(t){ui("Failed to set zombie client id.",t)}},t.prototype.qo=function(){if(this.Eo)try{this.Eo.removeItem(this.Fo(this.clientId))}catch(t){}},t.prototype.Fo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Dc(t){return xa(t,la.store)}function xc(t){return xa(t,Ta.store)}function Oc(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var kc=function(t,e){this.progress=t,this.Go=e},Pc=function(){function t(t,e,n){this.fo=t,this.zo=e,this.Ei=n}return t.prototype.Ho=function(t,e){var n=this;return this.zo.bi(t,e).next((function(r){return n.Jo(t,e,r)}))},t.prototype.Jo=function(t,e,n){return this.fo._i(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Cs(e,t);return t}))},t.prototype.Yo=function(t,e,n){var r=Qs();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Cs(t,e);r=r.zt(t,e)})),r},t.prototype.Xo=function(t,e){var n=this;return this.fo.getEntries(t,e).next((function(e){return n.Zo(t,e)}))},t.prototype.Zo=function(t,e){var n=this;return this.zo.vi(t,e).next((function(r){var i=n.Yo(t,e,r),o=Hs();return i.forEach((function(t,e){e||(e=new vo(t,Oi.min())),o=o.zt(t,e)})),o}))},t.prototype.Kr=function(t,e,n){return function(t){return Ri.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.tc(t,e.path):Go(e)?this.ec(t,e,n):this.nc(t,e,n)},t.prototype.tc=function(t,e){return this.Ho(t,new Ri(e)).next((function(t){var e=Ks();return t instanceof po&&(e=e.zt(t.key,t)),e}))},t.prototype.ec=function(t,e,n){var r=this,i=e.collectionGroup,o=Ks();return this.Ei.Us(t,i).next((function(s){return Yu.forEach(s,(function(s){var u=function(t,e){return new Mo(e,null,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.nc(t,u,n).next((function(t){t.forEach((function(t,e){o=o.zt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.nc=function(t,e,n){var r,i,o=this;return this.fo.Kr(t,e,n).next((function(n){return r=n,o.zo.Di(t,e)})).next((function(e){return i=e,o.sc(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=Es(a,r.get(c),o.vs);r=h instanceof po?r.zt(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){Jo(e,n)||(r=r.remove(t))})),r}))},t.prototype.sc=function(t,e,n){for(var r=Zs(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ss&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.fo.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof po&&(c=c.zt(t,e))})),c}))},t}(),Cc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.ic=n,this.rc=r}return t.oc=function(e,n){for(var r=Zs(),i=Zs(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Lc=function(){function t(){}return t.prototype.cc=function(t){this.ac=t},t.prototype.Kr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.xt.length||1===t.xt.length&&t.xt[0].field.ut())}(e)||n.isEqual(Oi.min())?this.uc(t,e):this.ac.Xo(t,r).next((function(o){var s=i.hc(e,o);return(Fo(e)||qo(e))&&i.lc(e.limitType,s,r,n)?i.uc(t,e):(oi()<=S.DEBUG&&si("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Wo(e)),i.ac.Kr(t,e,n).next((function(t){return s.forEach((function(e){t=t.zt(e.key,e)})),t})))}))},t.prototype.hc=function(t,e){var n=new zs(Zo(t));return e.forEach((function(e,r){r instanceof po&&Jo(t,r)&&(n=n.add(r))})),n},t.prototype.lc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version._(r)>0)},t.prototype.uc=function(t,e){return oi()<=S.DEBUG&&si("QueryEngine","Using full collection scan to execute query:",Wo(e)),this.ac.Kr(t,e,Oi.min())},t}(),Rc=function(){function t(t,e,n,r){this.persistence=t,this._c=e,this.Qt=r,this.fc=new Us(vi),this.dc=new $a((function(t){return bo(t)}),wo),this.wc=Oi.min(),this.zo=t.Qo(n),this.Ec=t.$r(),this._o=t.Sr(),this.Tc=new Pc(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}return t.prototype.Ir=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Vr(n,e.fc)}))},t}();function Vc(t,e,n,r){return new Rc(t,e,n,r)}function Mc(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s;return o(this,(function(o){switch(o.label){case 0:return n=li(t),r=n.zo,i=n.Tc,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.zo.pi(t).next((function(s){return o=s,r=n.persistence.Qo(e),i=new Pc(n.Ec,r,n.persistence.Ko()),r.pi(t)})).next((function(e){for(var n=[],r=[],s=Zs(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++){var m=g[y];s=s.add(m.key)}}return i.Xo(t,s).next((function(t){return{Ic:t,mc:n,Ac:r}}))}))}))];case 1:return s=o.sent(),[2,(n.zo=r,n.Tc=i,n._c.cc(n.Tc),s)]}}))}))}function jc(t,e){var n=li(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Ec.Nr({Wr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Yu.resolve();return o.forEach((function(t){s=s.next((function(){return r._i(e,t)})).next((function(e){var o=e,s=n.$s.get(t);fi(null!==s),(!o||o.version._(s)<0)&&(o=i.Ss(t,o,n))&&r.ai(o,n.Ns)}))})),s.next((function(){return t.zo.Ci(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.zo.$i(t)})).next((function(){return n.Tc.Xo(t,r)}))}))}function Uc(t){var e=li(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e._o.Qi(t)}))}function Fc(t,e){var n=li(t),r=e.Ot,i=n.fc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Ec.Nr({Wr:!0});i=n.fc;var s=[];e.$e.forEach((function(e,o){var u=i.get(o);if(u){s.push(n._o.sr(t,e.Qe,o).next((function(){return n._o.er(t,e.qe,o)})));var a=e.resumeToken;if(a.l()>0){var c=u.Mt(a,r).kt(t.bs);i=i.zt(o,c),function(t,e,n){return fi(e.resumeToken.l()>0),0===t.resumeToken.l()||e.Ot.W()-t.Ot.W()>=3e8||n.qe.size+n.Ue.size+n.Qe.size>0}(u,c,e)&&s.push(n._o.Hi(t,c))}}}));var u=Hs();if(e.Oe.forEach((function(r,i){e.ke.has(r)&&s.push(n.persistence.Ti.Fr(t,r))})),s.push(qc(t,o,e.Oe,r,void 0).next((function(t){u=t}))),!r.isEqual(Oi.min())){var a=n._o.Qi(t).next((function(e){return n._o.Wi(t,t.bs,r)}));s.push(a)}return Yu.Mn(s).next((function(){return o.apply(t)})).next((function(){return n.Tc.Zo(t,u)}))})).then((function(t){return n.fc=i,t}))}function qc(t,e,n,r,i){var o=Zs();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Hs();return n.forEach((function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof vo&&s.version.isEqual(Oi.min())?(e.li(n,a),o=o.zt(n,s)):null==u||s.version._(u.version)>0||0===s.version._(u.version)&&u.hasPendingWrites?(e.ai(s,a),o=o.zt(n,s)):si("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)})),o}))}function zc(t,e){var n=li(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.zo.gi(t,e)}))}function Bc(t,e){var n=li(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n._o.tr(t,e).next((function(i){return i?(r=i,Yu.resolve(r)):n._o.Bi(t).next((function(i){return r=new ts(e,i,0,t.bs),n._o.ji(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.fc.get(t.targetId);return(null===r||t.Ot._(r.Ot)>0)&&(n.fc=n.fc.zt(t.targetId,t),n.dc.set(e,t.targetId)),t}))}function Gc(t,e,n){return i(this,void 0,void 0,(function(){var r,i,s,u;return o(this,(function(o){switch(o.label){case 0:r=li(t),i=r.fc.get(e),s=n?"readwrite":"readwrite-primary",o.label=1;case 1:return o.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",s,(function(t){return r.persistence.Ti.removeTarget(t,i)}))];case 2:o.sent(),o.label=3;case 3:return[3,5];case 4:if(!Zu(u=o.sent()))throw u;return si("LocalStore","Failed to update sequence numbers for target "+e+": "+u),[3,5];case 5:return r.fc=r.fc.remove(e),r.dc.delete(i.target),[2]}}))}))}function Hc(t,e,n){var r=li(t),i=Oi.min(),o=Zs();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=li(t),i=r.dc.get(n);return void 0!==i?Yu.resolve(r.fc.get(i)):r._o.tr(e,n)}(r,t,Qo(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r._o.rr(t,e.targetId).next((function(t){o=t}))})).next((function(){return r._c.Kr(t,e,n?i:Oi.min(),n?o:Zs())})).next((function(t){return{documents:t,Rc:o}}))}))}function Qc(t,e){var n=li(t),r=li(n._o),i=n.fc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Sn(t,e).next((function(t){return t?t.target:null}))}))}function Yc(t){var e=li(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=li(t),i=Hs(),o=Ra(n),s=Ec(e),u=IDBKeyRange.lowerBound(o,!0);return s.hs({index:ma.readTimeIndex,range:u},(function(t,e){var n=Ca(r.Qt,e);i=i.zt(n.key,n),o=e.readTime})).next((function(){return{Go:i,readTime:Va(o)}}))}(e.Ec,t,e.wc)})).then((function(t){var n=t.Go,r=t.readTime;return e.wc=r,n}))}function Kc(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){return[2,(e=li(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Ec(t),n=Oi.min();return e.hs({index:ma.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Va(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.wc=t}))]}))}))}function Xc(t,e,n,r){return i(this,void 0,void 0,(function(){var i,s,u,a,c,h,f,l,p,d;return o(this,(function(o){switch(o.label){case 0:for(i=li(t),s=Zs(),u=Hs(),a=Ws(),c=0,h=n;c<h.length;c++)f=h[c],l=e.Pc(f.metadata.name),f.document&&(s=s.add(l)),u=u.zt(l,e.yc(f)),a=a.zt(l,e.gc(f.metadata.readTime));return p=i.Ec.Nr({Wr:!0}),[4,Bc(i,function(t){return Qo(Uo(Pi.ot("__bundle__/docs/"+t)))}(r))];case 1:return d=o.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return qc(t,p,u,Oi.min(),a).next((function(e){return p.apply(t),e})).next((function(e){return i._o.Yi(t,d.targetId).next((function(){return i._o.er(t,s,d.targetId)})).next((function(){return i.Tc.Zo(t,e)}))}))}))]}}))}))}function Wc(t,e,n){return void 0===n&&(n=Zs()),i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:return[4,Bc(t,Qo(za(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=li(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=bu(e.readTime);if(r.Ot._(o)>=0)return i.wo.Ls(t,e);var s=r.Mt(mi.T,o);return i.fc=i.fc.zt(s.targetId,s),i._o.Hi(t,s).next((function(){return i._o.Yi(t,r.targetId)})).next((function(){return i._o.er(t,n,r.targetId)})).next((function(){return i.wo.Ls(t,e)}))}))]}}))}))}var Jc=function(){function t(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}return t.prototype.Os=function(t,e){return Yu.resolve(this.Vc.get(e))},t.prototype.ks=function(t,e){var n;return this.Vc.set(e.id,{id:(n=e).id,version:n.version,createTime:bu(n.createTime)}),Yu.resolve()},t.prototype.Ms=function(t,e){return Yu.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){return this.bc.set(e.name,function(t){return{name:t.name,query:za(t.bundledQuery),readTime:bu(t.readTime)}}(e)),Yu.resolve()},t}(),Zc=function(){function t(){this.vc=new zs($c.Sc),this.Dc=new zs($c.Cc)}return t.prototype.et=function(){return this.vc.et()},t.prototype.nr=function(t,e){var n=new $c(t,e);this.vc=this.vc.add(n),this.Dc=this.Dc.add(n)},t.prototype.xc=function(t,e){var n=this;t.forEach((function(t){return n.nr(t,e)}))},t.prototype.ir=function(t,e){this.Nc(new $c(t,e))},t.prototype.$c=function(t,e){var n=this;t.forEach((function(t){return n.ir(t,e)}))},t.prototype.Fc=function(t){var e=this,n=new Ri(new Pi([])),r=new $c(n,t),i=new $c(n,t+1),o=[];return this.Dc.me([r,i],(function(t){e.Nc(t),o.push(t.key)})),o},t.prototype.Oc=function(){var t=this;this.vc.forEach((function(e){return t.Nc(e)}))},t.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},t.prototype.kc=function(t){var e=new Ri(new Pi([])),n=new $c(e,t),r=new $c(e,t+1),i=Zs();return this.Dc.me([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Fi=function(t){var e=new $c(t,0),n=this.vc.Re(e);return null!==n&&t.isEqual(n.key)},t}(),$c=function(){function t(t,e){this.key=t,this.Mc=e}return t.Sc=function(t,e){return Ri.H(t.key,e.key)||vi(t.Mc,e.Mc)},t.Cc=function(t,e){return vi(t.Mc,e.Mc)||Ri.H(t.key,e.key)},t}(),th=function(){function t(t,e){this.Ei=t,this.Ti=e,this.zo=[],this.Lc=1,this.Bc=new zs($c.Sc)}return t.prototype.Ai=function(t){return Yu.resolve(0===this.zo.length)},t.prototype.Ri=function(t,e,n,r){var i=this.Lc;this.Lc++,this.zo.length>0&&this.zo[this.zo.length-1];var o=new Oa(i,e,n,r);this.zo.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Bc=this.Bc.add(new $c(a.key,i)),this.Ei.qs(t,a.key.path.X())}return Yu.resolve(o)},t.prototype.Pi=function(t,e){return Yu.resolve(this.qc(e))},t.prototype.gi=function(t,e){var n=e+1,r=this.Uc(n),i=r<0?0:r;return Yu.resolve(this.zo.length>i?this.zo[i]:null)},t.prototype.Vi=function(){return Yu.resolve(0===this.zo.length?-1:this.Lc-1)},t.prototype.pi=function(t){return Yu.resolve(this.zo.slice())},t.prototype.bi=function(t,e){var n=this,r=new $c(e,0),i=new $c(e,Number.POSITIVE_INFINITY),o=[];return this.Bc.me([r,i],(function(t){var e=n.qc(t.Mc);o.push(e)})),Yu.resolve(o)},t.prototype.vi=function(t,e){var n=this,r=new zs(vi);return e.forEach((function(t){var e=new $c(t,0),i=new $c(t,Number.POSITIVE_INFINITY);n.Bc.me([e,i],(function(t){r=r.add(t.Mc)}))})),Yu.resolve(this.Qc(r))},t.prototype.Di=function(t,e){var n=e.path,r=n.length+1,i=n;Ri.wt(i)||(i=i.child(""));var o=new $c(new Ri(i),0),s=new zs(vi);return this.Bc.Ae((function(t){var e=t.key.path;return!!n.nt(e)&&(e.length===r&&(s=s.add(t.Mc)),!0)}),o),Yu.resolve(this.Qc(s))},t.prototype.Qc=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.qc(t);null!==r&&n.push(r)})),n},t.prototype.Ci=function(t,e){var n=this;fi(0===this.Kc(e.batchId,"removed")),this.zo.shift();var r=this.Bc;return Yu.forEach(e.mutations,(function(i){var o=new $c(i.key,e.batchId);return r=r.delete(o),n.Ti.Ni(t,i.key)})).next((function(){n.Bc=r}))},t.prototype.xi=function(t){},t.prototype.Fi=function(t,e){var n=new $c(e,0),r=this.Bc.Re(n);return Yu.resolve(e.isEqual(r&&r.key))},t.prototype.$i=function(t){return this.zo.length,Yu.resolve()},t.prototype.Kc=function(t,e){return this.Uc(t)},t.prototype.Uc=function(t){return 0===this.zo.length?0:t-this.zo[0].batchId},t.prototype.qc=function(t){var e=this.Uc(t);return e<0||e>=this.zo.length?null:this.zo[e]},t}(),eh=function(){function t(t,e){this.Ei=t,this.Wc=e,this.docs=new Us(Ri.H),this.size=0}return t.prototype.ai=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Wc(e);return this.docs=this.docs.zt(r,{hi:e,size:s,readTime:n}),this.size+=s-o,this.Ei.qs(t,r.path.X())},t.prototype.li=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype._i=function(t,e){var n=this.docs.get(e);return Yu.resolve(n?n.hi:null)},t.prototype.getEntries=function(t,e){var n=this,r=Qs();return e.forEach((function(t){var e=n.docs.get(t);r=r.zt(t,e?e.hi:null)})),Yu.resolve(r)},t.prototype.Kr=function(t,e,n){for(var r=Ks(),i=new Ri(e.path.child("")),o=this.docs.ee(i);o.ce();){var s=o.oe(),u=s.key,a=s.value,c=a.hi,h=a.readTime;if(!e.path.nt(u.path))break;h._(n)<=0||c instanceof po&&Jo(e,c)&&(r=r.zt(c.key,c))}return Yu.resolve(r)},t.prototype.jc=function(t,e){return Yu.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Nr=function(t){return new nh(this)},t.prototype.Or=function(t){return Yu.resolve(this.size)},t}(),nh=function(t){function e(e){var n=this;return(n=t.call(this)||this).jr=e,n}return n(e,t),e.prototype.wi=function(t){var e=this,n=[];return this.ri.forEach((function(r,i){i&&i.hi?n.push(e.jr.ai(t,i.hi,e.ci(r))):e.jr.li(r)})),Yu.Mn(n)},e.prototype.fi=function(t,e){return this.jr._i(t,e)},e.prototype.di=function(t,e){return this.jr.getEntries(t,e)},e}(tc),rh=function(){function t(t){this.persistence=t,this.Gc=new $a((function(t){return bo(t)}),wo),this.lastRemoteSnapshotVersion=Oi.min(),this.highestTargetId=0,this.zc=0,this.Hc=new Zc,this.targetCount=0,this.Jc=ac.Mi()}return t.prototype.In=function(t,e){return this.Gc.forEach((function(t,n){return e(n)})),Yu.resolve()},t.prototype.Qi=function(t){return Yu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Ki=function(t){return Yu.resolve(this.zc)},t.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),Yu.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zc&&(this.zc=e),Yu.resolve()},t.prototype.Gi=function(t){this.Gc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jc=new ac(e),this.highestTargetId=e),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},t.prototype.ji=function(t,e){return this.Gi(e),this.targetCount+=1,Yu.resolve()},t.prototype.Hi=function(t,e){return this.Gi(e),Yu.resolve()},t.prototype.Ji=function(t,e){return this.Gc.delete(e.target),this.Hc.Fc(e.targetId),this.targetCount-=1,Yu.resolve()},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return this.Gc.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.Gc.delete(s),o.push(r.Yi(t,u.targetId)),i++)})),Yu.Mn(o).next((function(){return i}))},t.prototype.Zi=function(t){return Yu.resolve(this.targetCount)},t.prototype.tr=function(t,e){var n=this.Gc.get(e)||null;return Yu.resolve(n)},t.prototype.er=function(t,e,n){return this.Hc.xc(e,n),Yu.resolve()},t.prototype.sr=function(t,e,n){this.Hc.$c(e,n);var r=this.persistence.Ti,i=[];return r&&e.forEach((function(e){i.push(r.Ni(t,e))})),Yu.Mn(i)},t.prototype.Yi=function(t,e){return this.Hc.Fc(e),Yu.resolve()},t.prototype.rr=function(t,e){var n=this.Hc.kc(e);return Yu.resolve(n)},t.prototype.Fi=function(t,e){return Yu.resolve(this.Hc.Fi(e))},t}(),ih=function(){function t(t,e){var n=this;this.Yc={},this.so=new Di(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new rh(this),this.Ei=new Qa,this.fo=function(t,e){return new eh(t,(function(t){return n.Ti.Xc(t)}))}(this.Ei),this.Qt=new Pa(e),this.wo=new Jc(this.Qt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.ko=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Po=function(){},t.prototype.yo=function(){},t.prototype.Ko=function(){return this.Ei},t.prototype.Qo=function(t){var e=this.Yc[t.A()];return e||(e=new th(this.Ei,this.Ti),this.Yc[t.A()]=e),e},t.prototype.Sr=function(){return this._o},t.prototype.$r=function(){return this.fo},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r=this;si("MemoryPersistence","Starting transaction:",t);var i=new oh(this.so.next());return this.Ti.Zc(),n(i).next((function(t){return r.Ti.ta(i).next((function(){return t}))})).On().then((function(t){return i.Vs(),t}))},t.prototype.ea=function(t,e){return Yu.Ln(Object.values(this.Yc).map((function(n){return function(){return n.Fi(t,e)}})))},t}(),oh=function(t){function e(e){var n=this;return(n=t.call(this)||this).bs=e,n}return n(e,t),e}(sa),sh=function(){function t(t){this.persistence=t,this.na=new Zc,this.sa=null}return t.ia=function(e){return new t(e)},Object.defineProperty(t.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw hi()},enumerable:!1,configurable:!0}),t.prototype.nr=function(t,e,n){return this.na.nr(n,e),this.ra.delete(n.toString()),Yu.resolve()},t.prototype.ir=function(t,e,n){return this.na.ir(n,e),this.ra.add(n.toString()),Yu.resolve()},t.prototype.Ni=function(t,e){return this.ra.add(e.toString()),Yu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.na.Fc(e.targetId).forEach((function(t){return n.ra.add(t.toString())}));var r=this.persistence.Sr();return r.rr(t,e.targetId).next((function(t){t.forEach((function(t){return n.ra.add(t.toString())}))})).next((function(){return r.Ji(t,e)}))},t.prototype.Zc=function(){this.sa=new Set},t.prototype.ta=function(t){var e=this,n=this.persistence.$r().Nr();return Yu.forEach(this.ra,(function(r){var i=Ri._t(r);return e.oa(t,i).next((function(t){t||n.li(i)}))})).next((function(){return e.sa=null,n.apply(t)}))},t.prototype.Fr=function(t,e){var n=this;return this.oa(t,e).next((function(t){t?n.ra.delete(e.toString()):n.ra.add(e.toString())}))},t.prototype.Xc=function(t){return 0},t.prototype.oa=function(t,e){var n=this;return Yu.Ln([function(){return Yu.resolve(n.na.Fi(e))},function(){return n.persistence.Sr().Fi(t,e)},function(){return n.persistence.ea(t,e)}])},t}();function uh(t,e){return"firestore_clients_"+t+"_"+e}function ah(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.m()&&(r+="_"+e.uid),r}function ch(t,e){return"firestore_targets_"+t+"_"+e}var hh=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ca=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new wi(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(ui("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),fh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ca=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new wi(i.error.code,i.error.message)),o?new t(e,i.state,r):(ui("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),lh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ca=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=tu(),s=0;i&&s<r.activeTargetIds.length;++s)i=Xi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(ui("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),ph=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ca=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(ui("SharedClientState","Failed to parse online state: "+e),null)},t}(),dh=function(){function t(){this.activeTargetIds=tu()}return t.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),vh=function(){function t(t,e,n,r,i){this.window=t,this.Zr=e,this.persistenceKey=n,this.la=r,this._a=null,this.fa=null,this.k=null,this.da=this.wa.bind(this),this.Ea=new Us(vi),this.Er=!1,this.Ta=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ia=uh(this.persistenceKey,this.la),this.ma=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ea=this.Ea.zt(this.la,new dh),this.Aa=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ra=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Pa=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ya=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.ga=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.da)}return t.Kn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return i(this,void 0,void 0,(function(){var t,e,n,r,i,s,u,a,c,h,f,l=this;return o(this,(function(o){switch(o.label){case 0:return[4,this._a.Uo()];case 1:for(t=o.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.la&&(i=this.getItem(uh(this.persistenceKey,r)))&&(s=lh.ca(r,i))&&(this.Ea=this.Ea.zt(s.clientId,s));for(this.Va(),(u=this.storage.getItem(this.ya))&&(a=this.pa(u))&&this.ba(a),c=0,h=this.Ta;c<h.length;c++)f=h[c],this.wa(f);return this.Ta=[],this.window.addEventListener("unload",(function(){return l.ko()})),this.Er=!0,[2]}}))}))},t.prototype.B=function(t){this.setItem(this.ma,JSON.stringify(t))},t.prototype.va=function(){return this.Sa(this.Ea)},t.prototype.Da=function(t){var e=!1;return this.Ea.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Ca=function(t){this.xa(t,"pending")},t.prototype.Na=function(t,e,n){this.xa(t,e,n),this.$a(t)},t.prototype.Fa=function(t){var e="not-current";if(this.Da(t)){var n=this.storage.getItem(ch(this.persistenceKey,t));if(n){var r=fh.ca(t,n);r&&(e=r.state)}}return this.Oa.ua(t),this.Va(),e},t.prototype.ka=function(t){this.Oa.ha(t),this.Va()},t.prototype.Ma=function(t){return this.Oa.activeTargetIds.has(t)},t.prototype.La=function(t){this.removeItem(ch(this.persistenceKey,t))},t.prototype.Ba=function(t,e,n){this.qa(t,e,n)},t.prototype.Ua=function(t,e,n){var r=this;e.forEach((function(t){r.$a(t)})),this.currentUser=t,n.forEach((function(t){r.Ca(t)}))},t.prototype.Qa=function(t){this.Ka(t)},t.prototype.Wa=function(){this.ja()},t.prototype.ko=function(){this.Er&&(this.window.removeEventListener("storage",this.da),this.removeItem(this.Ia),this.Er=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return si("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){si("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){si("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.wa=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(si("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ia)return void ui("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Zr.po((function(){return i(e,void 0,void 0,(function(){var t,e,r,i,s,u;return o(this,(function(o){if(this.Er){if(null!==n.key)if(this.Aa.test(n.key)){if(null==n.newValue)return t=this.Ga(n.key),[2,this.za(t,null)];if(e=this.Ha(n.key,n.newValue))return[2,this.za(e.clientId,e)]}else if(this.Ra.test(n.key)){if(null!==n.newValue&&(r=this.Ja(n.key,n.newValue)))return[2,this.Ya(r)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(i=this.Xa(n.key,n.newValue)))return[2,this.Za(i)]}else if(n.key===this.ya){if(null!==n.newValue&&(s=this.pa(n.newValue)))return[2,this.ba(s)]}else if(n.key===this.ma)(u=function(t){var e=Di.q;if(null!=t)try{var n=JSON.parse(t);fi("number"==typeof n),e=n}catch(t){ui("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Di.q&&this.k(u);else if(n.key===this.ga)return[2,this._a.tu()]}else this.Ta.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Oa",{get:function(){return this.Ea.get(this.la)},enumerable:!1,configurable:!0}),t.prototype.Va=function(){this.setItem(this.Ia,this.Oa.aa())},t.prototype.xa=function(t,e,n){var r=new hh(this.currentUser,t,e,n),i=ah(this.persistenceKey,this.currentUser,t);this.setItem(i,r.aa())},t.prototype.$a=function(t){var e=ah(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Ka=function(t){var e={clientId:this.la,onlineState:t};this.storage.setItem(this.ya,JSON.stringify(e))},t.prototype.qa=function(t,e,n){var r=ch(this.persistenceKey,t),i=new fh(t,e,n);this.setItem(r,i.aa())},t.prototype.ja=function(){this.setItem(this.ga,"value-not-used")},t.prototype.Ga=function(t){var e=this.Aa.exec(t);return e?e[1]:null},t.prototype.Ha=function(t,e){var n=this.Ga(t);return lh.ca(n,e)},t.prototype.Ja=function(t,e){var n=this.Ra.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return hh.ca(new Ei(i),r,e)},t.prototype.Xa=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return fh.ca(r,e)},t.prototype.pa=function(t){return ph.ca(t)},t.prototype.Ya=function(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this._a.eu(t.batchId,t.state,t.error)]:(si("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.Za=function(t){return this._a.nu(t.targetId,t.state,t.error)},t.prototype.za=function(t,e){var n=this,r=e?this.Ea.zt(t,e):this.Ea.remove(t),i=this.Sa(this.Ea),o=this.Sa(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this._a.su(s,u).then((function(){n.Ea=r}))},t.prototype.ba=function(t){this.Ea.get(t.clientId)&&this.fa(t.onlineState)},t.prototype.Sa=function(t){var e=tu();return t.forEach((function(t,n){e=e.Pe(n.activeTargetIds)})),e},t}(),yh=function(){function t(){this.iu=new dh,this.ru={},this.fa=null,this.k=null}return t.prototype.Ca=function(t){},t.prototype.Na=function(t,e,n){},t.prototype.Fa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},t.prototype.Ba=function(t,e,n){this.ru[t]=e},t.prototype.ka=function(t){this.iu.ha(t)},t.prototype.Ma=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.La=function(t){delete this.ru[t]},t.prototype.va=function(){return this.iu.activeTargetIds},t.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.start=function(){return this.iu=new dh,Promise.resolve()},t.prototype.Ua=function(t,e,n){},t.prototype.Qa=function(t){},t.prototype.ko=function(){},t.prototype.B=function(t){},t.prototype.Wa=function(){},t}(),gh=function(){function t(){}return t.prototype.ou=function(t){},t.prototype.ko=function(){},t}(),mh=function(){function t(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}return t.prototype.ou=function(t){this.lu.push(t)},t.prototype.ko=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},t.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},t.prototype.au=function(){si("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(0)},t.prototype.hu=function(){si("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(1)},t.Kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),bh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},wh=function(){function t(t){this.fu=t.fu,this.du=t.du}return t.prototype.wu=function(t){this.Eu=t},t.prototype.Tu=function(t){this.Iu=t},t.prototype.onMessage=function(t){this.mu=t},t.prototype.close=function(){this.du()},t.prototype.send=function(t){this.fu(t)},t.prototype.Au=function(){this.Eu()},t.prototype.Ru=function(t){this.Iu(t)},t.prototype.Pu=function(t){this.mu(t)},t}(),_h=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return n(e,t),e.prototype.Su=function(t,e,n,r){return new Promise((function(i,o){var s=new ei;s.listenOnce(Wr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Xr.NO_ERROR:var e=s.getResponseJson();si("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Xr.TIMEOUT:si("Connection",'RPC "'+t+'" timed out'),o(new wi(bi.DEADLINE_EXCEEDED,"Request time out"));break;case Xr.HTTP_ERROR:var n=s.getStatus();if(si("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(bi).indexOf(e)>=0?e:bi.UNKNOWN}(r.status);o(new wi(u,r.message))}else o(new wi(bi.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new wi(bi.UNAVAILABLE,"Connection failed."));break;default:hi()}}finally{si("Connection",'RPC "'+t+'" completed.')}}));var u=JSON.stringify(r);s.send(e,"POST",u,n,15)}))},e.prototype.Cu=function(t,e){var n,r=[this.gu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Gr,o=He(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())||"object"==typeof navigator&&"ReactNative"===navigator.product||f().indexOf("Electron/")>=0||function(){var t=f();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||f().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");si("Connection","Creating WebChannel: "+u,s);var a=i.createWebChannel(u,s),c=!1,h=!1,l=new wh({fu:function(t){h?si("Connection","Not sending because WebChannel is closed:",t):(c||(si("Connection","Opening WebChannel transport."),a.open(),c=!0),si("Connection","WebChannel sending:",t),a.send(t))},du:function(){return a.close()}}),p=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return p(a,ti.EventType.OPEN,(function(){h||si("Connection","WebChannel transport opened.")})),p(a,ti.EventType.CLOSE,(function(){h||(h=!0,si("Connection","WebChannel transport closed"),l.Ru())})),p(a,ti.EventType.ERROR,(function(t){h||(h=!0,ai("Connection","WebChannel transport errored:",t),l.Ru(new wi(bi.UNAVAILABLE,"The operation could not be completed")))})),p(a,ti.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];fi(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){si("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Ps[t];if(void 0!==e)return js(e)}(o),u=i.message;void 0===s&&(s=bi.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),h=!0,l.Ru(new wi(s,u)),a.close()}else si("Connection","WebChannel received:",n),l.Pu(n)}})),p(o,Jr.STAT_EVENT,(function(t){t.stat===Zr?si("Connection","Detected buffering proxy"):t.stat===$r&&si("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Au()}),0),l},e}(function(){function t(t){this.yu=t,this.t=t.t;var e=t.ssl?"https":"http";this.gu=e+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.pu=function(t,e,n,r){var i=this.bu(t,e);si("RestConnection","Sending: ",i,n);var o={};return this.vu(o,r),this.Su(t,i,o,n).then((function(t){return si("RestConnection","Received: ",t),t}),(function(e){throw ai("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Du=function(t,e,n,r){return this.pu(t,e,n,r)},t.prototype.vu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.9",t["Content-Type"]="text/plain",e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n])},t.prototype.bu=function(t,e){var n=bh[t];return this.gu+"/v1/"+e+":"+n},t}());function Eh(){return"undefined"!=typeof window?window:null}function Ih(){return"undefined"!=typeof document?document:null}function Th(t){return new vu(t,!0)}var Nh=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Zr=t,this.fs=e,this.xu=n,this.Nu=r,this.$u=i,this.Fu=0,this.Ou=null,this.ku=Date.now(),this.reset()}return t.prototype.reset=function(){this.Fu=0},t.prototype.Mu=function(){this.Fu=this.$u},t.prototype.Lu=function(t){var e=this;this.cancel();var n=Math.floor(this.Fu+this.Bu()),r=Math.max(0,Date.now()-this.ku),i=Math.max(0,n-r);i>0&&si("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Fu+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ou=this.Zr.Tr(this.fs,i,(function(){return e.ku=Date.now(),t()})),this.Fu*=this.Nu,this.Fu<this.xu&&(this.Fu=this.xu),this.Fu>this.$u&&(this.Fu=this.$u)},t.prototype.qu=function(){null!==this.Ou&&(this.Ou.Rs(),this.Ou=null)},t.prototype.cancel=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},t.prototype.Bu=function(){return(Math.random()-.5)*this.Fu},t}(),Ah=function(){function t(t,e,n,r,i,o){this.Zr=t,this.Uu=n,this.Qu=r,this.Ku=i,this.listener=o,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new Nh(t,e)}return t.prototype.zu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Hu=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Ju()},t.prototype.stop=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Yu=function(){this.state=0,this.Gu.reset()},t.prototype.Xu=function(){var t=this;this.Hu()&&null===this.ju&&(this.ju=this.Zr.Tr(this.Uu,6e4,(function(){return t.Zu()})))},t.prototype.th=function(t){this.eh(),this.stream.send(t)},t.prototype.Zu=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){return this.Hu()?[2,this.close(0)]:[2]}))}))},t.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},t.prototype.close=function(t,e){return i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,3!==t?this.Gu.reset():e&&e.code===bi.RESOURCE_EXHAUSTED?(ui(e.toString()),ui("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Mu()):e&&e.code===bi.UNAUTHENTICATED&&this.Ku.p(),null!==this.stream&&(this.nh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Tu(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.nh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.sh(this.Wu),n=this.Wu;this.Ku.getToken().then((function(e){t.Wu===n&&t.ih(e)}),(function(n){e((function(){var e=new wi(bi.UNKNOWN,"Fetching auth token failed: "+n.message);return t.rh(e)}))}))},t.prototype.ih=function(t){var e=this,n=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu((function(){n((function(){return e.state=2,e.listener.wu()}))})),this.stream.Tu((function(t){n((function(){return e.rh(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Ju=function(){var t=this;this.state=4,this.Gu.Lu((function(){return i(t,void 0,void 0,(function(){return o(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.rh=function(t){return si("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.sh=function(t){var e=this;return function(n){e.Zr.Ps((function(){return e.Wu===t?n():(si("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Sh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Qt=i,s}return n(e,t),e.prototype.oh=function(t){return this.Qu.Cu("Listen",t)},e.prototype.onMessage=function(t){this.Gu.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:hi()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Bt?(fi(void 0===e||"string"==typeof e),mi.fromBase64String(e||"")):(fi(void 0===e||e instanceof Uint8Array),mi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?bi.UNKNOWN:js(t.code);return new wi(e,t.message||"")}(u);n=new au(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Iu(t,r.document.name),o=bu(r.document.updateTime);var u=new co({mapValue:{fields:r.document.fields}}),a=(s=new po(i,o,u,{}),r.targetIds||[]),c=r.removedTargetIds||[];n=new su(a,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Iu(t,r.document),o=r.readTime?bu(r.readTime):Oi.min(),u=new vo(i,o),s=r.removedTargetIds||[],n=new su([],s,u.key,u);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Iu(t,r.document),o=r.removedTargetIds||[],n=new su([],o,i,null);else{if(!("filter"in e))return hi();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new Vs(r),o=h.targetId,n=new uu(o,i)}return n}(this.Qt,t),n=function(t){if(!("targetChange"in t))return Oi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Oi.min():e.readTime?bu(e.readTime):Oi.min()}(t);return this.listener.ah(e,n)},e.prototype.uh=function(t){var e={};e.database=Au(this.Qt),e.addTarget=function(t,e){var n,r=e.target;return(n=_o(r)?{documents:Pu(t,r)}:{query:Cu(t,r)}).targetId=e.targetId,e.resumeToken.l()>0?n.resumeToken=gu(t,e.resumeToken):e.Ot._(Oi.min())>0&&(n.readTime=yu(t,e.Ot.j())),n}(this.Qt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return hi()}}(0,e.Ft);return null==n?null:{"goog-listen-tags":n}}(this.Qt,t);n&&(e.labels=n),this.th(e)},e.prototype.hh=function(t){var e={};e.database=Au(this.Qt),e.removeTarget=t,this.th(e)},e}(Ah),Dh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Qt=i,s.lh=!1,s}return n(e,t),Object.defineProperty(e.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.nh=function(){this.lh&&this.fh([])},e.prototype.oh=function(t){return this.Qu.Cu("Write",t)},e.prototype.onMessage=function(t){if(fi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.lh){this.Gu.reset();var e=function(t,e){return t&&t.length>0?(fi(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?bu(t.updateTime):bu(e);n.isEqual(Oi.min())&&(n=bu(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new gs(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=bu(t.commitTime);return this.listener.dh(n,e)}return fi(!t.writeResults||0===t.writeResults.length),this.lh=!0,this.listener.wh()},e.prototype.Eh=function(){var t={};t.database=Au(this.Qt),this.th(t)},e.prototype.fh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Ou(e.Qt,t)}))};this.th(n)},e}(Ah),xh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qu=n,i.Qt=r,i.Th=!1,i}return n(e,t),e.prototype.Ih=function(){if(this.Th)throw new wi(bi.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.pu=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then((function(i){return r.Qu.pu(t,e,n,i)})).catch((function(t){throw t.code===bi.UNAUTHENTICATED&&r.credentials.p(),t}))},e.prototype.Du=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then((function(i){return r.Qu.Du(t,e,n,i)})).catch((function(t){throw t.code===bi.UNAUTHENTICATED&&r.credentials.p(),t}))},e.prototype.terminate=function(){this.Th=!1},e}((function(){})),Oh=function(){function t(t,e){this._s=t,this.fa=e,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}return t.prototype.Ph=function(){var t=this;0===this.mh&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,(function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()})))},t.prototype.Vh=function(t){"Online"===this.state?this.yh("Unknown"):(this.mh++,this.mh>=1&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},t.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Rh=!1),this.yh(t)},t.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},t.prototype.gh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rh?(ui(e),this.Rh=!1):si("OnlineStateTracker",e)},t.prototype.ph=function(){null!==this.Ah&&(this.Ah.cancel(),this.Ah=null)},t}(),kh=function(t,e,n,r,s){var u=this;this.bh=t,this.Sh=e,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.$h=[],this.Fh=s,this.Fh.ou((function(t){n.Ps((function(){return i(u,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return Fh(this)?(si("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return(e=li(t)).Nh.add(4),[4,Ch(e)];case 1:return n.sent(),e.Oh.set("Unknown"),e.Nh.delete(4),[4,Ph(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Oh=new Oh(n,r)};function Ph(t){return i(this,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:if(!Fh(t))return[3,4];e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Ch(t){return i(this,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Lh(t,e){var n=li(t);n.xh.has(e.targetId)||(n.xh.set(e.targetId,e),Uh(n)?jh(n):ef(n).Hu()&&Vh(n,e))}function Rh(t,e){var n=li(t),r=ef(n);n.xh.delete(e),r.Hu()&&Mh(n,e),0===n.xh.size&&(r.Hu()?r.Xu():Fh(n)&&n.Oh.set("Unknown"))}function Vh(t,e){t.kh.on(e.targetId),ef(t).uh(e)}function Mh(t,e){t.kh.on(e),ef(t).hh(e)}function jh(t){t.kh=new hu({vn:function(e){return t.Dh.vn(e)},Sn:function(e){return t.xh.get(e)||null}}),ef(t).start(),t.Oh.Ph()}function Uh(t){return Fh(t)&&!ef(t).zu()&&t.xh.size>0}function Fh(t){return 0===li(t).Nh.size}function qh(t){t.kh=void 0}function zh(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){return t.xh.forEach((function(e,n){Vh(t,e)})),[2]}))}))}function Bh(t,e){return i(this,void 0,void 0,(function(){return o(this,(function(n){return qh(t),Uh(t)?(t.Oh.Vh(e),jh(t)):t.Oh.set("Unknown"),[2]}))}))}function Gh(t,e,n){return i(this,void 0,void 0,(function(){var r,s,u;return o(this,(function(a){switch(a.label){case 0:if(t.Oh.set("Online"),!(e instanceof au&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s;return o(this,(function(o){switch(o.label){case 0:n=e.cause,r=0,i=e.targetIds,o.label=1;case 1:return r<i.length?(s=i[r],t.xh.has(s)?[4,t.Dh.Mh(s,n)]:[3,3]):[3,5];case 2:o.sent(),t.xh.delete(s),t.kh.removeTarget(s),o.label=3;case 3:o.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),si("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Hh(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof su?t.kh.dn(e):e instanceof uu?t.kh.Pn(e):t.kh.Tn(e),n.isEqual(Oi.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,Uc(t.bh)];case 8:return s=a.sent(),n._(s)>=0?[4,function(t,e){var n=t.kh.Vn(e);return n.$e.forEach((function(n,r){if(n.resumeToken.l()>0){var i=t.xh.get(r);i&&t.xh.set(r,i.Mt(n.resumeToken,e))}})),n.Fe.forEach((function(e){var n=t.xh.get(e);if(n){t.xh.set(e,n.Mt(mi.T,n.Ot)),Mh(t,e);var r=new ts(n.target,e,1,n.sequenceNumber);Vh(t,r)}})),t.Dh.Lh(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return si("RemoteStore","Failed to raise snapshot:",u=a.sent()),[4,Hh(t,u)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function Hh(t,e,n){return i(this,void 0,void 0,(function(){var r=this;return o(this,(function(s){switch(s.label){case 0:if(!Zu(e))throw e;return t.Nh.add(1),[4,Ch(t)];case 1:return s.sent(),t.Oh.set("Offline"),n||(n=function(){return Uc(t.bh)}),t._s.po((function(){return i(r,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return si("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Nh.delete(1),[4,Ph(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Qh(t,e){return e().catch((function(n){return Hh(t,n,e)}))}function Yh(t){return i(this,void 0,void 0,(function(){var e,n,r,i,s;return o(this,(function(o){switch(o.label){case 0:e=li(t),n=nf(e),r=e.Ch.length>0?e.Ch[e.Ch.length-1].batchId:-1,o.label=1;case 1:if(!function(t){return Fh(t)&&t.Ch.length<10}(e))return[3,7];o.label=2;case 2:return o.trys.push([2,4,,6]),[4,zc(e.bh,r)];case 3:return null===(i=o.sent())?(0===e.Ch.length&&n.Xu(),[3,7]):(r=i.batchId,function(t,e){t.Ch.push(e);var n=nf(t);n.Hu()&&n._h&&n.fh(e.mutations)}(e,i),[3,6]);case 4:return s=o.sent(),[4,Hh(e,s)];case 5:return o.sent(),[3,6];case 6:return[3,1];case 7:return Kh(e)&&Xh(e),[2]}}))}))}function Kh(t){return Fh(t)&&!nf(t).zu()&&t.Ch.length>0}function Xh(t){nf(t).start()}function Wh(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){return nf(t).Eh(),[2]}))}))}function Jh(t){return i(this,void 0,void 0,(function(){var e,n,r,i;return o(this,(function(o){for(e=nf(t),n=0,r=t.Ch;n<r.length;n++)i=r[n],e.fh(i.mutations);return[2]}))}))}function Zh(t,e,n){return i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:return r=t.Ch.shift(),i=ka.from(r,e,n),[4,Qh(t,(function(){return t.Dh.Bh(i)}))];case 1:return o.sent(),[4,Yh(t)];case 2:return o.sent(),[2]}}))}))}function $h(t,e){return i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return e&&nf(t)._h?[4,function(t,e){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:return Ms(r=e.code)&&r!==bi.ABORTED?(n=t.Ch.shift(),nf(t).Yu(),[4,Qh(t,(function(){return t.Dh.qh(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Yh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Kh(t)&&Xh(t),[2]}}))}))}function tf(t,e){return i(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return n=li(t),e?(n.Nh.delete(2),[4,Ph(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Nh.add(2),[4,Ch(n)]);case 3:r.sent(),n.Oh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function ef(t){var e=this;return t.Uh||(t.Uh=function(t,e,n){var r=li(t);return r.Ih(),new Sh(e,r.Qu,r.credentials,r.Qt,n)}(t.Sh,t._s,{wu:zh.bind(null,t),Tu:Bh.bind(null,t),ah:Gh.bind(null,t)}),t.$h.push((function(n){return i(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return n?(t.Uh.Yu(),Uh(t)?jh(t):t.Oh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Uh.stop()];case 2:e.sent(),qh(t),e.label=3;case 3:return[2]}}))}))}))),t.Uh}function nf(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=li(t);return r.Ih(),new Dh(e,r.Qu,r.credentials,r.Qt,n)}(t.Sh,t._s,{wu:Wh.bind(null,t),Tu:$h.bind(null,t),wh:Jh.bind(null,t),dh:Zh.bind(null,t)}),t.$h.push((function(n){return i(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return n?(t.Qh.Yu(),[4,Yh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qh.stop()];case 3:e.sent(),t.Ch.length>0&&(si("RemoteStore","Stopping write stream with "+t.Ch.length+" pending writes"),t.Ch=[]),e.label=4;case 4:return[2]}}))}))}))),t.Qh}var rf=function(){this.Kh=void 0,this.listeners=[]},of=function(){this.queries=new $a((function(t){return Xo(t)}),Ko),this.onlineState="Unknown",this.Wh=new Set};function sf(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,u,a,c;return o(this,(function(o){switch(o.label){case 0:if(n=li(t),r=e.query,i=!1,(s=n.queries.get(r))||(i=!0,s=new rf),!i)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),u=s,[4,n.jh(r)];case 2:return u.Kh=o.sent(),[3,4];case 3:return a=o.sent(),c=ia(a,"Initialization of query '"+Wo(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(r,s),s.listeners.push(e),e.Gh(n.onlineState),s.Kh&&e.zh(s.Kh)&&hf(n),[2]}}))}))}function uf(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,u;return o(this,(function(o){return n=li(t),r=e.query,i=!1,(s=n.queries.get(r))&&(u=s.listeners.indexOf(e))>=0&&(s.listeners.splice(u,1),i=0===s.listeners.length),i?[2,(n.queries.delete(r),n.Hh(r))]:[2]}))}))}function af(t,e){for(var n=li(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,a=n.queries.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].zh(s)&&(r=!0);a.Kh=s}}r&&hf(n)}function cf(t,e,n){var r=li(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function hf(t){t.Wh.forEach((function(t){t.next()}))}var ff=function(){function t(t,e,n){this.query=t,this.Jh=e,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ru(t.query,t.docs,t.Se,e,t.De,t.fromCache,t.Ce,!0)}var o=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),o=!0):this.tl(t,this.onlineState)&&(this.el(t),o=!0),this.Xh=t,o},t.prototype.onError=function(t){this.Jh.error(t)},t.prototype.Gh=function(t){this.onlineState=t;var e=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),e=!0),e},t.prototype.tl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.nl&&n||t.docs.et()&&"Offline"!==e)},t.prototype.Zh=function(t){if(t.docChanges.length>0)return!0;var e=this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ce&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.el=function(t){t=ru.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},t}(),lf=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.sl=function(){return"metadata"in this.payload},t}(),pf=function(){function t(t){this.Qt=t}return t.prototype.Pc=function(t){return Iu(this.Qt,t)},t.prototype.yc=function(t){return t.metadata.exists?xu(this.Qt,t.document,!1):new vo(this.Pc(t.metadata.name),this.gc(t.metadata.readTime))},t.prototype.gc=function(t){return bu(t)},t}();!function(){function t(t,e,n){this.il=t,this.bh=e,this.Qt=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.rl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.ol=function(t){for(var e=new Map,n=new pf(this.Qt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Pc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Zs()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return i(this,void 0,void 0,(function(){var t,e,n,r,i;return o(this,(function(o){switch(o.label){case 0:return[4,Xc(this.bh,new pf(this.Qt),this.documents,this.il.id)];case 1:t=o.sent(),e=this.ol(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,Wc(this.bh,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new kc(Object.assign({},this.progress),t))]}}))}))}}();var df=function(t){this.key=t},vf=function(t){this.key=t},yf=function(){function t(t,e){this.query=t,this.cl=e,this.al=null,this.Be=!1,this.ul=Zs(),this.De=Zs(),this.hl=Zo(t),this.ll=new eu(this.hl)}return Object.defineProperty(t.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),t.prototype.fl=function(t,e){var n=this,r=e?e.dl:new nu,i=e?e.ll:this.ll,o=e?e.De:this.De,s=i,u=!1,a=Fo(this.query)&&i.size===this.query.limit?i.last():null,c=qo(this.query)&&i.size===this.query.limit?i.first():null;if(t.Xt((function(t,e){var h=i.get(t),f=e instanceof po?e:null;f&&(f=Jo(n.query,f)?f:null);var l=!!h&&n.De.has(h.key),p=!!f&&(f.Vt||n.De.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.wl(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.hl(f,a)>0||c&&n.hl(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Fo(this.query)||qo(this.query))for(;s.size>this.query.limit;){var h=Fo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{ll:s,dl:r,lc:u,De:o}},t.prototype.wl=function(t,e){return t.Vt&&e.hasCommittedMutations&&!e.Vt},t.prototype.wi=function(t,e,n){var r=this,i=this.ll;this.ll=t.ll,this.De=t.De;var o=t.dl.ve();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return hi()}};return n(t)-n(e)}(t.type,e.type)||r.hl(t.doc,e.doc)})),this.El(n);var s=e?this.Tl():[],u=0===this.ul.size&&this.Be?1:0,a=u!==this.al;return this.al=u,0!==o.length||a?{snapshot:new ru(this.query,t.ll,i,o,t.De,0===u,a,!1),Il:s}:{Il:s}},t.prototype.Gh=function(t){return this.Be&&"Offline"===t?(this.Be=!1,this.wi({ll:this.ll,dl:new nu,De:this.De,lc:!1},!1)):{Il:[]}},t.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},t.prototype.El=function(t){var e=this;t&&(t.qe.forEach((function(t){return e.cl=e.cl.add(t)})),t.Ue.forEach((function(t){})),t.Qe.forEach((function(t){return e.cl=e.cl.delete(t)})),this.Be=t.Be)},t.prototype.Tl=function(){var t=this;if(!this.Be)return[];var e=this.ul;this.ul=Zs(),this.ll.forEach((function(e){t.ml(e.key)&&(t.ul=t.ul.add(e.key))}));var n=[];return e.forEach((function(e){t.ul.has(e)||n.push(new vf(e))})),this.ul.forEach((function(t){e.has(t)||n.push(new df(t))})),n},t.prototype.Al=function(t){this.cl=t.Rc,this.ul=Zs();var e=this.fl(t.documents);return this.wi(e,!0)},t.prototype.Rl=function(){return ru.Ne(this.query,this.ll,this.De,0===this.al)},t}(),gf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},mf=function(t){this.key=t,this.Pl=!1},bf=function(){function t(t,e,n,r,i,o){this.bh=t,this.yl=e,this.gl=n,this.Vl=r,this.currentUser=i,this.pl=o,this.bl={},this.vl=new $a((function(t){return Xo(t)}),Ko),this.Sl=new Map,this.Dl=new Set,this.Cl=new Us(Ri.H),this.xl=new Map,this.Nl=new Zc,this.$l={},this.Fl=new Map,this.Ol=ac.Li(),this.onlineState="Unknown",this.kl=void 0}return Object.defineProperty(t.prototype,"Ml",{get:function(){return!0===this.kl},enumerable:!1,configurable:!0}),t}();function wf(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,u,a;return o(this,(function(o){switch(o.label){case 0:return n=Xf(t),(s=n.vl.get(e))?(r=s.targetId,n.Vl.Fa(r),i=s.view.Rl(),[3,4]):[3,1];case 1:return[4,Bc(n.bh,Qo(e))];case 2:return u=o.sent(),a=n.Vl.Fa(u.targetId),r=u.targetId,[4,_f(n,e,r,"current"===a)];case 3:i=o.sent(),n.Ml&&Lh(n.yl,u),o.label=4;case 4:return[2,i]}}))}))}function _f(t,e,n,r){return i(this,void 0,void 0,(function(){var s,u,a,c,h,f;return o(this,(function(l){switch(l.label){case 0:return t.Ll=function(e,n,r){return function(t,e,n,r){return i(this,void 0,void 0,(function(){var i,s,u;return o(this,(function(o){switch(o.label){case 0:return(i=e.view.fl(n)).lc?[4,Hc(t.bh,e.query,!1).then((function(t){var n=t.documents;return e.view.fl(n,i)}))]:[3,2];case 1:i=o.sent(),o.label=2;case 2:return s=r&&r.$e.get(e.targetId),u=e.view.wi(i,t.Ml,s),[2,(Lf(t,e.targetId,u.Il),u.snapshot)]}}))}))}(t,e,n,r)},[4,Hc(t.bh,e,!0)];case 1:return s=l.sent(),u=new yf(e,s.Rc),a=u.fl(s.documents),c=ou.Le(n,r&&"Offline"!==t.onlineState),h=u.wi(a,t.Ml,c),Lf(t,n,h.Il),f=new gf(e,n,u),[2,(t.vl.set(e,f),t.Sl.has(n)?t.Sl.get(n).push(e):t.Sl.set(n,[e]),h.snapshot)]}}))}))}function Ef(t,e){return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return n=li(t),r=n.vl.get(e),(i=n.Sl.get(r.targetId)).length>1?[2,(n.Sl.set(r.targetId,i.filter((function(t){return!Ko(t,e)}))),void n.vl.delete(e))]:n.Ml?(n.Vl.ka(r.targetId),n.Vl.Da(r.targetId)?[3,2]:[4,Gc(n.bh,r.targetId,!1).then((function(){n.Vl.La(r.targetId),Rh(n.yl,r.targetId),Pf(n,r.targetId)})).catch(Za)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Pf(n,r.targetId),[4,Gc(n.bh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function If(t,e,n){return i(this,void 0,void 0,(function(){var r,i,s,u;return o(this,(function(o){switch(o.label){case 0:r=Wf(t),o.label=1;case 1:return o.trys.push([1,5,,6]),[4,function(t,e){var n,r=li(t),i=xi.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Zs());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Tc.Xo(t,o).next((function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=Is(c,n.get(c.key));null!=h&&s.push(new Ss(c.key,h,fo(h.proto.mapValue),ms.exists(!0)))}return r.zo.Ri(t,i,s,e)}))})).then((function(t){var e=t.xs(n);return{batchId:t.batchId,ri:e}}))}(r.bh,e)];case 2:return i=o.sent(),r.Vl.Ca(i.batchId),function(t,e,n){var r=t.$l[t.currentUser.A()];r||(r=new Us(vi)),r=r.zt(e,n),t.$l[t.currentUser.A()]=r}(r,i.batchId,n),[4,Mf(r,i.ri)];case 3:return o.sent(),[4,Yh(r.yl)];case 4:return o.sent(),[3,6];case 5:return s=o.sent(),u=ia(s,"Failed to persist write"),n.reject(u),[3,6];case 6:return[2]}}))}))}function Tf(t,e){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:n=li(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Fc(n.bh,e)];case 2:return r=i.sent(),e.$e.forEach((function(t,e){var r=n.xl.get(e);r&&(fi(t.qe.size+t.Ue.size+t.Qe.size<=1),t.qe.size>0?r.Pl=!0:t.Ue.size>0?fi(r.Pl):t.Qe.size>0&&(fi(r.Pl),r.Pl=!1))})),[4,Mf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Za(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Nf(t,e,n){var r=li(t);if(r.Ml&&0===n||!r.Ml&&1===n){var i=[];r.vl.forEach((function(t,n){var r=n.view.Gh(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=li(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Gh(e)&&(r=!0)})),r&&hf(n)}(r.gl,e),i.length&&r.bl.ah(i),r.onlineState=e,r.Ml&&r.Vl.Qa(e)}}function Af(t,e,n){return i(this,void 0,void 0,(function(){var r,i,s,u,a,c;return o(this,(function(o){switch(o.label){case 0:return(r=li(t)).Vl.Ba(e,"rejected",n),i=r.xl.get(e),(s=i&&i.key)?(u=(u=new Us(Ri.H)).zt(s,new vo(s,Oi.min())),a=Zs().add(s),c=new iu(Oi.min(),new Map,new zs(vi),u,a),[4,Tf(r,c)]):[3,2];case 1:return o.sent(),r.Cl=r.Cl.remove(s),r.xl.delete(e),Vf(r),[3,4];case 2:return[4,Gc(r.bh,e,!1).then((function(){return Pf(r,e,n)})).catch(Za)];case 3:o.sent(),o.label=4;case 4:return[2]}}))}))}function Sf(t,e){return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:n=li(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,jc(n.bh,e)];case 2:return i=o.sent(),kf(n,r,null),Of(n,r),n.Vl.Na(r,"acknowledged"),[4,Mf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Za(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Df(t,e,n){return i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:r=li(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=li(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.zo.Pi(t,e).next((function(e){return fi(null!==e),r=e.keys(),n.zo.Ci(t,e)})).next((function(){return n.zo.$i(t)})).next((function(){return n.Tc.Xo(t,r)}))}))}(r.bh,e)];case 2:return i=o.sent(),kf(r,e,n),Of(r,e),r.Vl.Na(e,"rejected",n),[4,Mf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Za(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function xf(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,u;return o(this,(function(o){switch(o.label){case 0:Fh((n=li(t)).yl)||si("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,function(t){var e=li(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.zo.Vi(t)}))}(n.bh)];case 2:return-1===(r=o.sent())?[2,void e.resolve()]:((i=n.Fl.get(r)||[]).push(e),n.Fl.set(r,i),[3,4]);case 3:return s=o.sent(),u=ia(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(u),[3,4];case 4:return[2]}}))}))}function Of(t,e){(t.Fl.get(e)||[]).forEach((function(t){t.resolve()})),t.Fl.delete(e)}function kf(t,e,n){var r=li(t),i=r.$l[r.currentUser.A()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.$l[r.currentUser.A()]=i}}function Pf(t,e,n){void 0===n&&(n=null),t.Vl.ka(e);for(var r=0,i=t.Sl.get(e);r<i.length;r++){var o=i[r];t.vl.delete(o),n&&t.bl.Bl(o,n)}t.Sl.delete(e),t.Ml&&t.Nl.Fc(e).forEach((function(e){t.Nl.Fi(e)||Cf(t,e)}))}function Cf(t,e){t.Dl.delete(e.path.rt());var n=t.Cl.get(e);null!==n&&(Rh(t.yl,n),t.Cl=t.Cl.remove(e),t.xl.delete(n),Vf(t))}function Lf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof df?(t.Nl.nr(o.key,e),Rf(t,o)):o instanceof vf?(si("SyncEngine","Document no longer in limbo: "+o.key),t.Nl.ir(o.key,e),t.Nl.Fi(o.key)||Cf(t,o.key)):hi()}}function Rf(t,e){var n=e.key,r=n.path.rt();t.Cl.get(n)||t.Dl.has(r)||(si("SyncEngine","New document in limbo: "+n),t.Dl.add(r),Vf(t))}function Vf(t){for(;t.Dl.size>0&&t.Cl.size<t.pl;){var e=t.Dl.values().next().value;t.Dl.delete(e);var n=new Ri(Pi.ot(e)),r=t.Ol.next();t.xl.set(r,new mf(n)),t.Cl=t.Cl.zt(n,r),Lh(t.yl,new ts(Qo(Uo(n.path)),r,2,Di.q))}}function Mf(t,e,n){return i(this,void 0,void 0,(function(){var r,s,u,a;return o(this,(function(c){switch(c.label){case 0:return r=li(t),s=[],u=[],a=[],r.vl.et()?[3,3]:(r.vl.forEach((function(t,i){a.push(r.Ll(i,e,n).then((function(t){if(t){r.Ml&&r.Vl.Ba(i.targetId,t.fromCache?"not-current":"current"),s.push(t);var e=Cc.oc(i.targetId,t);u.push(e)}})))})),[4,Promise.all(a)]);case 1:return c.sent(),r.bl.ah(s),[4,function(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,u,a,c,h,f;return o(this,(function(o){switch(o.label){case 0:n=li(t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Yu.forEach(e,(function(e){return Yu.forEach(e.ic,(function(r){return n.persistence.Ti.nr(t,e.targetId,r)})).next((function(){return Yu.forEach(e.rc,(function(r){return n.persistence.Ti.ir(t,e.targetId,r)}))}))}))}))];case 2:return o.sent(),[3,4];case 3:if(!Zu(r=o.sent()))throw r;return si("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,s=e;i<s.length;i++)u=s[i],a=u.targetId,u.fromCache||(c=n.fc.get(a),h=c.Ot,f=c.Lt(h),n.fc=n.fc.zt(a,f));return[2]}}))}))}(r.bh,u)];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))}function jf(t,e){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:return(n=li(t)).currentUser.isEqual(e)?[3,3]:(si("SyncEngine","User change. New user:",e.A()),[4,Mc(n.bh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fl.forEach((function(t){t.forEach((function(t){t.reject(new wi(bi.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fl.clear()}(n),n.Vl.Ua(e,r.mc,r.Ac),[4,Mf(n,r.Ic)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Uf(t,e){var n=li(t),r=n.xl.get(e);if(r&&r.Pl)return Zs().add(r.key);var i=Zs(),o=n.Sl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=u[s],c=n.vl.get(a);i=i.Pe(c.view._l)}return i}function Ff(t,e){return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return[4,Hc((n=li(t)).bh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Al(r),[2,(n.Ml&&Lf(n,e.targetId,i.Il),i)]}}))}))}function qf(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){return[2,Yc((e=li(t)).bh).then((function(t){return Mf(e,t)}))]}))}))}function zf(t,e,n,r){return i(this,void 0,void 0,(function(){var i,s;return o(this,(function(o){switch(o.label){case 0:return[4,function(t,e){var n=li(t),r=li(n.zo);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.yi(t,e).next((function(e){return e?n.Tc.Xo(t,e):Yu.resolve(null)}))}))}((i=li(t)).bh,e)];case 1:return null===(s=o.sent())?[3,6]:"pending"!==n?[3,3]:[4,Yh(i.yl)];case 2:return o.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(kf(i,e,r||null),Of(i,e),function(t,e){li(li(t).zo).xi(e)}(i.bh,e)):hi(),o.label=4;case 4:return[4,Mf(i,s)];case 5:return o.sent(),[3,7];case 6:si("SyncEngine","Cannot apply mutation batch with id: "+e),o.label=7;case 7:return[2]}}))}))}function Bf(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,u,a,c,h;return o(this,(function(o){switch(o.label){case 0:return Xf(n=li(t)),Wf(n),!0!==e||!0===n.kl?[3,3]:(r=n.Vl.va(),[4,Gf(n,r.it())]);case 1:return i=o.sent(),n.kl=!0,[4,tf(n.yl,!0)];case 2:for(o.sent(),s=0,u=i;s<u.length;s++)a=u[s],Lh(n.yl,a);return[3,7];case 3:return!1!==e||!1===n.kl?[3,7]:(c=[],h=Promise.resolve(),n.Sl.forEach((function(t,e){n.Vl.Ma(e)?c.push(e):h=h.then((function(){return Pf(n,e),Gc(n.bh,e,!0)})),Rh(n.yl,e)})),[4,h]);case 4:return o.sent(),[4,Gf(n,c)];case 5:return o.sent(),function(t){var e=li(t);e.xl.forEach((function(t,n){Rh(e.yl,n)})),e.Nl.Oc(),e.xl=new Map,e.Cl=new Us(Ri.H)}(n),n.kl=!1,[4,tf(n.yl,!1)];case 6:o.sent(),o.label=7;case 7:return[2]}}))}))}function Gf(t,e,n){return i(this,void 0,void 0,(function(){var n,r,i,s,u,a,c,h,f,l,p,d,v,y;return o(this,(function(o){switch(o.label){case 0:n=li(t),r=[],i=[],s=0,u=e,o.label=1;case 1:return s<u.length?(a=u[s],c=void 0,(h=n.Sl.get(a))&&0!==h.length?[4,Bc(n.bh,Qo(h[0]))]:[3,7]):[3,13];case 2:c=o.sent(),f=0,l=h,o.label=3;case 3:return f<l.length?(p=l[f],d=n.vl.get(p),[4,Ff(n,d)]):[3,6];case 4:(v=o.sent()).snapshot&&i.push(v.snapshot),o.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,Qc(n.bh,a)];case 8:return y=o.sent(),[4,Bc(n.bh,y)];case 9:return c=o.sent(),[4,_f(n,Hf(y),a,!1)];case 10:o.sent(),o.label=11;case 11:r.push(c),o.label=12;case 12:return s++,[3,1];case 13:return[2,(n.bl.ah(i),r)]}}))}))}function Hf(t){return jo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Qf(t){var e=li(t);return li(li(e.bh).persistence).Uo()}function Yf(t,e,n,r){return i(this,void 0,void 0,(function(){var i,s,u;return o(this,(function(o){switch(o.label){case 0:return(i=li(t)).kl?(si("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Sl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Yc(i.bh)];case 3:return s=o.sent(),u=iu.Me(e,"current"===n),[4,Mf(i,s,u)];case 4:return o.sent(),[3,8];case 5:return[4,Gc(i.bh,e,!0)];case 6:return o.sent(),Pf(i,e,r),[3,8];case 7:hi(),o.label=8;case 8:return[2]}}))}))}function Kf(t,e,n){return i(this,void 0,void 0,(function(){var r,i,s,u,a,c,h,f,l,p;return o(this,(function(d){switch(d.label){case 0:if(!(r=Xf(t)).kl)return[3,10];i=0,s=e,d.label=1;case 1:return i<s.length?(u=s[i],r.Sl.has(u)?(si("SyncEngine","Adding an already active target "+u),[3,5]):[4,Qc(r.bh,u)]):[3,6];case 2:return a=d.sent(),[4,Bc(r.bh,a)];case 3:return c=d.sent(),[4,_f(r,Hf(a),c.targetId,!1)];case 4:d.sent(),Lh(r.yl,c),d.label=5;case 5:return i++,[3,1];case 6:h=function(t){return o(this,(function(e){switch(e.label){case 0:return r.Sl.has(t)?[4,Gc(r.bh,t,!1).then((function(){Rh(r.yl,t),Pf(r,t)})).catch(Za)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},f=0,l=n,d.label=7;case 7:return f<l.length?(p=l[f],[5,h(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}function Xf(t){var e=li(t);return e.yl.Dh.Lh=Tf.bind(null,e),e.yl.Dh.vn=Uf.bind(null,e),e.yl.Dh.Mh=Af.bind(null,e),e.bl.ah=af.bind(null,e.gl),e.bl.Bl=cf.bind(null,e.gl),e}function Wf(t){var e=li(t);return e.yl.Dh.Bh=Sf.bind(null,e),e.yl.Dh.qh=Df.bind(null,e),e}var Jf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.Qt=Th(t.yu.t),this.Vl=this.Wl(t),this.persistence=this.jl(t),[4,this.persistence.start()];case 1:return e.sent(),this.Gl=this.zl(t),this.bh=this.Hl(t),[2]}}))}))},t.prototype.zl=function(t){return null},t.prototype.Hl=function(t){return Vc(this.persistence,new Lc,t.Jl,this.Qt)},t.prototype.jl=function(t){return new ih(sh.ia,this.Qt)},t.prototype.Wl=function(t){return new yh},t.prototype.terminate=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.ko()];case 1:return t.sent(),[4,this.persistence.ko()];case 2:return t.sent(),[2]}}))}))},t}(),Zf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Yl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return n(e,t),e.prototype.initialize=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Kc(this.bh)];case 2:return n.sent(),[4,this.Yl.initialize(this,e)];case 3:return n.sent(),[4,Wf(this.Yl._a)];case 4:return n.sent(),[4,Yh(this.Yl.yl)];case 5:return n.sent(),[2]}}))}))},e.prototype.Hl=function(t){return Vc(this.persistence,new Lc,t.Jl,this.Qt)},e.prototype.zl=function(t){var e=this.persistence.Ti.lr;return new vc(e,t._s)},e.prototype.jl=function(t){var e=Oc(t.yu.t,t.yu.persistenceKey),n=void 0!==this.cacheSizeBytes?Ja.Ys(this.cacheSizeBytes):Ja.ti;return new Sc(this.synchronizeTabs,e,t.clientId,n,t._s,Eh(),Ih(),this.Qt,this.Vl,!!this.forceOwnership)},e.prototype.Wl=function(t){return new yh},e}(Jf),$f=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Yl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return n(e,t),e.prototype.initialize=function(e){return i(this,void 0,void 0,(function(){var n,r=this;return o(this,(function(s){switch(s.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return s.sent(),n=this.Yl._a,this.Vl instanceof vh?(this.Vl._a={eu:zf.bind(null,n),nu:Yf.bind(null,n),su:Kf.bind(null,n),Uo:Qf.bind(null,n),tu:qf.bind(null,n)},[4,this.Vl.start()]):[3,3];case 2:s.sent(),s.label=3;case 3:return[4,this.persistence.Ro((function(t){return i(r,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,Bf(this.Yl._a,t)];case 1:return e.sent(),this.Gl&&(t&&!this.Gl.Er?this.Gl.start(this.bh):t||this.Gl.stop()),[2]}}))}))}))];case 4:return s.sent(),[2]}}))}))},e.prototype.Wl=function(t){var e=Eh();if(!vh.Kn(e))throw new wi(bi.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Oc(t.yu.t,t.yu.persistenceKey);return new vh(e,t._s,n,t.clientId,t.Jl)},e}(Zf),tl=function(){function t(){}return t.prototype.initialize=function(t,e){return i(this,void 0,void 0,(function(){var n=this;return o(this,(function(r){switch(r.label){case 0:return this.bh?[3,2]:(this.bh=t.bh,this.Vl=t.Vl,this.Sh=this.Xl(e),this.yl=this.Zl(e),this.gl=this.t_(e),this._a=this.e_(e,!t.synchronizeTabs),this.Vl.fa=function(t){return Nf(n._a,t,1)},this.yl.Dh.n_=jf.bind(null,this._a),[4,tf(this.yl,this._a.Ml)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.t_=function(t){return new of},t.prototype.Xl=function(t){var e,n=Th(t.yu.t),r=(e=t.yu,new _h(e));return function(t,e,n){return new xh(t,e,n)}(t.credentials,r,n)},t.prototype.Zl=function(t){var e,n,r,i,o,s=this;return e=this.bh,n=this.Sh,r=t._s,i=function(t){return Nf(s._a,t,0)},o=mh.Kn()?new mh:new gh,new kh(e,n,r,i,o)},t.prototype.e_=function(t,e){return function(t,e,n,r,i,o,s){var u=new bf(t,e,n,r,i,o);return s&&(u.kl=!0),u}(this.bh,this.yl,this.gl,this.Vl,t.Jl,t.pl,e)},t.prototype.terminate=function(){return function(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=li(t),si("RemoteStore","RemoteStore shutting down."),e.Nh.add(5),[4,Ch(e)];case 1:return n.sent(),e.Fh.ko(),e.Oh.set("Unknown"),[2]}}))}))}(this.yl)},t}(),el=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.i_=function(){this.muted=!0},t.prototype.s_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),nl=(function(){function t(t,e){var n=this;this.r_=t,this.Qt=e,this.metadata=new Qu,this.buffer=new Uint8Array,this.o_=new TextDecoder("utf-8"),this.c_().then((function(t){t&&t.sl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}t.prototype.close=function(){return this.r_.cancel()},t.prototype.getMetadata=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Ql=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.c_())]}}))}))},t.prototype.c_=function(){return i(this,void 0,void 0,(function(){var t,e,n,r;return o(this,(function(i){switch(i.label){case 0:return[4,this.a_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.o_.decode(t),n=Number(e),isNaN(n)&&this.u_("length string ("+e+") is not valid number"),[4,this.h_(n)]);case 2:return r=i.sent(),[2,new lf(JSON.parse(r),t.length+n)]}}))}))},t.prototype.l_=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.a_=function(){return i(this,void 0,void 0,(function(){var t,e;return o(this,(function(n){switch(n.label){case 0:return this.l_()<0?[4,this.__()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.l_())<0&&this.u_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.h_=function(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.__()]:[3,3];case 1:n.sent()&&this.u_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.o_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.u_=function(t){throw this.r_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.__=function(){return i(this,void 0,void 0,(function(){var t,e;return o(this,(function(n){switch(n.label){case 0:return[4,this.r_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new wi(bi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new Li(t)}return t.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},t}()),rl=function(t){this._methodName=t},il=function(t){this.d_=t};function ol(t,e,n){if(!n)throw new wi(bi.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function sl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new wi(bi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function ul(t,e,n,r){if(!0===e&&!0===r)throw new wi(bi.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function al(t){if(!Ri.wt(t))throw new wi(bi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function cl(t){if(Ri.wt(t))throw new wi(bi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function hl(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":hi()}function fl(t,e){if("_delegate"in t&&(t=t.d_),!(t instanceof e)){if(e.name===t.constructor.name)throw new wi(bi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=hl(t);throw new wi(bi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function ll(t,e){if(e<=0)throw new wi(bi.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var pl=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new wi(bi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new wi(bi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,ul("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),dl=new Map,vl=function(){function t(t,e){this.w_="(lite)",this.E_=new pl({}),this.T_=!1,t instanceof ri?(this.I_=t,this.m_=new Ti):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new wi(bi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ri(t.options.projectId)}(t),this.m_=new Ni(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new wi(bi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new wi(bi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new pl(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Ti;switch(t.type){case"gapi":var e=t.client;return fi(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Si(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new wi(bi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},t.prototype.b_=function(){return(t=dl.get(this))&&(si("ComponentProvider","Removing Datastore"),dl.delete(this),t.terminate()),Promise.resolve();var t},t}(),yl=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ml(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),gl=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),ml=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Uo(r))||this).firestore=e,i.D_=r,i.type="collection",i}return n(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.X();return t.et()?null:new yl(this.firestore,null,new Ri(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(gl);function bl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof il&&(t=t.d_),ol("collection","path",e),t instanceof vl)return cl(n=Pi.ot.apply(Pi,a([e],r))),new ml(t,null,n);if(!(t instanceof yl||t instanceof ml))throw new wi(bi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return cl(n=Pi.ot.apply(Pi,a([t.path],r)).child(Pi.ot(e))),new ml(t.firestore,null,n)}function wl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof il&&(t=t.d_),1===arguments.length&&(e=di.u()),ol("doc","path",e),t instanceof vl)return al(n=Pi.ot.apply(Pi,a([e],r))),new yl(t,null,new Ri(n));if(!(t instanceof yl||t instanceof ml))throw new wi(bi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return al(n=t.D_.child(Pi.ot.apply(Pi,a([e],r)))),new yl(t.firestore,t instanceof ml?t.v_:null,new Ri(n))}function _l(t,e){return t instanceof il&&(t=t.d_),e instanceof il&&(e=e.d_),(t instanceof yl||t instanceof ml)&&(e instanceof yl||e instanceof ml)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function El(t,e){return t instanceof il&&(t=t.d_),e instanceof il&&(e=e.d_),t instanceof gl&&e instanceof gl&&t.firestore===e.firestore&&Ko(t.C_,e.C_)&&t.v_===e.v_}var Il=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new wi(bi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new wi(bi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.U=function(t){return vi(this.x_,t.x_)||vi(this.N_,t.N_)},t}(),Tl=/^__.*__$/,Nl=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.Gt?new Ss(t,this.data,this.Gt,e,this.fieldTransforms):new As(t,this.data,e,this.fieldTransforms)},t}(),Al=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new Ss(t,this.data,this.Gt,e,this.fieldTransforms)},t}();function Sl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw hi()}}var Dl=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.Qt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Gt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return Kl(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.Gt.find((function(e){return t.nt(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.nt(e.field)}))},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Sl(this.k_)&&Tl.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),xl=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.Qt=n||Th(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Dl({k_:t,methodName:e,j_:n,path:Li.ct(),B_:!1,W_:r},this.t,this.Qt,this.ignoreUndefinedProperties)},t}();function Ol(t){var e=t.p_(),n=Th(t.I_);return new xl(t.I_,!!e.ignoreUndefinedProperties,n)}function kl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Gl("Data must be an object, but it was:",s,r);var u,a,c=zl(r,s);if(o.merge)u=new Ui(s.Gt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=Hl(e,l[f],n);if(!s.contains(p))throw new wi(bi.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Xl(h,p)||h.push(p)}u=new Ui(h),a=s.fieldTransforms.filter((function(t){return u.Tt(t.field)}))}else u=null,a=s.fieldTransforms;return new Nl(new co(c),u,a)}var Pl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(rl);function Cl(t,e,n){return new Dl({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.t,e.Qt,e.ignoreUndefinedProperties)}var Ll=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.z_=function(t){return new ys(t.path,new as)},e.prototype.isEqual=function(t){return t instanceof e},e}(rl),Rl=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return n(e,t),e.prototype.z_=function(t){var e=Cl(this,t,!0),n=this.H_.map((function(t){return ql(t,e)})),r=new cs(n);return new ys(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(rl),Vl=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return n(e,t),e.prototype.z_=function(t){var e=Cl(this,t,!0),n=this.H_.map((function(t){return ql(t,e)})),r=new fs(n);return new ys(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(rl),Ml=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return n(e,t),e.prototype.z_=function(t){var e=new ps(t.Qt,rs(t.Qt,this.J_));return new ys(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(rl);function jl(t,e,n,r){var i=t.G_(1,e,n);Gl("Data must be an object, but it was:",i,r);var o=[],s=new ho;Mi(r,(function(t,r){var u=Yl(e,t,n);r instanceof il&&(r=r.d_);var a=i.U_(u);if(r instanceof Pl)o.push(u);else{var c=ql(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new Ui(o);return new Al(s.Pt(),u,i.fieldTransforms)}function Ul(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Hl(e,r,n)],a=[i];if(o.length%2!=0)throw new wi(bi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Hl(e,o[c])),a.push(o[c+1]);for(var h=[],f=new ho,l=u.length-1;l>=0;--l)if(!Xl(h,u[l])){var p=u[l],d=a[l];d instanceof il&&(d=d.d_);var v=s.U_(p);if(d instanceof Pl)h.push(p);else{var y=ql(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new Ui(h);return new Al(f.Pt(),g,s.fieldTransforms)}function Fl(t,e,n,r){return void 0===r&&(r=!1),ql(n,t.G_(r?4:3,e))}function ql(t,e){if(t instanceof il&&(t=t.d_),Bl(t))return Gl("Unsupported field value:",e,t),zl(t,e);if(t instanceof rl)return function(t,e){if(!Sl(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.Gt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=ql(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof il&&(t=t.d_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return rs(e.Qt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=xi.fromDate(t);return{timestampValue:yu(e.Qt,n)}}if(t instanceof xi)return n=new xi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:yu(e.Qt,n)};if(t instanceof Il)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof _i)return{bytesValue:gu(e.Qt,t.I)};if(t instanceof yl){n=e.t;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:wu(t.firestore.I_||e.t,t.S_.path)}}throw e.K_("Unsupported field value: "+hl(t))}(t,e)}function zl(t,e){var n={};return ji(t)?e.path&&e.path.length>0&&e.Gt.push(e.path):Mi(t,(function(t,r){var i=ql(r,e.L_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Bl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof xi||t instanceof Il||t instanceof _i||t instanceof yl||t instanceof rl)}function Gl(t,e,n){if(!Bl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=hl(n);throw"an object"===r?e.K_(t+" a custom object"):e.K_(t+" "+r)}}function Hl(t,e,n){if(e instanceof il&&(e=e.d_),e instanceof nl)return e.f_;if("string"==typeof e)return Yl(t,e);throw Kl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Ql=new RegExp("[~\\*/\\[\\]]");function Yl(t,e,n){if(e.search(Ql)>=0)throw Kl("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(nl.bind.apply(nl,a([void 0],e.split("."))))).f_}catch(r){throw Kl("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Kl(t,e,n,r,i){var o=r&&!r.et(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new wi(bi.INVALID_ARGUMENT,(u+=". ")+t+a)}function Xl(t,e){return t.some((function(t){return t.isEqual(e)}))}var Wl=function(){function t(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return i(this,void 0,void 0,(function(){var e,n=this;return o(this,(function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new wi(bi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,u,a;return o(this,(function(o){switch(o.label){case 0:return n=li(t),r=Au(n.Qt)+"/documents",i={documents:e.map((function(t){return Eu(n.Qt,t)}))},[4,n.Du("BatchGetDocuments",r,i)];case 1:return s=o.sent(),u=new Map,s.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){fi(!!e.found),e.found.name,e.found.updateTime;var n=Iu(t,e.found.name),r=bu(e.found.updateTime),i=new co({mapValue:{fields:e.found.fields}});return new po(n,r,i,{})}(t,e):"missing"in e?function(t,e){fi(!!e.missing),fi(!!e.readTime);var n=Iu(t,e.missing),r=bu(e.readTime);return new vo(n,r)}(t,e):hi()}(n.Qt,t);u.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=u.get(t.toString());fi(!!e),a.push(e)})),a)]}}))}))}(this.Sh,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof vo||t instanceof po?n.sf(t):hi()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.F_(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new Ls(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return i(this,void 0,void 0,(function(){var t,e=this;return o(this,(function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Ri._t(n);e.mutations.push(new Rs(r,e.jt(r)))})),[4,function(t,e){return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return n=li(t),r=Au(n.Qt)+"/documents",i={writes:e.map((function(t){return Ou(n.Qt,t)}))},[4,n.pu("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Sh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}}))}))},t.prototype.sf=function(t){var e;if(t instanceof po)e=t.version;else{if(!(t instanceof vo))throw hi();e=Oi.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new wi(bi.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.jt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?ms.updateTime(e):ms.Kt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(Oi.min()))throw new wi(bi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ms.updateTime(e)}return ms.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),Jl=function(){function t(t,e,n,r){this._s=t,this.Sh=e,this.updateFunction=n,this.Es=r,this.cf=5,this.Gu=new Nh(this._s,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.Gu.Lu((function(){return i(t,void 0,void 0,(function(){var t,e,n=this;return o(this,(function(r){return t=new Wl(this.Sh),(e=this.uf(t))&&e.then((function(e){n._s.Ps((function(){return t.commit().then((function(){n.Es.resolve(e)})).catch((function(t){n.hf(t)}))}))})).catch((function(t){n.hf(t)})),[2]}))}))}))},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Yi(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this._s.Ps((function(){return e.af(),Promise.resolve()}))):this.Es.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ms(e)}return!1},t}(),Zl=function(){function t(t,e,n){var r=this;this.credentials=t,this._s=e,this.yu=n,this.user=Ei.UNAUTHENTICATED,this.clientId=di.u(),this._f=function(){},this.C=new Qu,this.credentials.v((function(t){si("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.C.resolve()}))}return t.prototype.getConfiguration=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}}))}))},t.prototype.ff=function(t){var e=this;this._f=t,this.C.promise.then((function(){return e._f(e.user)}))},t.prototype.df=function(){if(this._s.wf)throw new wi(bi.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this._s.Ef();var e=new Qu;return this._s.Tf((function(){return i(t,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.S(),e.resolve(),[3,6];case 5:return t=r.sent(),n=ia(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function $l(t,e){return i(this,void 0,void 0,(function(){var n,r,s=this;return o(this,(function(u){switch(u.label){case 0:return t._s.Af(),si("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=u.sent(),[4,e.initialize(n)];case 2:return u.sent(),r=n.Jl,t.ff((function(n){r.isEqual(n)||(r=n,t._s.po((function(){return i(s,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,Mc(e.bh,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.Po((function(){return t.terminate()})),t.mf=e,[2]}}))}))}function tp(t,e){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(s){switch(s.label){case 0:return t._s.Af(),[4,ep(t)];case 1:return n=s.sent(),si("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=s.sent(),[4,e.initialize(n,r)];case 3:return s.sent(),t.ff((function(n){return t._s.po((function(){return function(t,e){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:return(n=li(t))._s.Af(),si("RemoteStore","RemoteStore received new credentials"),r=Fh(n),n.Nh.add(3),[4,Ch(n)];case 1:return i.sent(),r&&n.Oh.set("Unknown"),[4,n.Dh.n_(e)];case 2:return i.sent(),n.Nh.delete(3),[4,Ph(n)];case 3:return i.sent(),[2]}}))}))}(e.yl,n)}))})),t.If=e,[2]}}))}))}function ep(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return t.mf?[3,2]:(si("FirestoreClient","Using default OfflineComponentProvider"),[4,$l(t,new Jf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}}))}))}function np(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return t.If?[3,2]:(si("FirestoreClient","Using default OnlineComponentProvider"),[4,tp(t,new tl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}}))}))}function rp(t){return ep(t).then((function(t){return t.persistence}))}function ip(t){return ep(t).then((function(t){return t.bh}))}function op(t){return np(t).then((function(t){return t.yl}))}function sp(t){return np(t).then((function(t){return t._a}))}function up(t){return i(this,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:return[4,np(t)];case 1:return e=r.sent(),[2,((n=e.gl).jh=wf.bind(null,e._a),n.Hh=Ef.bind(null,e._a),n)]}}))}))}function ap(t,e,n){var r=this;void 0===n&&(n={});var s=new Qu;return t._s.Ps((function(){return i(r,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new el({next:function(o){e.Ps((function(){return uf(t,s)}));var u=o.docs.has(n);!u&&o.fromCache?i.reject(new wi(bi.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new wi(bi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new ff(Uo(n.path),o,{includeMetadataChanges:!0,nl:!0});return sf(t,s)},[4,up(t)];case 1:return[2,r.apply(void 0,[i.sent(),t._s,e,n,s])]}}))}))})),s.promise}function cp(t,e,n){var r=this;void 0===n&&(n={});var s=new Qu;return t._s.Ps((function(){return i(r,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new el({next:function(n){e.Ps((function(){return uf(t,s)})),n.fromCache&&"server"===r.source?i.reject(new wi(bi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new ff(n,o,{includeMetadataChanges:!0,nl:!0});return sf(t,s)},[4,up(t)];case 1:return[2,r.apply(void 0,[i.sent(),t._s,e,n,s])]}}))}))})),s.promise}var hp=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new Nh(this,"async_queue_retry"),this.vf=function(){var e=Ih();e&&si("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Gu.qu()};var e=Ih();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.Ps=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Ih();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise((function(t){})):this.Df(t)},t.prototype.po=function(t){var e=this;this.Ps((function(){return e.Pf.push(t),e.Cf()}))},t.prototype.Cf=function(){return i(this,void 0,void 0,(function(){var t,e=this;return o(this,(function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!Zu(t=n.sent()))throw t;return si("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.Gu.Lu((function(){return e.Cf()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Df=function(t){var e=this,n=this.Rf.then((function(){return e.pf=!0,t().catch((function(t){throw e.Vf=t,e.pf=!1,ui("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.pf=!1,t}))}));return this.Rf=n,n},t.prototype.Tr=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=ra.Ts(this,t,e,n,(function(t){return r.xf(t)}));return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&hi()},t.prototype.Af=function(){},t.prototype.Nf=function(){return i(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.$f=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].fs===t)return!0;return!1},t.prototype.Ff=function(t){var e=this;return this.Nf().then((function(){e.gf.sort((function(t,e){return t.ds-e.ds}));for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Rs(),"all"!==t&&i.fs===t)break}return e.Nf()}))},t.prototype.Of=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}();function fp(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this.kf={},this.Mf=new Qu,this.Lf={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.kf={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.Mf.promise.catch(t)},t.prototype.then=function(t,e){return this.Mf.promise.then(t,e)},t.prototype.ql=function(t){this.Ul(t),this.kf.complete&&this.kf.complete(),this.Mf.resolve(t)},t.prototype.Kl=function(t){this.Lf.taskState="Error",this.kf.next&&this.kf.next(this.Lf),this.kf.error&&this.kf.error(t),this.Mf.reject(t)},t.prototype.Ul=function(t){this.Lf=t,this.kf.next&&this.kf.next(t)}}();var lp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Bf=new hp,r.w_="name"in e?e.name:"[DEFAULT]",r}return n(e,t),e.prototype.b_=function(){return this.qf||dp(this),this.qf.terminate()},e}(vl);function pp(t){return t.qf||dp(t),t.qf.df(),t.qf}function dp(t){var e=t.p_(),n=function(t,e,n){return new ni(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.qf=new Zl(t.m_,t.Bf,n)}function vp(t,e,n){var r=this,s=new Qu;return t._s.enqueue((function(){return i(r,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,$l(t,n)];case 1:return i.sent(),[4,tp(t,e)];case 2:return i.sent(),s.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===bi.FAILED_PRECONDITION||t.code===bi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=i.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),s.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return s.promise}))}function yp(t){if(t.R_||t.P_)throw new wi(bi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var gp=function(){function t(){}return t.prototype.Uf=function(t,e){switch(void 0===e&&(e="none"),Wi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return zi(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,e);case 5:return t.stringValue;case 6:return this.Wf(Bi(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,e);case 10:return this.Hf(t.mapValue,e);default:throw hi()}},t.prototype.Hf=function(t,e){var n=this,r={};return Mi(t.fields||{},(function(t,i){r[t]=n.Uf(i,e)})),r},t.prototype.Gf=function(t){return new Il(zi(t.latitude),zi(t.longitude))},t.prototype.zf=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.Uf(t,e)}))},t.prototype.Kf=function(t,e){switch(e){case"previous":var n=Hi(t);return null==n?null:this.Uf(n,e);case"estimate":return this.Qf(Qi(t));default:return null}},t.prototype.Qf=function(t){var e=qi(t);return new xi(e.seconds,e.nanos)},t.prototype.Jf=function(t,e){var n=Pi.ot(t);fi(Hu(n));var r=new ri(n.get(1),n.get(3)),i=new Ri(n.Y(5));return r.isEqual(e)||ui("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),mp=function(){function t(t,e,n,r,i){this.Yf=t,this.Xf=e,this.S_=n,this.Zf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new yl(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Zf},t.prototype.data=function(){if(this.Zf){if(this.v_){var t=new bp(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},t.prototype.get=function(t){if(this.Zf){var e=this.Zf.data().field(wp("DocumentSnapshot.get",t));if(null!==e)return this.Xf.Uf(e)}},t}(),bp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(mp);function wp(t,e){return"string"==typeof e?Yl(t,e):e instanceof il?e.d_.f_:e.f_}function _p(t){if(qo(t)&&0===t.xt.length)throw new wi(bi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ep=function(){};function Ip(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.td(t)}return t}var Tp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).ed=e,i.nd=n,i.sd=r,i.type="where",i}return n(e,t),e.prototype.td=function(t){var e=Ol(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.ut()){if("array-contains"===o||"array-contains-any"===o)throw new wi(bi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){kp(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var f=h[c];a.push(Op(r,t,f))}u={arrayValue:{values:a}}}else u=Op(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||kp(s,o),u=Fl(n,"where",s,"in"===o||"not-in"===o);var l=Eo.create(i,o,u);return function(t,e){if(e.Ct()){var n=Bo(t);if(null!==n&&!n.isEqual(e.field))throw new wi(bi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=zo(t);null!==r&&Pp(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new wi(bi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new wi(bi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t.C_,0,e,t.firestore.I_,this.ed,this.nd,this.sd);return new gl(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new Mo(t.path,t.collectionGroup,t.xt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Ep),Np=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ed=e,r.rd=n,r.type="orderBy",r}return n(e,t),e.prototype.td=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new wi(bi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new wi(bi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Co(e,n);return function(t,e){if(null===zo(t)){var n=Bo(t);null!==n&&Pp(0,n,e.field)}}(t,r),r}(t.C_,this.ed,this.rd);return new gl(t.firestore,t.v_,function(t,e){var n=t.xt.concat([e]);return new Mo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Ep),Ap=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.od=n,i.ad=r,i}return n(e,t),e.prototype.td=function(t){return new gl(t.firestore,t.v_,Yo(t.C_,this.od,this.ad))},e}(Ep),Sp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return n(e,t),e.prototype.td=function(t){var e=xp(t,this.type,this.ud,this.hd);return new gl(t.firestore,t.v_,function(t,e){return new Mo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Ep),Dp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return n(e,t),e.prototype.td=function(t){var e=xp(t,this.type,this.ud,this.hd);return new gl(t.firestore,t.v_,function(t,e){return new Mo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Ep);function xp(t,e,n,r){if(n[0]instanceof il&&(n[0]=n[0].d_),n[0]instanceof mp)return function(t,e,n,r,i){if(!r)throw new wi(bi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=Ho(t);s<u.length;s++){var a=u[s];if(a.field.ut())o.push(ro(e,r.key));else{var c=r.field(a.field);if(Gi(c))throw new wi(bi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.rt();throw new wi(bi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new ko(o,i)}(t.C_,t.firestore.I_,e,n[0].Zf,r);var i=Ol(t.firestore);return function(t,e,n,r,i,o){var s=t.xt;if(i.length>s.length)throw new wi(bi.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ut()){if("string"!=typeof c)throw new wi(bi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Go(t)&&-1!==c.indexOf("/"))throw new wi(bi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Pi.ot(c));if(!Ri.wt(h))throw new wi(bi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new Ri(h);u.push(ro(e,f))}else{var l=Fl(n,r,c);u.push(l)}}return new ko(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Op(t,e,n){if(n instanceof il&&(n=n.d_),"string"==typeof n){if(""===n)throw new wi(bi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Go(e)&&-1!==n.indexOf("/"))throw new wi(bi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Pi.ot(n));if(!Ri.wt(r))throw new wi(bi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ro(t,new Ri(r))}if(n instanceof yl)return ro(t,n.S_);throw new wi(bi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+hl(n)+".")}function kp(t,e){if(!Array.isArray(t)||0===t.length)throw new wi(bi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new wi(bi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Pp(t,e,n){if(!n.isEqual(e))throw new wi(bi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Cp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Lp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return n(e,t),e.prototype.Wf=function(t){return new _i(t)},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new yl(this.firestore,null,e)},e}(gp),Rp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Vp=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).Yf=e,u.ld=e,u.metadata=o,u}return n(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Zf){if(this.v_){var e=new Mp(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Xf.Uf(this.Zf.bt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Zf){var n=this.Zf.data().field(wp("DocumentSnapshot.get",t));if(null!==n)return this.Xf.Uf(n,e.serverTimestamps)}},e}(mp),Mp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Vp),jp=function(){function t(t,e,n,r){this.Yf=t,this.Xf=e,this._d=r,this.metadata=new Rp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._d.docs.forEach((function(r){t.call(e,new Mp(n.Yf,n.Xf,r.key,r,new Rp(n._d.De.has(r.key),n._d.fromCache),n.query.v_))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._d.xe)throw new wi(bi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===e||(this.fd=function(t,e){if(t._d.Se.et()){var n=0;return t._d.docChanges.map((function(e){var r=new Mp(t.Yf,t.Xf,e.doc.key,e.doc,new Rp(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._d.Se;return t._d.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Mp(t.Yf,t.Xf,e.doc.key,e.doc,new Rp(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Up(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this.dd=e),this.fd},t}();function Up(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return hi()}}function Fp(t,e){return t instanceof Vp&&e instanceof Vp?t.Yf===e.Yf&&t.S_.isEqual(e.S_)&&(null===t.Zf?null===e.Zf:t.Zf.isEqual(e.Zf))&&t.v_===e.v_:t instanceof jp&&e instanceof jp&&t.Yf===e.Yf&&El(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._d.isEqual(e._d)}var qp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return n(e,t),e.prototype.Wf=function(t){return new _i(t)},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new yl(this.firestore,null,e)},e}(gp);function zp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=fl(t,yl);var o=fl(t.firestore,lp),s=Ol(o);return e instanceof il&&(e=e.d_),Gp(o,[("string"==typeof e||e instanceof nl?Ul(s,"updateDoc",t.S_,e,n,r):jl(s,"updateDoc",t.S_,e)).F_(t.S_,ms.exists(!0))])}function Bp(t){for(var e,n,r,s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];t instanceof il&&(t=t.d_);var a={includeMetadataChanges:!1},c=0;"object"!=typeof s[c]||fp(s[c])||(a=s[c],c++);var h,f,l,p={includeMetadataChanges:a.includeMetadataChanges};if(fp(s[c])){var d=s[c];s[c]=null===(e=d.next)||void 0===e?void 0:e.bind(d),s[c+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),s[c+2]=null===(r=d.complete)||void 0===r?void 0:r.bind(d)}if(t instanceof yl)f=fl(t.firestore,lp),l=Uo(t.S_.path),h={next:function(e){s[c]&&s[c](Hp(f,t,e))},error:s[c+1],complete:s[c+2]};else{var v=fl(t,gl);f=fl(v.firestore,lp),l=v.C_;var y=new qp(f);h={next:function(t){s[c]&&s[c](new jp(f,y,v,t))},error:s[c+1],complete:s[c+2]},_p(t.C_)}return function(t,e,n,r){var s=this,u=new el(r),a=new ff(e,u,n);return t._s.Ps((function(){return i(s,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=sf,[4,up(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))})),function(){u.i_(),t._s.Ps((function(){return i(s,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=uf,[4,up(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))}))}}(pp(f),l,p,h)}function Gp(t,e){return function(t,e){var n=this,r=new Qu;return t._s.Ps((function(){return i(n,void 0,void 0,(function(){var n;return o(this,(function(i){switch(i.label){case 0:return n=If,[4,sp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(pp(t),e)}function Hp(t,e,n){var r=n.docs.get(e.S_),i=new qp(t);return new Vp(t,i,e.S_,r,new Rp(n.hasPendingWrites,n.fromCache),e.v_)}var Qp=function(){function t(t,e){this.Yf=t,this.wd=e,this.Ed=[],this.Td=!1,this.Id=Ol(t)}return t.prototype.set=function(t,e,n){this.md();var r=Yp(t,this.Yf),i=Cp(r.v_,e,n),o=kl(this.Id,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.Ed.push(o.F_(r.S_,ms.Kt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.md();var o,s=Yp(t,this.Yf);return e instanceof il&&(e=e.d_),o="string"==typeof e||e instanceof nl?Ul(this.Id,"WriteBatch.update",s.S_,e,n,r):jl(this.Id,"WriteBatch.update",s.S_,e),this.Ed.push(o.F_(s.S_,ms.exists(!0))),this},t.prototype.delete=function(t){this.md();var e=Yp(t,this.Yf);return this.Ed=this.Ed.concat(new Ls(e.S_,ms.Kt())),this},t.prototype.commit=function(){return this.md(),this.Td=!0,this.Ed.length>0?this.wd(this.Ed):Promise.resolve()},t.prototype.md=function(){if(this.Td)throw new wi(bi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Yp(t,e){if(t instanceof il&&(t=t.d_),t.firestore!==e)throw new wi(bi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Kp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Yf=e,r}return n(e,t),e.prototype.get=function(e){var n=this,r=Yp(e,this.Yf),i=new qp(this.Yf);return t.prototype.get.call(this,e).then((function(t){return new Vp(n.Yf,i,r.S_,t.Zf,new Rp(!1,!1),r.v_)}))},e}(function(){function t(t,e){this.Yf=t,this.Ad=e,this.Id=Ol(t)}return t.prototype.get=function(t){var e=this,n=Yp(t,this.Yf),r=new Lp(this.Yf);return this.Ad.ef([n.S_]).then((function(t){if(!t||1!==t.length)return hi();var i=t[0];if(i instanceof vo)return new mp(e.Yf,r,n.S_,null,n.v_);if(i instanceof po)return new mp(e.Yf,r,i.key,i,n.v_);throw hi()}))},t.prototype.set=function(t,e,n){var r=Yp(t,this.Yf),i=Cp(r.v_,e,n),o=kl(this.Id,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Ad.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Yp(t,this.Yf);return e instanceof il&&(e=e.d_),o="string"==typeof e||e instanceof nl?Ul(this.Id,"Transaction.update",s.S_,e,n,r):jl(this.Id,"Transaction.update",s.S_,e),this.Ad.update(s.S_,o),this},t.prototype.delete=function(t){var e=Yp(t,this.Yf);return this.Ad.delete(e.S_),this},t}());function Xp(){if("undefined"==typeof Uint8Array)throw new wi(bi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Wp(){if("undefined"==typeof atob)throw new wi(bi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Jp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.fromBase64String=function(t){return Wp(),new e(_i.fromBase64String(t))},e.fromUint8Array=function(t){return Xp(),new e(_i.fromUint8Array(t))},e.prototype.toBase64=function(){return Wp(),this.d_.toBase64()},e.prototype.toUint8Array=function(){return Xp(),this.d_.toUint8Array()},e.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(il),Zp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){yp(t=fl(t,lp));var n=pp(t),r=t.p_(),i=new tl;return vp(n,i,new Zf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.d_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){yp(t=fl(t,lp));var e=pp(t),n=t.p_(),r=new tl;return vp(e,r,new $f(r,n.cacheSizeBytes))}(t.d_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new wi(bi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Qu;return t.Bf.Tf((function(){return i(e,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return Xu.Kn()?(e=t+"main",[4,Xu.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Oc(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t.d_)},t}(),$p=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Rd=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof ri||(i.Pd=e),i}return n(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.d_.V_()),t)).merge,this.d_.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=fl(t,vl)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&ai("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this.d_,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t._s.enqueue((function(){return i(e,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:return[4,rp(t)];case 1:return e=r.sent(),[4,op(t)];case 2:return n=r.sent(),[2,(e.yo(!0),function(t){var e=li(t);return e.Nh.delete(0),Ph(e)}(n))]}}))}))}))}(pp(fl(this.d_,lp)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t._s.enqueue((function(){return i(e,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:return[4,rp(t)];case 1:return e=r.sent(),[4,op(t)];case 2:return n=r.sent(),[2,(e.yo(!1),function(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return(e=li(t)).Nh.add(0),[4,Ch(e)];case 1:return n.sent(),e.Oh.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(pp(fl(this.d_,lp)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&ul("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Qu;return t._s.Ps((function(){return i(e,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return e=xf,[4,sp(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(pp(fl(this.d_,lp)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new el(e);return t._s.Ps((function(){return i(n,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=function(t,e){li(t).Wh.add(e),e.next()},[4,up(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.i_(),t._s.Ps((function(){return i(n,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=function(t,e){li(t).Wh.delete(e)},[4,up(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(pp(t=fl(t,lp)),fp(e)?e:{next:e})}(this.d_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Pd)throw new wi(bi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new pd(this,bl(this.d_,t))}catch(t){throw od(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new id(this,wl(this.d_,t))}catch(t){throw od(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new hd(this,function(t,e){if(t=fl(t,vl),ol("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new wi(bi.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new gl(t,null,function(t){return new Mo(Pi.ct(),t)}(e))}(this.d_,t))}catch(t){throw od(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Qu;return t._s.Ps((function(){return i(n,void 0,void 0,(function(){var n;return o(this,(function(i){switch(i.label){case 0:return[4,function(t){return np(t).then((function(t){return t.Sh}))}(t)];case 1:return n=i.sent(),new Jl(t._s,n,e,r).run(),[2]}}))}))})),r.promise}(pp(t),(function(n){return e(new Kp(t,n))}))}(this.d_,(function(n){return t(new ed(e,n))}))},e.prototype.batch=function(){var t=this;return pp(this.d_),new nd(new Qp(this.d_,(function(e){return Gp(t.d_,e)})))},e.prototype.loadBundle=function(t){throw new wi(bi.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new wi(bi.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(il),td=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return n(e,t),e.prototype.Wf=function(t){return new Jp(new _i(t))},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return id.yd(e,this.firestore,null)},e}(gp),ed=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r.Xf=new td(e),r}return n(e,t),e.prototype.get=function(t){var e=this,n=dd(t);return this.d_.get(n).then((function(t){return new ad(e.Yf,new Vp(e.Yf.d_,e.Xf,t.S_,t.Zf,t.metadata,n.v_))}))},e.prototype.set=function(t,e,n){var r=dd(t);return n?(sl("Transaction.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=dd(t);return 2===arguments.length?this.d_.update(s,e):(r=this.d_).update.apply(r,a([s,e,n],i)),this},e.prototype.delete=function(t){var e=dd(t);return this.d_.delete(e),this},e}(il),nd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.set=function(t,e,n){var r=dd(t);return n?(sl("WriteBatch.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=dd(t);return 2===arguments.length?this.d_.update(s,e):(r=this.d_).update.apply(r,a([s,e,n],i)),this},e.prototype.delete=function(t){var e=dd(t);return this.d_.delete(e),this},e.prototype.commit=function(){return this.d_.commit()},e}(il),rd=function(t){function e(e,n,r){var i=this;return(i=t.call(this,r)||this).Yf=e,i.Xf=n,i}return n(e,t),e.prototype.fromFirestore=function(t,e){var n=new Mp(this.Yf.d_,this.Xf,t.S_,t.Zf,t.metadata,null);return this.d_.fromFirestore(new cd(this.Yf,n),null!=e?e:{})},e.prototype.toFirestore=function(t,e){return e?this.d_.toFirestore(t,e):this.d_.toFirestore(t)},e.gd=function(t,n){var r=e.Vd,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new td(t),n),i.set(n,o)),o},e}(il);rd.Vd=new WeakMap;var id=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new td(e),r}return n(e,t),e.pd=function(t,n,r){if(t.length%2!=0)throw new wi(bi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.rt()+" has "+t.length);return new e(n,new yl(n.d_,r,new Ri(t)))},e.yd=function(t,n,r){return new e(n,new yl(n.d_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new pd(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new pd(this.firestore,bl(this.d_,t))}catch(t){throw od(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof il&&(t=t.d_),t instanceof yl&&_l(this.d_,t)},e.prototype.set=function(t,e){e=sl("DocumentReference.set",e);try{return function(t,e,n){t=fl(t,yl);var r=fl(t.firestore,lp),i=Cp(t.v_,e,n);return Gp(r,[kl(Ol(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,ms.Kt())])}(this.d_,t,e)}catch(t){throw od(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?zp(this.d_,t):zp.apply(void 0,a([this.d_,t,e],n))}catch(t){throw od(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return Gp(fl((t=this.d_).firestore,lp),[new Ls(t.S_,ms.Kt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=sd(e),i=ud(e,(function(e){return new ad(t.firestore,new Vp(t.firestore.d_,t.Xf,e.S_,e.Zf,e.metadata,t.d_.v_))}));return Bp(this.d_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=fl(t,yl);var e=fl(t.firestore,lp),n=pp(e),r=new qp(e);return function(t,e){var n=this,r=new Qu;return t._s.Ps((function(){return i(n,void 0,void 0,(function(){var n;return o(this,(function(s){switch(s.label){case 0:return n=function(t,e,n){return i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=li(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Tc.Ho(t,e)}))}(t,e)];case 1:return(i=o.sent())instanceof po?n.resolve(i):i instanceof vo?n.resolve(null):n.reject(new wi(bi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=ia(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,ip(t)];case 1:return[2,n.apply(void 0,[s.sent(),e,r])]}}))}))})),r.promise}(n,t.S_).then((function(n){return new Vp(e,r,t.S_,n,new Rp(n instanceof po&&n.Vt,!0),t.v_)}))}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=fl(t,yl);var e=fl(t.firestore,lp);return ap(pp(e),t.S_,{source:"server"}).then((function(n){return Hp(e,t,n)}))}(this.d_):function(t){t=fl(t,yl);var e=fl(t.firestore,lp);return ap(pp(e),t.S_).then((function(n){return Hp(e,t,n)}))}(this.d_)).then((function(t){return new ad(e.firestore,new Vp(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))}))},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(rd.gd(this.firestore,t)))},e}(il);function od(t,e,n){return t.message=t.message.replace(e,n),t}function sd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!fp(r))return r}return{}}function ud(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=fp(t[0])?t[0]:fp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var ad=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return n(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new id(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.d_.data(t)},e.prototype.get=function(t,e){return this.d_.get(t,e)},e.prototype.isEqual=function(t){return Fp(this.d_,t.d_)},e}(il),cd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.data=function(t){return this.d_.data(t)},e}(ad),hd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new td(e),r}return n(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Ip(this.d_,function(t,e,n){var r=e,i=wp("where",t);return new Tp(i,r,n)}(t,n,r)))}catch(t){throw od(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Ip(this.d_,function(t,e){void 0===e&&(e="asc");var n=e,r=wp("orderBy",t);return new Np(r,n)}(t,n)))}catch(t){throw od(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Ip(this.d_,function(t){return ll("limit",t),new Ap("limit",t,"F")}(t)))}catch(t){throw od(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Ip(this.d_,function(t){return ll("limitToLast",t),new Ap("limitToLast",t,"L")}(t)))}catch(t){throw od(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ip(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sp("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw od(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ip(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sp("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw od(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ip(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Dp("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw od(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ip(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Dp("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw od(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return El(this.d_,t.d_)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=fl(t,gl);var e=fl(t.firestore,lp),n=pp(e),r=new qp(e);return function(t,e){var n=this,r=new Qu;return t._s.Ps((function(){return i(n,void 0,void 0,(function(){var n;return o(this,(function(s){switch(s.label){case 0:return n=function(t,e,n){return i(this,void 0,void 0,(function(){var r,i,s,u,a;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Hc(t,e,!0)];case 1:return a=o.sent(),r=new yf(e,a.Rc),i=r.fl(a.documents),s=r.wi(i,!1),n.resolve(s.snapshot),[3,3];case 2:return u=o.sent(),a=ia(u,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,ip(t)];case 1:return[2,n.apply(void 0,[s.sent(),e,r])]}}))}))})),r.promise}(n,t.C_).then((function(n){return new jp(e,r,t,n)}))}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=fl(t,gl);var e=fl(t.firestore,lp),n=pp(e),r=new qp(e);return cp(n,t.C_,{source:"server"}).then((function(n){return new jp(e,r,t,n)}))}(this.d_):function(t){t=fl(t,gl);var e=fl(t.firestore,lp),n=pp(e),r=new qp(e);return _p(t.C_),cp(n,t.C_).then((function(n){return new jp(e,r,t,n)}))}(this.d_)).then((function(t){return new ld(e.firestore,new jp(e.firestore.d_,e.Xf,e.d_,t._d))}))},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=sd(e),i=ud(e,(function(e){return new ld(t.firestore,new jp(t.firestore.d_,t.Xf,t.d_,e._d))}));return Bp(this.d_,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(rd.gd(this.firestore,t)))},e}(il),fd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new cd(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),e}(il),ld=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return n(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new hd(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.d_.docs.map((function(e){return new cd(t.Yf,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.d_.docChanges(t).map((function(t){return new fd(e.Yf,t)}))},e.prototype.forEach=function(t,e){var n=this;this.d_.forEach((function(r){t.call(e,new cd(n.Yf,r))}))},e.prototype.isEqual=function(t){return Fp(this.d_,t.d_)},e}(il),pd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.d_=n,r}return n(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.d_.parent;return t?new id(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new id(this.firestore,void 0===t?wl(this.d_):wl(this.d_,t))}catch(t){throw od(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=fl(t.firestore,lp),r=wl(t),i=Cp(t.v_,e);return Gp(n,[kl(Ol(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).F_(r.S_,ms.exists(!1))]).then((function(){return r}))}(this.d_,t).then((function(t){return new id(e.firestore,t)}))},e.prototype.isEqual=function(t){return _l(this.d_,t.d_)},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(rd.gd(this.firestore,t)))},e}(hd);function dd(t){return t instanceof il&&(t=t.d_),fl(t,yl)}var vd,yd=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(nl.bind.apply(nl,a([void 0],e))))||this}return n(e,t),e.documentId=function(){return new e(Li.ht().rt())},e.prototype.isEqual=function(t){return t instanceof il&&(t=t.d_),t instanceof nl&&this.d_.f_.isEqual(t.f_)},e}(il),gd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.serverTimestamp=function(){var t=new Ll("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Pl("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rl("arrayUnion",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vl("arrayRemove",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Ml("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},e}(il),md={Firestore:$p,GeoPoint:Il,Timestamp:xi,Blob:Jp,Transaction:ed,WriteBatch:nd,DocumentReference:id,DocumentSnapshot:ad,Query:hd,QueryDocumentSnapshot:cd,QuerySnapshot:ld,CollectionReference:pd,FieldPath:yd,FieldValue:gd,setLogLevel:function(t){var e;e=t,ii.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new E("firestore",(function(t){return function(t,e){return new $p(t,new lp(t,e),new Zp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},md)))})(vd=X),vd.registerVersion("@firebase/firestore","2.1.7");X.apps.length||X.initializeApp({apiKey:"AIzaSyAik9N9sxMNYUJF0pTIPUhrK0_kb1SJqbE",authDomain:"carbon-farmer.firebaseapp.com",projectId:"carbon-farmer",storageBucket:"carbon-farmer.appspot.com",messagingSenderId:"765202293623",appId:"1:765202293623:web:763d451728d019cf487772",measurementId:"G-DEX8RCHR88"});const bd=X.firestore(),wd=new RTCPeerConnection({iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10});let _d=null,Ed=null;const Id=document.getElementById("webcamButton"),Td=document.getElementById("webcamVideo"),Nd=document.getElementById("callButton"),Ad=document.getElementById("callInput"),Sd=document.getElementById("answerButton"),Dd=document.getElementById("remoteVideo"),xd=document.getElementById("hangupButton");Id.onclick=async()=>{_d=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),Ed=new MediaStream,_d.getTracks().forEach((t=>{wd.addTrack(t,_d)})),wd.ontrack=t=>{t.streams[0].getTracks().forEach((t=>{Ed.addTrack(t)}))},Td.srcObject=_d,Dd.srcObject=Ed,Nd.disabled=!1,Sd.disabled=!1,Id.disabled=!0},Nd.onclick=async()=>{const t=bd.collection("calls").doc(),e=t.collection("offerCandidates"),n=t.collection("answerCandidates");Ad.value=t.id,wd.onicecandidate=t=>{t.candidate&&e.add(t.candidate.toJSON())};const r=await wd.createOffer();await wd.setLocalDescription(r);const i={sdp:r.sdp,type:r.type};await t.set({offer:i}),t.onSnapshot((t=>{const e=t.data();if(!wd.currentRemoteDescription&&e?.answer){const t=new RTCSessionDescription(e.answer);wd.setRemoteDescription(t)}})),n.onSnapshot((t=>{t.docChanges().forEach((t=>{if("added"===t.type){const e=new RTCIceCandidate(t.doc.data());wd.addIceCandidate(e)}}))})),xd.disabled=!1},Sd.onclick=async()=>{console.log("hi, ansset key");const t=Ad.value,e=bd.collection("calls").doc(t),n=e.collection("answerCandidates"),r=e.collection("offerCandidates");wd.onicecandidate=t=>{t.candidate&&n.add(t.candidate.toJSON())};const i=(await e.get()).data().offer;await wd.setRemoteDescription(new RTCSessionDescription(i));const o=await wd.createAnswer();await wd.setLocalDescription(o);const s={type:o.type,sdp:o.sdp};await e.update({answer:s}),r.onSnapshot((t=>{t.docChanges().forEach((t=>{if(console.log(t),"added"===t.type){let e=t.doc.data();wd.addIceCandidate(new RTCIceCandidate(e))}}))}))}})();